<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>VIP Go mu-plugins</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
            <script src="js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">VIP Go mu-plugins</a><span class="title-separator">/</span>mu-plugins</h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -four phpdocumentor-sidebar">
        
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/automattic-wp.html"><abbr title="\Automattic\WP">WP</abbr></a></li>
                                            <li><a href="namespaces/automattic-vip.html"><abbr title="\Automattic\VIP">VIP</abbr></a></li>
                                    </ul>
                            <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/tubalmartin.html"><abbr title="\tubalmartin">tubalmartin</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/tubalmartin-cssmin.html"><abbr title="\tubalmartin\CssMin">CssMin</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/VIP.html"><abbr title="\VIP">VIP</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/a8c.html"><abbr title="\a8c">a8c</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/a8c-Cron.html"><abbr title="\a8c\Cron">Cron</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/Http.html"><abbr title="\Http">Http</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/Http-Concat.html"><abbr title="\Http\Concat">Concat</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/ES.html"><abbr title="\ES">ES</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/ES-WP.html"><abbr title="\ES\WP">WP</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/wp.html"><abbr title="\wp">wp</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/wp-cli.html"><abbr title="\wp\cli">cli</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="hooks/hooks.html">Hooks</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">vip-caching.php</h2>

            <p class="phpdocumentor-summary">This file contains a bunch of helper functions that handle add caching to core WordPress functions.</p>

    <section class="phpdocumentor-description"></section>








<h3 id="toc">
    Table of Contents
    <a href="#toc" class="headerlink"><i class="fas fa-link"></i></a>
</h3>

<dl class="phpdocumentor-table-of-contents">
                        <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_category_by_slug">wpcom_vip_get_category_by_slug()</a>
    <span>
                        &nbsp;: object|null|bool    </span>
</dt>
<dd>Cached version of get_category_by_slug.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_term_by">wpcom_vip_get_term_by()</a>
    <span>
                        &nbsp;: mixed|null|bool    </span>
</dt>
<dd>Cached version of get_term_by.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wp_flush_get_term_by_cache">wp_flush_get_term_by_cache()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_term_exists">wpcom_vip_term_exists()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Cached version of term_exists()</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wp_flush_term_exists">wp_flush_term_exists()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_term_link">wpcom_vip_get_term_link()</a>
    <span>
                        &nbsp;: string|<abbr title="\WP_Error">WP_Error</abbr>    </span>
</dt>
<dd>Optimized version of get_term_link that adds caching for slug-based lookups.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_page_by_title">wpcom_vip_get_page_by_title()</a>
    <span>
                        &nbsp;: <abbr title="\WP_Post">WP_Post</abbr>|null    </span>
</dt>
<dd>Cached version of get_page_by_title so that we&#039;re not making unnecessary SQL all the time</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_page_by_path">wpcom_vip_get_page_by_path()</a>
    <span>
                        &nbsp;: <abbr title="\WP_Post">WP_Post</abbr>|null    </span>
</dt>
<dd>Cached version of get_page_by_path so that we&#039;re not making unnecessary SQL all the time</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_flush_get_page_by_title_cache">wpcom_vip_flush_get_page_by_title_cache()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Flush the cache for published pages so we don&#039;t end up with stale data</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_flush_get_page_by_path_cache">wpcom_vip_flush_get_page_by_path_cache()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Flush the cache for published pages so we don&#039;t end up with stale data</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_url_to_postid">wpcom_vip_url_to_postid()</a>
    <span>
                        &nbsp;: int    </span>
</dt>
<dd>Cached version of url_to_postid, which can be expensive.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_old_slug_redirect">wpcom_vip_old_slug_redirect()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Cached version of wp_old_slug_redirect.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_count_user_posts">wpcom_vip_count_user_posts()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Cached version of count_user_posts, which is uncached but doesn&#039;t always need to hit the db</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_nav_menu_object">wpcom_vip_get_nav_menu_object()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_cache_set">wpcom_vip_cache_set()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Drop in replacement for wp_cache_set().</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_cache_get">wpcom_vip_cache_get()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Drop in replacement for wp_cache_get().</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_cache_delete">wpcom_vip_cache_delete()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Drop in replacement for wp_cache_delete().</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_adjacent_post">wpcom_vip_get_adjacent_post()</a>
    <span>
                        &nbsp;: null|string|<abbr title="\WP_Post">WP_Post</abbr>    </span>
</dt>
<dd>Retrieve adjacent post.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_attachment_cache_key">wpcom_vip_attachment_cache_key()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_attachment_url_to_postid">wpcom_vip_attachment_url_to_postid()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_cache_full_comment_counts">wpcom_vip_cache_full_comment_counts()</a>
    <span>
                        &nbsp;: bool|false|mixed|string    </span>
</dt>
<dd>Use this function to cache the comment counting in the wp menu that can be slow on sites with lots of comments
use like this:</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_enable_cache_full_comment_counts">wpcom_vip_enable_cache_full_comment_counts()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_enable_old_slug_redirect_caching">wpcom_vip_enable_old_slug_redirect_caching()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_wp_old_slug_redirect">wpcom_vip_wp_old_slug_redirect()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>This works by first looking in the cache to see if there is a value saved based on the name query var.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_set_old_slug_redirect_cache">wpcom_vip_set_old_slug_redirect_cache()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_flush_wp_old_slug_redirect_cache">wpcom_vip_flush_wp_old_slug_redirect_cache()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_maybe_skip_old_slug_redirect">wpcom_vip_maybe_skip_old_slug_redirect()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Potentially skip redirect for old slugs.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_enable_maybe_skip_old_slug_redirect">wpcom_vip_enable_maybe_skip_old_slug_redirect()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_reset_local_object_cache">vip_reset_local_object_cache()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Reset the local WordPress object cache</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_reset_db_query_log">vip_reset_db_query_log()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Reset the WordPress DB query log</dd>

    </dl>



        

            <section class="phpdocumentor-functions">
        <h3 class="phpdocumentor-elements__header" id="functions">
            Functions
            <a href="files/vip-helpers-vip-caching.html#functions" class="headerlink"><i class="fas fa-link"></i></a>
        </h3>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_category_by_slug">
        wpcom_vip_get_category_by_slug()
        <a href="namespaces/default.html#function_wpcom_vip_get_category_by_slug" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">13</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of get_category_by_slug.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_category_by_slug</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$slug</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">object|null|bool</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$slug</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Category slug</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/caching/uncached-functions/"> <p>Uncached Functions</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_term_by">
        wpcom_vip_get_term_by()
        <a href="namespaces/default.html#function_wpcom_vip_get_term_by" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">31</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of get_term_by.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_term_by</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$field</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string|int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$value</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$taxonomy</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$output</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">OBJECT</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$filter</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;raw&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed|null|bool</span></code>

        <section class="phpdocumentor-description"><p>Many calls to get_term_by (with name or slug lookup) across on a single pageload can easily add up the query count.
This function helps prevent that by adding a layer of caching.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$field</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Either 'slug', 'name', or 'id'</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$value</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Search for this term value</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$taxonomy</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Taxonomy Name</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$output</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">OBJECT</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Constant OBJECT, ARRAY_A, or ARRAY_N</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$filter</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;raw&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Default is 'raw' or no WordPress defined filter will applied.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/caching/uncached-functions/"> <p>Uncached Functions</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wp_flush_get_term_by_cache">
        wp_flush_get_term_by_cache()
        <a href="namespaces/default.html#function_wp_flush_get_term_by_cache" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">63</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wp_flush_get_term_by_cache</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$term_id</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$taxonomy</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$term_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$taxonomy</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_term_exists">
        wpcom_vip_term_exists()
        <a href="namespaces/default.html#function_wpcom_vip_term_exists" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">90</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of term_exists()</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_term_exists</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">int|string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$term</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$taxonomy</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$parent</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Term exists calls can pile up on a single pageload.
This function adds a layer of caching to prevent lots of queries.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$term</span>
                : <span class="phpdocumentor-signature__argument__return-type">int|string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The term to check can be id, slug or name.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$taxonomy</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The taxonomy name to use</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$parent</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. ID of parent term under which to confine the exists search.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wp_flush_term_exists">
        wp_flush_term_exists()
        <a href="namespaces/default.html#function_wp_flush_term_exists" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">123</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wp_flush_term_exists</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$term</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$tt_id</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$taxonomy</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$deleted_term</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$term</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$tt_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$taxonomy</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$deleted_term</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_term_link">
        wpcom_vip_get_term_link()
        <a href="namespaces/default.html#function_wpcom_vip_get_term_link" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">141</span>
</aside>

        <p class="phpdocumentor-summary">Optimized version of get_term_link that adds caching for slug-based lookups.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_term_link</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">int|string|object&nbsp;</span><span class="phpdocumentor-signature__argument__name">$term</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$taxonomy</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string|<abbr title="\WP_Error">WP_Error</abbr></span></code>

        <section class="phpdocumentor-description"><p>Returns permalink for a taxonomy term archive, or a WP_Error object if the term does not exist.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$term</span>
                : <span class="phpdocumentor-signature__argument__return-type">int|string|object</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The term object / term ID / term slug whose link will be retrieved.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$taxonomy</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The taxonomy slug. NOT required if you pass the term object in the first parameter</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_page_by_title">
        wpcom_vip_get_page_by_title()
        <a href="namespaces/default.html#function_wpcom_vip_get_page_by_title" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">160</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of get_page_by_title so that we&#039;re not making unnecessary SQL all the time</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_page_by_title</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$title</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$output</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">OBJECT</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post_type</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;page&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\WP_Post">WP_Post</abbr>|null</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$title</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$output</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">OBJECT</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Output type; OBJECT*, ARRAY_N, or ARRAY_A.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post_type</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;page&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Post type; default is 'page'.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/caching/uncached-functions/"> <p>Uncached Functions</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_page_by_path">
        wpcom_vip_get_page_by_path()
        <a href="namespaces/default.html#function_wpcom_vip_get_page_by_path" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">186</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of get_page_by_path so that we&#039;re not making unnecessary SQL all the time</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_page_by_path</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$page_path</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$output</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">OBJECT</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post_type</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;page&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\WP_Post">WP_Post</abbr>|null</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$page_path</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Page path</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$output</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">OBJECT</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Output type; OBJECT*, ARRAY_N, or ARRAY_A.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post_type</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;page&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Post type; default is 'page'.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/caching/uncached-functions/"> <p>Uncached Functions</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_flush_get_page_by_title_cache">
        wpcom_vip_flush_get_page_by_title_cache()
        <a href="namespaces/default.html#function_wpcom_vip_flush_get_page_by_title_cache" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">220</span>
</aside>

        <p class="phpdocumentor-summary">Flush the cache for published pages so we don&#039;t end up with stale data</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_flush_get_page_by_title_cache</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$new_status</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$old_status</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Post">WP_Post</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$new_status</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The post's new status</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$old_status</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The post's previous status</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Post">WP_Post</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The post</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/caching/uncached-functions/"> <p>Uncached Functions</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_flush_get_page_by_path_cache">
        wpcom_vip_flush_get_page_by_path_cache()
        <a href="namespaces/default.html#function_wpcom_vip_flush_get_page_by_path_cache" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">236</span>
</aside>

        <p class="phpdocumentor-summary">Flush the cache for published pages so we don&#039;t end up with stale data</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_flush_get_page_by_path_cache</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$new_status</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$old_status</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Post">WP_Post</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$new_status</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The post's new status</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$old_status</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The post's previous status</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Post">WP_Post</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The post</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/caching/uncached-functions/"> <p>Uncached Functions</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_url_to_postid">
        wpcom_vip_url_to_postid()
        <a href="namespaces/default.html#function_wpcom_vip_url_to_postid" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">252</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of url_to_postid, which can be expensive.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_url_to_postid</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">int</span></code>

        <section class="phpdocumentor-description"><p>Examine a url and try to determine the post ID it represents.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Permalink to check.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - -deprecated">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_old_slug_redirect">
        wpcom_vip_old_slug_redirect()
        <a href="namespaces/default.html#function_wpcom_vip_old_slug_redirect" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">280</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of wp_old_slug_redirect.</p>

    <code class="phpdocumentor-code phpdocumentor-signature -deprecated">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_old_slug_redirect</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Cache the results of the _wp_old_slug meta query, which can be expensive.</p>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">deprecated</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>use wpcom_vip_wp_old_slug_redirect instead</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_count_user_posts">
        wpcom_vip_count_user_posts()
        <a href="namespaces/default.html#function_wpcom_vip_count_user_posts" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">351</span>
</aside>

        <p class="phpdocumentor-summary">Cached version of count_user_posts, which is uncached but doesn&#039;t always need to hit the db</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_count_user_posts</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$user_id</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>count_user_posts is generally fast, but it can be easy to end up with many redundant queries
if it's called several times per request. This allows bypassing the db queries in favor of
the cache</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$user_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_nav_menu_object">
        wpcom_vip_get_nav_menu_object()
        <a href="namespaces/default.html#function_wpcom_vip_get_nav_menu_object" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">378</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_nav_menu_object</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$menu</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$menu</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_cache_set">
        wpcom_vip_cache_set()
        <a href="namespaces/default.html#function_wpcom_vip_cache_set" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">423</span>
</aside>

        <p class="phpdocumentor-summary">Drop in replacement for wp_cache_set().</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_cache_set</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$key</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string|int|array&lt;string|int, mixed&gt;|object&nbsp;</span><span class="phpdocumentor-signature__argument__name">$value</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$group</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$expiration</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>Wrapper for the WPCOM Stampedeless_Cache class.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$key</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Cache key.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$value</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|int|array&lt;string|int, mixed&gt;|object</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Data to store in the cache.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$group</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Cache group.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$expiration</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Cache TTL in seconds.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_cache_get">
        wpcom_vip_cache_get()
        <a href="namespaces/default.html#function_wpcom_vip_cache_get" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">443</span>
</aside>

        <p class="phpdocumentor-summary">Drop in replacement for wp_cache_get().</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_cache_get</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$key</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$group</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Wrapper for the WPCOM Stampedeless_Cache class.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$key</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Cache key.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$group</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Cache group.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_cache_delete">
        wpcom_vip_cache_delete()
        <a href="namespaces/default.html#function_wpcom_vip_cache_delete" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">462</span>
</aside>

        <p class="phpdocumentor-summary">Drop in replacement for wp_cache_delete().</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_cache_delete</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$key</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$group</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>Wrapper for WPCOM Stampedeless_Cache class.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$key</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Cache key.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$group</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Cache group.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_adjacent_post">
        wpcom_vip_get_adjacent_post()
        <a href="namespaces/default.html#function_wpcom_vip_get_adjacent_post" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">490</span>
</aside>

        <p class="phpdocumentor-summary">Retrieve adjacent post.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_adjacent_post</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$in_same_term</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$excluded_terms</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$previous</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">true</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$taxonomy</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;category&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$adjacent</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">null|string|<abbr title="\WP_Post">WP_Post</abbr></span></code>

        <section class="phpdocumentor-description"><p>Can either be next or previous post. The logic for excluding terms is handled within PHP, for performance benefits.
Props to Elliott Stocks</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$in_same_term</span>
                : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Whether post should be in a same taxonomy term. Note - only the first term will be used from wp_get_object_terms().</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$excluded_terms</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$previous</span>
                : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">true</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Whether to retrieve previous post.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$taxonomy</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;category&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Taxonomy, if $in_same_term is true. Default 'category'.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$adjacent</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">global</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>wpdb $wpdb</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_attachment_cache_key">
        wpcom_vip_attachment_cache_key()
        <a href="namespaces/default.html#function_wpcom_vip_attachment_cache_key" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">579</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_attachment_cache_key</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_attachment_url_to_postid">
        wpcom_vip_attachment_url_to_postid()
        <a href="namespaces/default.html#function_wpcom_vip_attachment_url_to_postid" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">583</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_attachment_url_to_postid</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_cache_full_comment_counts">
        wpcom_vip_cache_full_comment_counts()
        <a href="namespaces/default.html#function_wpcom_vip_cache_full_comment_counts" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">619</span>
</aside>

        <p class="phpdocumentor-summary">Use this function to cache the comment counting in the wp menu that can be slow on sites with lots of comments
use like this:</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_cache_full_comment_counts</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$counts</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post_id</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool|false|mixed|string</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$counts</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post_id</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"></section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><abbr title="\wp_count_comments()">wp_count_comments()</abbr></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_enable_cache_full_comment_counts">
        wpcom_vip_enable_cache_full_comment_counts()
        <a href="namespaces/default.html#function_wpcom_vip_enable_cache_full_comment_counts" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">641</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_enable_cache_full_comment_counts</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_enable_old_slug_redirect_caching">
        wpcom_vip_enable_old_slug_redirect_caching()
        <a href="namespaces/default.html#function_wpcom_vip_enable_old_slug_redirect_caching" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">646</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_enable_old_slug_redirect_caching</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_wp_old_slug_redirect">
        wpcom_vip_wp_old_slug_redirect()
        <a href="namespaces/default.html#function_wpcom_vip_wp_old_slug_redirect" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">657</span>
</aside>

        <p class="phpdocumentor-summary">This works by first looking in the cache to see if there is a value saved based on the name query var.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_wp_old_slug_redirect</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>If one is found, redirect immediately. If nothing is found, including that there is no already cache &quot;not_found&quot; value we then add a hook to old_slug_redirect_url so that when the 'rea' wp_old_slug_redirect is run it will store the value in the cache @see wpcom_vip_set_old_slug_redirect_cache(). If we found a not_found we remove the template_redirect so the slow query is not run.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_set_old_slug_redirect_cache">
        wpcom_vip_set_old_slug_redirect_cache()
        <a href="namespaces/default.html#function_wpcom_vip_set_old_slug_redirect_cache" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">680</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_set_old_slug_redirect_cache</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$link</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$link</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_flush_wp_old_slug_redirect_cache">
        wpcom_vip_flush_wp_old_slug_redirect_cache()
        <a href="namespaces/default.html#function_wpcom_vip_flush_wp_old_slug_redirect_cache" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">687</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_flush_wp_old_slug_redirect_cache</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post_id</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post_before</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post_before</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_maybe_skip_old_slug_redirect">
        wpcom_vip_maybe_skip_old_slug_redirect()
        <a href="namespaces/default.html#function_wpcom_vip_maybe_skip_old_slug_redirect" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">718</span>
</aside>

        <p class="phpdocumentor-summary">Potentially skip redirect for old slugs.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_maybe_skip_old_slug_redirect</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>We're seeing an increase of URLs that match this pattern: http://example.com/http://othersite.com/random_text.</p>
<p>These then cause really slow lookups inside of wp_old_slug_redirect. Since wp_old_slug redirect does not match
on full URLs but rather former slugs, it's safe to skip the lookup for these. Most of the calls are from bad ad
providers that generate random URLs.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_enable_maybe_skip_old_slug_redirect">
        wpcom_vip_enable_maybe_skip_old_slug_redirect()
        <a href="namespaces/default.html#function_wpcom_vip_enable_maybe_skip_old_slug_redirect" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">733</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_enable_maybe_skip_old_slug_redirect</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_reset_local_object_cache">
        vip_reset_local_object_cache()
        <a href="namespaces/default.html#function_vip_reset_local_object_cache" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">743</span>
</aside>

        <p class="phpdocumentor-summary">Reset the local WordPress object cache</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_reset_local_object_cache</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>This only cleans the local cache in WP_Object_Cache, without
affecting memcache</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_reset_db_query_log">
        vip_reset_db_query_log()
        <a href="namespaces/default.html#function_vip_reset_db_query_log" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-caching.php"><a href="files/vip-helpers-vip-caching.html"><abbr title="vip-helpers/vip-caching.php">vip-caching.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">762</span>
</aside>

        <p class="phpdocumentor-summary">Reset the WordPress DB query log</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_reset_db_query_log</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    

    
</article>
            </section>

                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * This file contains a bunch of helper functions that handle add caching to core WordPress functions.
 */

/**
 * Cached version of get_category_by_slug.
 *
 * @param string $slug Category slug
 * @return object|null|bool Term Row from database. Will return null if $slug doesn&#039;t match a term. If taxonomy does not exist then false will be returned.
 * @link https://docs.wpvip.com/technical-references/caching/uncached-functions/ Uncached Functions
 */
function wpcom_vip_get_category_by_slug( $slug ) {
	return wpcom_vip_get_term_by( &#039;slug&#039;, $slug, &#039;category&#039; );
}

/**
 * Cached version of get_term_by.
 *
 * Many calls to get_term_by (with name or slug lookup) across on a single pageload can easily add up the query count.
 * This function helps prevent that by adding a layer of caching.
 *
 * @param string     $field Either &#039;slug&#039;, &#039;name&#039;, or &#039;id&#039;
 * @param string|int $value Search for this term value
 * @param string     $taxonomy Taxonomy Name
 * @param string     $output Optional. Constant OBJECT, ARRAY_A, or ARRAY_N
 * @param string     $filter Optional. Default is &#039;raw&#039; or no WordPress defined filter will applied.
 * @return mixed|null|bool Term Row from database in the type specified by $filter. Will return false if $taxonomy does not exist or $term was not found.
 * @link https://docs.wpvip.com/technical-references/caching/uncached-functions/ Uncached Functions
 */
function wpcom_vip_get_term_by( $field, $value, $taxonomy, $output = OBJECT, $filter = &#039;raw&#039; ) {
	// ID lookups are cached
	if ( &#039;id&#039; === $field ) {
		return get_term_by( $field, $value, $taxonomy, $output, $filter );
	}

	$cache_key = $field . &#039;|&#039; . $taxonomy . &#039;|&#039; . md5( $value );
	$term_id = wp_cache_get( $cache_key, &#039;get_term_by&#039; );

	if ( false === $term_id ) {
		$term = get_term_by( $field, $value, $taxonomy );
		if ( $term &amp;&amp; ! is_wp_error( $term ) ) {
			wp_cache_set( $cache_key, $term-&gt;term_id, &#039;get_term_by&#039;, 4 * HOUR_IN_SECONDS );
		} else {
			wp_cache_set( $cache_key, 0, &#039;get_term_by&#039;, 15 * MINUTE_IN_SECONDS ); // if we get an invalid value, let&#039;s cache it anyway but for a shorter period of time
		}
	} else {
		$term = get_term( $term_id, $taxonomy, $output, $filter );
	}

	if ( is_wp_error( $term ) ) {
		$term = false;
	}

	return $term;
}

/**
 * Properly clear wpcom_vip_get_term_by() cache when a term is updated
 */
add_action( &#039;edit_terms&#039;, &#039;wp_flush_get_term_by_cache&#039;, 10, 2 );
add_action( &#039;create_term&#039;, &#039;wp_flush_get_term_by_cache&#039;, 10, 2 );
function wp_flush_get_term_by_cache( $term_id, $taxonomy ) {
	$term = get_term_by( &#039;id&#039;, $term_id, $taxonomy );
	if ( ! $term ) {
		return;
	}
	foreach ( array( &#039;name&#039;, &#039;slug&#039; ) as $field ) {
		$cache_key = $field . &#039;|&#039; . $taxonomy . &#039;|&#039; . md5( $term-&gt;$field );
		$cache_group = &#039;get_term_by&#039;;
		wp_cache_delete( $cache_key, $cache_group );
	}
}

/**
 * Cached version of term_exists()
 *
 * Term exists calls can pile up on a single pageload.
 * This function adds a layer of caching to prevent lots of queries.
 *
 * @param int|string $term The term to check can be id, slug or name.
 * @param string     $taxonomy The taxonomy name to use
 * @param int        $parent Optional. ID of parent term under which to confine the exists search.
 * @return mixed Returns null if the term does not exist. Returns the term ID
 *               if no taxonomy is specified and the term ID exists. Returns
 *               an array of the term ID and the term taxonomy ID the taxonomy
 *               is specified and the pairing exists.
 */

function wpcom_vip_term_exists( $term, $taxonomy = &#039;&#039;, $parent = null ) {
	// If $parent is not null, let&#039;s skip the cache.
	if ( null !== $parent ) {
		return term_exists( $term, $taxonomy, $parent );
	}

	if ( ! empty( $taxonomy ) ) {
		$cache_key = $term . &#039;|&#039; . $taxonomy;
	} else {
		$cache_key = $term;
	}

	$cache_value = wp_cache_get( $cache_key, &#039;term_exists&#039; );

	// term_exists frequently returns null, but (happily) never false
	if ( false === $cache_value ) {
		$term_exists = term_exists( $term, $taxonomy );
		wp_cache_set( $cache_key, $term_exists, &#039;term_exists&#039;, 3 * HOUR_IN_SECONDS );
	} else {
		$term_exists = $cache_value;
	}

	if ( is_wp_error( $term_exists ) ) {
		$term_exists = null;
	}

	return $term_exists;
}

/**
 * Properly clear wpcom_vip_term_exists() cache when a term is updated
 */
add_action( &#039;delete_term&#039;, &#039;wp_flush_term_exists&#039;, 10, 4 );
function wp_flush_term_exists( $term, $tt_id, $taxonomy, $deleted_term ) {
	foreach ( array( &#039;term_id&#039;, &#039;name&#039;, &#039;slug&#039; ) as $field ) {
		$cache_key = $deleted_term-&gt;$field . &#039;|&#039; . $taxonomy ;
		$cache_group = &#039;term_exists&#039;;
		wp_cache_delete( $cache_key, $cache_group );
	}
}

/**
 * Optimized version of get_term_link that adds caching for slug-based lookups.
 *
 * Returns permalink for a taxonomy term archive, or a WP_Error object if the term does not exist.
 *
 * @param int|string|object $term The term object / term ID / term slug whose link will be retrieved.
 * @param string            $taxonomy The taxonomy slug. NOT required if you pass the term object in the first parameter
 *
 * @return string|WP_Error HTML link to taxonomy term archive on success, WP_Error if term does not exist.
 */
function wpcom_vip_get_term_link( $term, $taxonomy = null ) {
	// ID- or object-based lookups already result in cached lookups, so we can ignore those.
	if ( is_numeric( $term ) || is_object( $term ) ) {
		return get_term_link( $term, $taxonomy );
	}

	$term_object = wpcom_vip_get_term_by( &#039;slug&#039;, $term, $taxonomy );
	return get_term_link( $term_object );
}

/**
 * Cached version of get_page_by_title so that we&#039;re not making unnecessary SQL all the time
 *
 * @param string $page_title Page title
 * @param string $output Optional. Output type; OBJECT*, ARRAY_N, or ARRAY_A.
 * @param string $post_type Optional. Post type; default is &#039;page&#039;.
 * @return WP_Post|null WP_Post on success or null on failure
 * @link https://docs.wpvip.com/technical-references/caching/uncached-functions/ Uncached Functions
 */
function wpcom_vip_get_page_by_title( $title, $output = OBJECT, $post_type = &#039;page&#039; ) {
	$cache_key = $post_type . &#039;_&#039; . sanitize_key( $title );
	$page_id = wp_cache_get( $cache_key, &#039;get_page_by_title&#039; );

	if ( false === $page_id ) {
		$page = get_page_by_title( $title, OBJECT, $post_type );
		$page_id = $page ? $page-&gt;ID : 0;
		wp_cache_set( $cache_key, $page_id, &#039;get_page_by_title&#039;, 3 * HOUR_IN_SECONDS ); // We only store the ID to keep our footprint small
	}

	if ( $page_id ) {
		return get_page( $page_id, $output );
	}

	return null;
}

/**
 * Cached version of get_page_by_path so that we&#039;re not making unnecessary SQL all the time
 *
 * @param string $page_path Page path
 * @param string $output Optional. Output type; OBJECT*, ARRAY_N, or ARRAY_A.
 * @param string $post_type Optional. Post type; default is &#039;page&#039;.
 * @return WP_Post|null WP_Post on success or null on failure
 * @link https://docs.wpvip.com/technical-references/caching/uncached-functions/ Uncached Functions
 */
function wpcom_vip_get_page_by_path( $page_path, $output = OBJECT, $post_type = &#039;page&#039; ) {
	if ( is_array( $post_type ) ) {
		$cache_key = sanitize_key( $page_path ) . &#039;_&#039; . md5( serialize( $post_type ) );
	} else {
		$cache_key = $post_type . &#039;_&#039; . sanitize_key( $page_path );
	}

	$page_id = wp_cache_get( $cache_key, &#039;get_page_by_path&#039; );

	if ( false === $page_id ) {
		$page = get_page_by_path( $page_path, $output, $post_type );
		$page_id = $page ? $page-&gt;ID : 0;
		if ( 0 === $page_id ) {
			wp_cache_set( $cache_key, $page_id, &#039;get_page_by_path&#039;, ( 1 * HOUR_IN_SECONDS + mt_rand( 0, HOUR_IN_SECONDS ) ) ); // We only store the ID to keep our footprint small
		} else {
			wp_cache_set( $cache_key, $page_id, &#039;get_page_by_path&#039;, 0 ); // We only store the ID to keep our footprint small
		}
	}

	if ( $page_id ) {
		return get_page( $page_id, $output );
	}

	return null;
}

/**
 * Flush the cache for published pages so we don&#039;t end up with stale data
 *
 * @param string  $new_status The post&#039;s new status
 * @param string  $old_status The post&#039;s previous status
 * @param WP_Post $post The post
 * @link https://docs.wpvip.com/technical-references/caching/uncached-functions/ Uncached Functions
 */
function wpcom_vip_flush_get_page_by_title_cache( $new_status, $old_status, $post ) {
	if ( &#039;publish&#039; === $new_status || &#039;publish&#039; === $old_status ) {
		wp_cache_delete( $post-&gt;post_type . &#039;_&#039; . sanitize_key( $post-&gt;post_title ), &#039;get_page_by_title&#039; );
	}
}
add_action( &#039;transition_post_status&#039;, &#039;wpcom_vip_flush_get_page_by_title_cache&#039;, 10, 3 );

/**
 * Flush the cache for published pages so we don&#039;t end up with stale data
 *
 * @param string  $new_status The post&#039;s new status
 * @param string  $old_status The post&#039;s previous status
 * @param WP_Post $post       The post
 *
 * @link https://docs.wpvip.com/technical-references/caching/uncached-functions/ Uncached Functions
 */
function wpcom_vip_flush_get_page_by_path_cache( $new_status, $old_status, $post ) {
	if ( &#039;publish&#039; === $new_status || &#039;publish&#039; === $old_status ) {
		$page_path = get_page_uri( $post-&gt;ID );
		wp_cache_delete( $post-&gt;post_type . &#039;_&#039; . sanitize_key( $page_path ), &#039;get_page_by_path&#039; );
	}
}
add_action( &#039;transition_post_status&#039;, &#039;wpcom_vip_flush_get_page_by_path_cache&#039;, 10, 3 );

/**
 * Cached version of url_to_postid, which can be expensive.
 *
 * Examine a url and try to determine the post ID it represents.
 *
 * @param string $url Permalink to check.
 * @return int Post ID, or 0 on failure.
 */
function wpcom_vip_url_to_postid( $url ) {
	$cache_key = md5( $url );
	$post_id = wp_cache_get( $cache_key, &#039;url_to_postid&#039; );

	if ( false === $post_id ) {
		$post_id = url_to_postid( $url ); // returns 0 on failure, so need to catch the false condition
		wp_cache_set( $cache_key, $post_id, &#039;url_to_postid&#039;, 3 * HOUR_IN_SECONDS );
	}

	return $post_id;
}

add_action( &#039;transition_post_status&#039;, function( $new_status, $old_status, $post ) {
	if ( &#039;publish&#039; !== $new_status &amp;&amp; &#039;publish&#039; !== $old_status ) {
		return;
	}

	$url = get_permalink( $post-&gt;ID );
	wp_cache_delete( md5( $url ), &#039;url_to_postid&#039; );
}, 10, 3 );

/**
 * Cached version of wp_old_slug_redirect.
 *
 * Cache the results of the _wp_old_slug meta query, which can be expensive.
 *
 * @deprecated use wpcom_vip_wp_old_slug_redirect instead
 */
function wpcom_vip_old_slug_redirect() {
	global $wp_query;
	if ( is_404() &amp;&amp; &#039;&#039; !== $wp_query-&gt;query_vars[&#039;name&#039;] ) {
		global $wpdb;

		// Guess the current post_type based on the query vars.
		if ( get_query_var( &#039;post_type&#039; ) ) {
			$post_type = get_query_var( &#039;post_type&#039; );
		} elseif ( ! empty( $wp_query-&gt;query_vars[&#039;pagename&#039;] ) ) {
			$post_type = &#039;page&#039;;
		} else {
			$post_type = &#039;post&#039;;
		}

		if ( is_array( $post_type ) ) {
			if ( count( $post_type ) &gt; 1 ) {
				return;
			}
			$post_type = array_shift( $post_type );
		}

		// Do not attempt redirect for hierarchical post types
		if ( is_post_type_hierarchical( $post_type ) ) {
			return;
		}

		$query = $wpdb-&gt;prepare( &quot;SELECT post_id FROM $wpdb-&gt;postmeta, $wpdb-&gt;posts WHERE ID = post_id AND post_type = %s AND meta_key = &#039;_wp_old_slug&#039; AND meta_value = %s&quot;, $post_type, $wp_query-&gt;query_vars[&#039;name&#039;] );

		// if year, monthnum, or day have been specified, make our query more precise
		// just in case there are multiple identical _wp_old_slug values
		if ( &#039;&#039; !== $wp_query-&gt;query_vars[&#039;year&#039;] ) {
			$query .= $wpdb-&gt;prepare( &#039; AND YEAR(post_date) = %d&#039;, $wp_query-&gt;query_vars[&#039;year&#039;] );
		}
		if ( &#039;&#039; !== $wp_query-&gt;query_vars[&#039;monthnum&#039;] ) {
			$query .= $wpdb-&gt;prepare( &#039; AND MONTH(post_date) = %d&#039;, $wp_query-&gt;query_vars[&#039;monthnum&#039;] );
		}
		if ( &#039;&#039; !== $wp_query-&gt;query_vars[&#039;day&#039;] ) {
			$query .= $wpdb-&gt;prepare( &#039; AND DAYOFMONTH(post_date) = %d&#039;, $wp_query-&gt;query_vars[&#039;day&#039;] );
		}

		$cache_key = md5( serialize( $query ) );

		if ( false === $id = wp_cache_get( $cache_key, &#039;wp_old_slug_redirect&#039; ) ) {
			$id = (int) $wpdb-&gt;get_var( $query );

			wp_cache_set( $cache_key, $id, &#039;wp_old_slug_redirect&#039;, 5 * MINUTE_IN_SECONDS );
		}

		if ( ! $id ) {
			return;
		}

		$link = get_permalink( $id );

		if ( ! $link ) {
			return;
		}

		wp_redirect( $link, 301 ); // Permanent redirect
		exit;
	}
}


/**
 * Cached version of count_user_posts, which is uncached but doesn&#039;t always need to hit the db
 *
 * count_user_posts is generally fast, but it can be easy to end up with many redundant queries
 * if it&#039;s called several times per request. This allows bypassing the db queries in favor of
 * the cache
 */
function wpcom_vip_count_user_posts( $user_id ) {
	if ( ! is_numeric( $user_id ) ) {
		return 0;
	}

	$cache_key = &#039;vip_&#039; . (int) $user_id;
	$cache_group = &#039;user_posts_count&#039;;

	if ( false === ( $count = wp_cache_get( $cache_key, $cache_group ) ) ) {
		$count = count_user_posts( $user_id );

		wp_cache_set( $cache_key, $count, $cache_group, 5 * MINUTE_IN_SECONDS );
	}

	return $count;
}

/*
 * Cached version of wp_get_nav_menu_object
 *
 * Many calls to get_term_by (with name or slug lookup as used inside the wp_get_nav_menu_object) across on a single pageload can easily add up the query count.
 * This function helps prevent that by taking advantage of wpcom_vip_get_term_by function which adds a layer of caching.
 *
 * @param string $menu Menu ID, slug, or name.
 * @uses wpcom_vip_get_term_by
 * @return mixed false if $menu param isn&#039;t supplied or term does not exist, menu object if successful.
 */
function wpcom_vip_get_nav_menu_object( $menu ) {
	if ( ! $menu ) {
		return false;
	}

	$menu_obj = get_term( $menu, &#039;nav_menu&#039; );

	if ( ! $menu_obj ) {
		$menu_obj = wpcom_vip_get_term_by( &#039;slug&#039;, $menu, &#039;nav_menu&#039; );
	}

	if ( ! $menu_obj ) {
		$menu_obj = wpcom_vip_get_term_by( &#039;name&#039;, $menu, &#039;nav_menu&#039; );
	}

	if ( ! $menu_obj ) {
		$menu_obj = false;
	}

	return $menu_obj;
}

/**
 * Require the Stampedeless_Cache class for use in our helper functions below.
 *
 * The Stampedeless_Cache helps prevent cache stampedes by internally varying the cache
 * expiration slightly when creating a cache entry in an effort to avoid multiple keys
 * expiring simultaneously and allowing a single request to regenerate the cache shortly
 * before it&#039;s expiration.
 */
if ( function_exists( &#039;require_lib&#039; ) &amp;&amp; defined( &#039;WPCOM_IS_VIP_ENV&#039; ) &amp;&amp; WPCOM_IS_VIP_ENV ) {
	require_lib( &#039;class.stampedeless-cache&#039; );
}

/**
 * Drop in replacement for wp_cache_set().
 *
 * Wrapper for the WPCOM Stampedeless_Cache class.
 *
 * @param string                  $key Cache key.
 * @param string|int|array|object $value Data to store in the cache.
 * @param string                  $group Optional. Cache group.
 * @param int                     $expiration Optional. Cache TTL in seconds.
 * @return bool This function always returns true.
 */
function wpcom_vip_cache_set( $key, $value, $group = &#039;&#039;, $expiration = 0 ) {
	if ( ! class_exists( &#039;Stampedeless_Cache&#039; ) ) {
		return wp_cache_set( $key, $value, $group, $expiration );
	}

	$sc = new Stampedeless_Cache( $key, $group );
	$sc-&gt;set( $value, $expiration );

	return true;
}

/**
 * Drop in replacement for wp_cache_get().
 *
 * Wrapper for the WPCOM Stampedeless_Cache class.
 *
 * @param string $key Cache key.
 * @param string $group Optional. Cache group.
 * @return mixed Returns false if failing to retrieve cache entry or the cached data otherwise.
 */
function wpcom_vip_cache_get( $key, $group = &#039;&#039; ) {
	if ( ! class_exists( &#039;Stampedeless_Cache&#039; ) ) {
		return wp_cache_get( $key, $group );
	}

	$sc = new Stampedeless_Cache( $key, $group );

	return $sc-&gt;get();
}

/**
 * Drop in replacement for wp_cache_delete().
 *
 * Wrapper for WPCOM Stampedeless_Cache class.
 *
 * @param string $key Cache key.
 * @param string $group Optional. Cache group.
 * @return bool True on successful removal, false on failure.
 */
function wpcom_vip_cache_delete( $key, $group = &#039;&#039; ) {
	// delete cache itself
	$deleted = wp_cache_delete( $key, $group );

	if ( class_exists( &#039;Stampedeless_Cache&#039; ) ) {
		// delete lock
		$lock_key = $key . &#039;_lock&#039;;
		wp_cache_delete( $lock_key, $group );
	}

	return $deleted;
}

/**
 * Retrieve adjacent post.
 *
 * Can either be next or previous post. The logic for excluding terms is handled within PHP, for performance benefits.
 * Props to Elliott Stocks
 *
 * @global wpdb $wpdb
 *
 * @param bool   $in_same_term   Optional. Whether post should be in a same taxonomy term. Note - only the first term will be used from wp_get_object_terms().
 * @param int    $excluded_term  Optional. The term to exclude.
 * @param bool   $previous       Optional. Whether to retrieve previous post.
 * @param string $taxonomy       Optional. Taxonomy, if $in_same_term is true. Default &#039;category&#039;.
 *
 * @return null|string|WP_Post Post object if successful. Null if global $post is not set. Empty string if no corresponding post exists.
 */
function wpcom_vip_get_adjacent_post( $in_same_term = false, $excluded_terms = &#039;&#039;, $previous = true, $taxonomy = &#039;category&#039;, $adjacent = &#039;&#039; ) {
	global $wpdb;
	if ( ( ! $post = get_post() ) || ! taxonomy_exists( $taxonomy ) ) {
		return null;
	}
	$join = &#039;&#039;;
	$where = &#039;&#039;;
	$current_post_date = $post-&gt;post_date;

	if ( $in_same_term ) {
		if ( is_object_in_taxonomy( $post-&gt;post_type, $taxonomy ) ) {
			$term_array = get_the_terms( $post-&gt;ID, $taxonomy );
			if ( ! empty( $term_array ) &amp;&amp; ! is_wp_error( $term_array ) ) {
				$term_array_ids = wp_list_pluck( $term_array, &#039;term_id&#039; );
				// Remove any exclusions from the term array to include.
				$excluded_terms = explode( &#039;,&#039;, $excluded_terms );
				if ( ! empty( $excluded_terms ) ) {
					$term_array_ids = array_diff( $term_array_ids, (array) $excluded_terms );
				}
				if ( ! empty( $term_array_ids ) ) {
					$term_array_ids = array_map( &#039;intval&#039;, $term_array_ids );
					$term_id_to_search = array_pop( $term_array_ids ); // only allow for a single term to be used. picked pseudo randomly
				} else {
					$term_id_to_search = false;
				}

				$term_id_to_search = apply_filters( &#039;wpcom_vip_limit_adjacent_post_term_id&#039;, $term_id_to_search, $term_array_ids, $excluded_terms, $taxonomy, $previous );

				if ( ! empty( $term_id_to_search ) ) {  // allow filters to short circuit by returning a empty like value
					$join = &quot; INNER JOIN $wpdb-&gt;term_relationships AS tr ON p.ID = tr.object_id INNER JOIN $wpdb-&gt;term_taxonomy tt ON tr.term_taxonomy_id = tt.term_taxonomy_id&quot;; // Only join if we are sure there is a term
					$where = $wpdb-&gt;prepare( &#039;AND tt.taxonomy = %s AND tt.term_id IN (%d)  &#039;, $taxonomy,$term_id_to_search ); //
				}
			}
		}
	}

	$op = $previous ? &#039;&lt;&#039; : &#039;&gt;&#039;;
	$order = $previous ? &#039;DESC&#039; : &#039;ASC&#039;;
	$limit = 1;
	// We need 5 posts so we can filter the excluded term later on
	if ( ! empty( $excluded_term ) ) {
		$limit = 5;
	}
	$sort  = &quot;ORDER BY p.post_date $order LIMIT $limit&quot;;
	$where = $wpdb-&gt;prepare( &quot;WHERE p.post_date $op %s AND p.post_type = %s AND p.post_status = &#039;publish&#039; $where&quot;, $current_post_date, $post-&gt;post_type );
	$query = &quot;SELECT p.ID FROM $wpdb-&gt;posts AS p $join $where $sort&quot;;

	$found_post = &#039;&#039;; // blank instead of false so not found is cached.
	$query_key = &#039;wpcom_vip_adjacent_post_&#039; . md5( $query );
	$cached_result = wp_cache_get( $query_key );

	if ( &#039;not found&#039; === $cached_result ) {
		return false;
	} elseif ( false !== $cached_result ) {
		return get_post( $cached_result );
	}

	if ( empty( $excluded_term ) ) {
		$result = $wpdb-&gt;get_var( $query );
	} else {
		$result = $wpdb-&gt;get_results( $query );
	}

	// Find the first post which doesn&#039;t have an excluded term
	if ( ! empty( $excluded_term ) ) {
		foreach ( $result as $result_post ) {
			$post_terms = get_the_terms( $result_post, $taxonomy );
			$terms_array = wp_list_pluck( $post_terms, &#039;term_id&#039; );
			if ( ! in_array( $excluded_term, $terms_array, true ) ) {
				$found_post = $result_post-&gt;ID;
				break;
			}
		}
	} else {
		$found_post = $result;
	}

	// If the post isn&#039;t found lets cache a value we&#039;ll check against. Add some variation in the caching so if a site is being crawled all the caches don&#039;t get created all the time.
	if ( empty( $found_post ) ) {
		wp_cache_set( $query_key, &#039;not found&#039;, &#039;default&#039;, 15 * MINUTE_IN_SECONDS + rand( 0, 15 * MINUTE_IN_SECONDS ) );
		return false;
	}

	wp_cache_set( $query_key, $found_post, &#039;default&#039;, 6 * HOUR_IN_SECONDS + rand( 0, 2 * HOUR_IN_SECONDS ) );
	$found_post = get_post( $found_post );

	return $found_post;
}

function wpcom_vip_attachment_cache_key( $url ) {
	return &#039;wpcom_vip_attachment_url_post_id_&#039; . md5( $url );
}

function wpcom_vip_attachment_url_to_postid( $url ) {
	$cache_key = wpcom_vip_attachment_cache_key( $url );
	$id        = wp_cache_get( $cache_key );
	if ( false === $id ) {
		$id = attachment_url_to_postid( $url );
		if ( empty( $id ) ) {
			wp_cache_set( $cache_key , &#039;not_found&#039;, &#039;default&#039;, 12 * HOUR_IN_SECONDS + mt_rand( 0, 4 * HOUR_IN_SECONDS ) );
		} else {
			wp_cache_set( $cache_key , $id, &#039;default&#039;, 24 * HOUR_IN_SECONDS + mt_rand( 0, 12 * HOUR_IN_SECONDS ) );
		}
	} elseif ( &#039;not_found&#039; === $id ) {
		return false;
	}
	return $id;
}

/**
 * Remove cached post ID when attachment post deleted
 *
 * @see wpcom_vip_attachment_url_to_postid()
 */
add_action( &#039;delete_attachment&#039;, function ( $post_id ) {
	$url = wp_get_attachment_url( $post_id );
	$cache_key = wpcom_vip_attachment_cache_key( $url );
	wp_cache_delete( $cache_key, &#039;default&#039; );
} );

/**
 * Use this function to cache the comment counting in the wp menu that can be slow on sites with lots of comments
 * use like this:
 *
 * @param $post_id
 *
 * @see wp_count_comments()
 * @return bool|false|mixed|string
 */
function wpcom_vip_cache_full_comment_counts( $counts = false, $post_id = 0 ) {
	// We are only caching the global comment counts for now since those are often in the millions while the per page one is usually more reasonable.
	if ( 0 !== $post_id ) {
		return $counts;
	}
	$cache_key = &quot;vip-comments-{$post_id}&quot;;
	$stats_object = wp_cache_get( $cache_key );

	// retrieve comments in the same way wp_count_comments() does
	if ( false === $stats_object ) {
		$stats = get_comment_count( $post_id );
		$stats[&#039;moderated&#039;] = $stats[&#039;awaiting_moderation&#039;];
		unset( $stats[&#039;awaiting_moderation&#039;] );
		$stats_object = (object) $stats;

		wp_cache_set( $cache_key, $stats_object, &#039;default&#039;, 30 * MINUTE_IN_SECONDS );
	}

	return $stats_object;

}

function wpcom_vip_enable_cache_full_comment_counts() {
	add_filter( &#039;wp_count_comments&#039;, &#039;wpcom_vip_cache_full_comment_counts&#039;, 10, 2 );
}


function wpcom_vip_enable_old_slug_redirect_caching() {
	add_action( &#039;template_redirect&#039;, &#039;wpcom_vip_wp_old_slug_redirect&#039;, 8 );
	// Hook the following actions to after the core&#039;s wp_check_for_changed_slugs - it&#039;s being hooke at prio 12
	add_action( &#039;post_updated&#039;, &#039;wpcom_vip_flush_wp_old_slug_redirect_cache&#039;, 13, 3 );
	add_action( &#039;attachment_updated&#039;, &#039;wpcom_vip_flush_wp_old_slug_redirect_cache&#039;, 13, 3 );
}

/**
 * This works by first looking in the cache to see if there is a value saved based on the name query var.
 * If one is found, redirect immediately. If nothing is found, including that there is no already cache &quot;not_found&quot; value we then add a hook to old_slug_redirect_url so that when the &#039;rea&#039; wp_old_slug_redirect is run it will store the value in the cache @see wpcom_vip_set_old_slug_redirect_cache(). If we found a not_found we remove the template_redirect so the slow query is not run.
 */
function wpcom_vip_wp_old_slug_redirect() {
	global $wp_query;
	if ( is_404() &amp;&amp; &#039;&#039; !== $wp_query-&gt;query_vars[&#039;name&#039;] ) {

		$redirect = wp_cache_get( &#039;old_slug&#039; . $wp_query-&gt;query_vars[&#039;name&#039;] );

		if ( false === $redirect ) {
			// Run the caching callback as the very firts one in order to capture the value returned by WordPress from database. This allows devs from using `old_slug_redirect_url` filter w/o polluting the cache
			add_filter( &#039;old_slug_redirect_url&#039;, &#039;wpcom_vip_set_old_slug_redirect_cache&#039;, -9999, 1 );
			// If an old slug is not found the function returns early and does not apply the old_slug_redirect_url filter. so we will set the cache for not found and if it is found it will be overwritten later in wpcom_vip_set_old_slug_redirect_cache()
			wp_cache_set( &#039;old_slug&#039; . $wp_query-&gt;query_vars[&#039;name&#039;], &#039;not_found&#039;, &#039;default&#039;, 12 * HOUR_IN_SECONDS + mt_rand( 0, 12 * HOUR_IN_SECONDS ) );
		} elseif ( &#039;not_found&#039; === $redirect ) {
			// wpcom_vip_set_old_slug_redirect_cache() will cache &#039;not_found&#039; when a url is not found so we don&#039;t keep hammering the database
			remove_action( &#039;template_redirect&#039;, &#039;wp_old_slug_redirect&#039; );
			return;
		} else {
			/** This filter is documented in wp-includes/query.php. */
			$redirect = apply_filters( &#039;old_slug_redirect_url&#039;, $redirect );
			wp_redirect( $redirect, 301 ); // this is kept to not safe_redirect to match the functionality of wp_old_slug_redirect
			exit;
		}
	}
}
function wpcom_vip_set_old_slug_redirect_cache( $link ) {
	global $wp_query;
	if ( ! empty( $link ) ) {
		wp_cache_set( &#039;old_slug&#039; . $wp_query-&gt;query_vars[&#039;name&#039;], $link, &#039;default&#039;, 7 * DAY_IN_SECONDS );
	}
	return $link;
}
function wpcom_vip_flush_wp_old_slug_redirect_cache( $post_id, $post, $post_before ) {
	// Don&#039;t bother if the slug or date hasn&#039;t changed.
	if ( $post-&gt;post_name == $post_before-&gt;post_name &amp;&amp; $post-&gt;post_date == $post_before-&gt;post_date ) {
		return;
	}

	// We&#039;re only concerned with published, non-hierarchical objects.
	if ( ! ( &#039;publish&#039; === $post-&gt;post_status || ( &#039;attachment&#039; === get_post_type( $post ) &amp;&amp; &#039;inherit&#039; === $post-&gt;post_status ) ) || is_post_type_hierarchical( $post-&gt;post_type ) ) {
		return;
	}

	// Flush cache for all old slugs.
	$old_slugs = (array) get_post_meta( $post_id, &#039;_wp_old_slug&#039; );

	foreach ( $old_slugs as $old_slug ) {
		wp_cache_delete( &#039;old_slug&#039; . $old_slug, &#039;default&#039; );
	}

	// FLush cache for new post_name since it could had been among old slugs before this update.
	wp_cache_delete( &#039;old_slug&#039; . $post-&gt;post_name, &#039;default&#039; );
}

/**
 * Potentially skip redirect for old slugs.
 *
 * We&#039;re seeing an increase of URLs that match this pattern: http://example.com/http://othersite.com/random_text.
 *
 * These then cause really slow lookups inside of wp_old_slug_redirect. Since wp_old_slug redirect does not match
 * on full URLs but rather former slugs, it&#039;s safe to skip the lookup for these. Most of the calls are from bad ad
 * providers that generate random URLs.
 */
function wpcom_vip_maybe_skip_old_slug_redirect() {
	if ( ! is_404() ) {
		return;
	}

	if ( ! isset( $_SERVER[&#039;REQUEST_URI&#039;] ) ) {
		return;
	}

	if ( 0 === strpos( $_SERVER[&#039;REQUEST_URI&#039;], &#039;/http:&#039; ) || 0 === strpos( $_SERVER[&#039;REQUEST_URI&#039;], &#039;/https:&#039; ) ) {
		remove_action( &#039;template_redirect&#039;, &#039;wp_old_slug_redirect&#039; );
		remove_action( &#039;template_redirect&#039;, &#039;wpcom_vip_wp_old_slug_redirect&#039;, 8 );
	}
}

function wpcom_vip_enable_maybe_skip_old_slug_redirect() {
	add_action( &#039;template_redirect&#039;, &#039;wpcom_vip_maybe_skip_old_slug_redirect&#039;, 7 ); //Run this before wpcom_vip_wp_old_slug_redirect so we can also remove our caching helper
}

/**
 * Reset the local WordPress object cache
 *
 * This only cleans the local cache in WP_Object_Cache, without
 * affecting memcache
 */
function vip_reset_local_object_cache() {
	global $wp_object_cache;

	if ( ! is_object( $wp_object_cache ) ) {
		return;
	}

	$wp_object_cache-&gt;group_ops = array();
	$wp_object_cache-&gt;memcache_debug = array();
	$wp_object_cache-&gt;cache = array();

	if ( is_callable( $wp_object_cache, &#039;__remoteset&#039; ) ) {
		$wp_object_cache-&gt;__remoteset(); // important
	}
}

/**
 * Reset the WordPress DB query log
 */
function vip_reset_db_query_log() {
	global $wpdb;

	$wpdb-&gt;queries = array();
}
</code></pre>
            </article>
                <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
            </div>
        </div>
        <a href="files/vip-helpers-vip-caching.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
</body>
</html>
