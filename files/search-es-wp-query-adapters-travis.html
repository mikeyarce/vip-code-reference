<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>VIP Go mu-plugins</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
            <script src="js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">VIP Go mu-plugins</a><span class="title-separator">/</span>mu-plugins</h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -four phpdocumentor-sidebar">
        
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/automattic-wp.html"><abbr title="\Automattic\WP">WP</abbr></a></li>
                                            <li><a href="namespaces/automattic-vip.html"><abbr title="\Automattic\VIP">VIP</abbr></a></li>
                                    </ul>
                            <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/tubalmartin.html"><abbr title="\tubalmartin">tubalmartin</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/tubalmartin-cssmin.html"><abbr title="\tubalmartin\CssMin">CssMin</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/VIP.html"><abbr title="\VIP">VIP</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/a8c.html"><abbr title="\a8c">a8c</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/a8c-Cron.html"><abbr title="\a8c\Cron">Cron</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/Http.html"><abbr title="\Http">Http</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/Http-Concat.html"><abbr title="\Http\Concat">Concat</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/ES.html"><abbr title="\ES">ES</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/ES-WP.html"><abbr title="\ES\WP">WP</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/wp.html"><abbr title="\wp">wp</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/wp-cli.html"><abbr title="\wp\cli">cli</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="hooks/hooks.html">Hooks</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">travis.php</h2>

            <p class="phpdocumentor-summary">ES_WP_Query adapters: Travis CI adapter</p>

    <section class="phpdocumentor-description"><p>Code in this file will only ever be run in a Travis CI context when running
unit tests.</p>
</section>






<h3 id="interfaces_class_traits">
    Interfaces, Classes and Traits
    <a href="#interfaces_class_traits" class="headerlink"><i class="fas fa-link"></i></a>
</h3>

<dl class="phpdocumentor-table-of-contents">
    
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/ES-WP-Query.html"><abbr title="\ES_WP_Query">ES_WP_Query</abbr></a></dt>
        <dd>A generic ES implementation for Travis CI.</dd>
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/ES-Index-Exception.html"><abbr title="\ES_Index_Exception">ES_Index_Exception</abbr></a></dt>
        <dd>A class to represent an exception that fires when indexing fails.</dd>
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/Travis-ES-Post.html"><abbr title="\Travis_ES_Post">Travis_ES_Post</abbr></a></dt>
        <dd>Taken from SearchPress.</dd>
    
    </dl>


<h3 id="toc">
    Table of Contents
    <a href="#toc" class="headerlink"><i class="fas fa-link"></i></a>
</h3>

<dl class="phpdocumentor-table-of-contents">
                        <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_travis_es_field_map">travis_es_field_map()</a>
    <span>
                        &nbsp;: array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Provides a mapping between WordPress fields and Elasticsearch DSL keys.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_es_wp_query_verify_es_is_running">es_wp_query_verify_es_is_running()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Verifies that the Elasticsearch server is up and accepting connections.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_es_wp_query_index_test_data">es_wp_query_index_test_data()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Indexes test data.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_travis_es_verify_response_code">travis_es_verify_response_code()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Verifies the Elasticsearch response code.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_travis_es_debug_backtrace_summary">travis_es_debug_backtrace_summary()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Provides a backtrace summary for error reporting in Travis tests.</dd>

    </dl>



        

            <section class="phpdocumentor-functions">
        <h3 class="phpdocumentor-elements__header" id="functions">
            Functions
            <a href="files/search-es-wp-query-adapters-travis.html#functions" class="headerlink"><i class="fas fa-link"></i></a>
        </h3>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_travis_es_field_map">
        travis_es_field_map()
        <a href="namespaces/default.html#function_travis_es_field_map" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="search/es-wp-query/adapters/travis.php"><a href="files/search-es-wp-query-adapters-travis.html"><abbr title="search/es-wp-query/adapters/travis.php">travis.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">51</span>
</aside>

        <p class="phpdocumentor-summary">Provides a mapping between WordPress fields and Elasticsearch DSL keys.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">travis_es_field_map</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$es_map</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$es_map</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Additional mappings to layer on top of the default.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_es_wp_query_verify_es_is_running">
        es_wp_query_verify_es_is_running()
        <a href="namespaces/default.html#function_es_wp_query_verify_es_is_running" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="search/es-wp-query/adapters/travis.php"><a href="files/search-es-wp-query-adapters-travis.html"><abbr title="search/es-wp-query/adapters/travis.php">travis.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">76</span>
</aside>

        <p class="phpdocumentor-summary">Verifies that the Elasticsearch server is up and accepting connections.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">es_wp_query_verify_es_is_running</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$tries</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">5</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$sleep</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">3</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$tries</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">5</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The number of retries to attempt.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$sleep</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">3</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The amount of time to sleep between retries.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/ES-Index-Exception.html"><abbr title="\ES_Index_Exception">ES_Index_Exception</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If the indexing operation fails.</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_es_wp_query_index_test_data">
        es_wp_query_index_test_data()
        <a href="namespaces/default.html#function_es_wp_query_index_test_data" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="search/es-wp-query/adapters/travis.php"><a href="files/search-es-wp-query-adapters-travis.html"><abbr title="search/es-wp-query/adapters/travis.php">travis.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">108</span>
</aside>

        <p class="phpdocumentor-summary">Indexes test data.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">es_wp_query_index_test_data</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/ES-Index-Exception.html"><abbr title="\ES_Index_Exception">ES_Index_Exception</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If the indexing operation fails.</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_travis_es_verify_response_code">
        travis_es_verify_response_code()
        <a href="namespaces/default.html#function_travis_es_verify_response_code" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="search/es-wp-query/adapters/travis.php"><a href="files/search-es-wp-query-adapters-travis.html"><abbr title="search/es-wp-query/adapters/travis.php">travis.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">409</span>
</aside>

        <p class="phpdocumentor-summary">Verifies the Elasticsearch response code.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">travis_es_verify_response_code</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr>|array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$response</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$response</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr>|array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The response from wp_remote_request.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/ES-Index-Exception.html"><abbr title="\ES_Index_Exception">ES_Index_Exception</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>If the indexing fails.</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_travis_es_debug_backtrace_summary">
        travis_es_debug_backtrace_summary()
        <a href="namespaces/default.html#function_travis_es_debug_backtrace_summary" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="search/es-wp-query/adapters/travis.php"><a href="files/search-es-wp-query-adapters-travis.html"><abbr title="search/es-wp-query/adapters/travis.php">travis.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">430</span>
</aside>

        <p class="phpdocumentor-summary">Provides a backtrace summary for error reporting in Travis tests.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">travis_es_debug_backtrace_summary</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"></section>

    
    

    
</article>
            </section>

                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php // phpcs:disable
/**
 * ES_WP_Query adapters: Travis CI adapter
 *
 * Code in this file will only ever be run in a Travis CI context when running
 * unit tests.
 *
 * @package ES_WP_Query
 */

/**
 * A generic ES implementation for Travis CI.
 */
class ES_WP_Query extends ES_WP_Query_Wrapper {

	/**
	 * Implements the abstract function query_es from ES_WP_Query_Wrapper.
	 *
	 * @param array $es_args Arguments to pass to the Elasticsearch server.
	 * @access protected
	 * @return array The response from the Elasticsearch server.
	 */
	protected function query_es( $es_args ) {
		global $es_wp_query_travis_doc_type;

		$response = wp_remote_post(
			&quot;http://localhost:9200/es-wp-query-unit-tests/{$es_wp_query_travis_doc_type}/_search&quot;,
			array(
				&#039;body&#039;    =&gt; wp_json_encode( $es_args ),
				&#039;headers&#039; =&gt; array(
					&#039;Content-Type&#039; =&gt; &#039;application/json&#039;,
				),
			)
		);
		return json_decode( wp_remote_retrieve_body( $response ), true );
	}
}

/**
 * A class to represent an exception that fires when indexing fails.
 */
class ES_Index_Exception extends Exception {
}

/**
 * Provides a mapping between WordPress fields and Elasticsearch DSL keys.
 *
 * @param array $es_map Additional mappings to layer on top of the default.
 * @return array Mappings to use.
 */
function travis_es_field_map( $es_map ) {
	return wp_parse_args(
		array(
			&#039;post_meta&#039;         =&gt; &#039;post_meta.%s.value&#039;,
			&#039;post_author&#039;       =&gt; &#039;post_author.user_id&#039;,
			&#039;post_date&#039;         =&gt; &#039;post_date.date&#039;,
			&#039;post_date_gmt&#039;     =&gt; &#039;post_date_gmt.date&#039;,
			&#039;post_modified&#039;     =&gt; &#039;post_modified.date&#039;,
			&#039;post_modified_gmt&#039; =&gt; &#039;post_modified_gmt.date&#039;,
		),
		$es_map
	);
}
add_filter( &#039;es_field_map&#039;, &#039;travis_es_field_map&#039; );

if ( defined( &#039;ES_WP_QUERY_TEST_ENV&#039; ) &amp;&amp; ES_WP_QUERY_TEST_ENV ) {

	/**
	 * Verifies that the Elasticsearch server is up and accepting connections.
	 *
	 * @param int $tries The number of retries to attempt.
	 * @param int $sleep The amount of time to sleep between retries.
	 * @return bool True if the server is up, false if not.
	 * @throws ES_Index_Exception If the indexing operation fails.
	 */
	function es_wp_query_verify_es_is_running( $tries = 5, $sleep = 3 ) {
		// Make sure ES is running and responding.
		do {
			$response = wp_remote_get( &#039;http://localhost:9200/&#039; );
			if ( 200 === intval( wp_remote_retrieve_response_code( $response ) ) ) {
				$body = json_decode( wp_remote_retrieve_body( $response ), true );
				if ( ! empty( $body[&#039;version&#039;][&#039;number&#039;] ) ) {
					printf( &quot;Elasticsearch is up and running, using version %s.\n&quot;, $body[&#039;version&#039;][&#039;number&#039;] );
					if ( ! defined( &#039;ES_VERSION&#039; ) ) {
						define( &#039;ES_VERSION&#039;, $body[&#039;version&#039;][&#039;number&#039;] );
					} elseif ( ES_VERSION !== $body[&#039;version&#039;][&#039;number&#039;] ) {
						printf( &quot;WARNING! ES_VERSION is set to %s, but Elasticsearch is reporting %s\n&quot;, ES_VERSION, $body[&#039;version&#039;][&#039;number&#039;] );
					}
					break;
				} else {
					sleep( $sleep );
				}
			} else {
				printf( &quot;\nInvalid response from ES (%s), sleeping %d seconds and trying again...\n&quot;, wp_remote_retrieve_response_code( $response ), $sleep );
				sleep( $sleep );
			}
		} while ( --$tries );

		// If we didn&#039;t end with a 200 status code, bail.
		return travis_es_verify_response_code( $response );
	}

	/**
	 * Indexes test data.
	 *
	 * @throws ES_Index_Exception If the indexing operation fails.
	 */
	function es_wp_query_index_test_data() {
		global $es_wp_query_travis_doc_type;
		$es_wp_query_travis_doc_type = &#039;_doc&#039;;

		// Ensure the index is empty.
		wp_remote_request( &#039;http://localhost:9200/es-wp-query-unit-tests/&#039;, array( &#039;method&#039; =&gt; &#039;DELETE&#039; ) );

		$analyzed       = &#039;text&#039;;
		$not_analyzed   = &#039;keyword&#039;;
		$doc_type_open  = &#039;&#039;;
		$doc_type_close = &#039;&#039;;
		if ( version_compare( ES_VERSION, &#039;5.0.0&#039;, &#039;&lt;&#039; ) ) {
			$analyzed     = &#039;string&#039;;
			$not_analyzed = &#039;string&quot;, &quot;index&quot;: &quot;not_analyzed&#039;;
		}
		if ( version_compare( ES_VERSION, &#039;6.0.0&#039;, &#039;&lt;&#039; ) ) {
			// ES &lt; 6 doesn&#039;t support the doc type _doc.
			$es_wp_query_travis_doc_type = &#039;post&#039;;
		}
		if ( version_compare( ES_VERSION, &#039;7.0.0&#039;, &#039;&lt;&#039; ) ) {
			$doc_type_open  = sprintf( &#039;&quot;%s&quot;: {&#039;, $es_wp_query_travis_doc_type );
			$doc_type_close = &#039;}&#039;;
		}

		// Add the mapping.
		$response = wp_remote_request(
			&#039;http://localhost:9200/es-wp-query-unit-tests/&#039;,
			array(
				&#039;method&#039;  =&gt; &#039;PUT&#039;,
				&#039;body&#039;    =&gt; sprintf(
					&#039;
						{
							&quot;settings&quot;: {
								&quot;analysis&quot;: {
									&quot;analyzer&quot;: {
										&quot;default&quot;: {
											&quot;tokenizer&quot;: &quot;standard&quot;,
											&quot;filter&quot;: [
												&quot;travis_word_delimiter&quot;,
												&quot;lowercase&quot;,
												&quot;stop&quot;,
												&quot;travis_snowball&quot;
											],
											&quot;language&quot;: &quot;English&quot;
										}
									},
									&quot;filter&quot;: {
										&quot;travis_word_delimiter&quot;: {
											&quot;type&quot;: &quot;word_delimiter&quot;,
											&quot;preserve_original&quot;: true
										},
										&quot;travis_snowball&quot;: {
											&quot;type&quot;: &quot;snowball&quot;,
											&quot;language&quot;: &quot;English&quot;
										}
									}
								}
							},
							&quot;mappings&quot;: {
								%3$s
									&quot;date_detection&quot;: false,
									&quot;dynamic_templates&quot;: [
										{
											&quot;template_meta&quot;: {
												&quot;path_match&quot;: &quot;post_meta.*&quot;,
												&quot;mapping&quot;: {
													&quot;type&quot;: &quot;object&quot;,
													&quot;properties&quot;: {
														&quot;value&quot;: {
															&quot;type&quot;: &quot;%2$s&quot;
														},
														&quot;analyzed&quot;: {
															&quot;type&quot;: &quot;%1$s&quot;
														},
														&quot;boolean&quot;: {
															&quot;type&quot;: &quot;boolean&quot;
														},
														&quot;long&quot;: {
															&quot;type&quot;: &quot;long&quot;
														},
														&quot;double&quot;: {
															&quot;type&quot;: &quot;double&quot;
														},
														&quot;date&quot;: {
															&quot;format&quot;: &quot;yyyy-MM-dd&quot;,
															&quot;type&quot;: &quot;date&quot;
														},
														&quot;datetime&quot;: {
															&quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot;,
															&quot;type&quot;: &quot;date&quot;
														},
														&quot;time&quot;: {
															&quot;format&quot;: &quot;HH:mm:ss&quot;,
															&quot;type&quot;: &quot;date&quot;
														}
													}
												}
											}
										},
										{
											&quot;template_terms&quot;: {
												&quot;path_match&quot;: &quot;terms.*&quot;,
												&quot;mapping&quot;: {
													&quot;type&quot;: &quot;object&quot;,
													&quot;properties&quot;: {
														&quot;name&quot;: { &quot;type&quot;: &quot;%2$s&quot; },
														&quot;term_id&quot;: { &quot;type&quot;: &quot;long&quot; },
														&quot;term_taxonomy_id&quot;: { &quot;type&quot;: &quot;long&quot; },
														&quot;slug&quot;: { &quot;type&quot;: &quot;%2$s&quot; }
													}
												}
											}
										}
									],
									&quot;properties&quot;: {
										&quot;post_id&quot;: { &quot;type&quot;: &quot;long&quot; },
										&quot;post_author&quot;: {
											&quot;type&quot;: &quot;object&quot;,
											&quot;properties&quot;: {
												&quot;user_id&quot;: { &quot;type&quot;: &quot;long&quot; },
												&quot;user_nicename&quot;: { &quot;type&quot;: &quot;%2$s&quot; }
											}
										},
										&quot;post_title&quot;: {
											&quot;type&quot;: &quot;%2$s&quot;,
											&quot;fields&quot;: {
												&quot;analyzed&quot;: { &quot;type&quot;: &quot;%1$s&quot; }
											}
										},
										&quot;post_excerpt&quot;: { &quot;type&quot;: &quot;%1$s&quot; },
										&quot;post_content&quot;: {
											&quot;type&quot;: &quot;%2$s&quot;,
											&quot;fields&quot;: {
												&quot;analyzed&quot;: { &quot;type&quot;: &quot;%1$s&quot; }
											}
										},
										&quot;post_status&quot;: { &quot;type&quot;: &quot;%2$s&quot; },
										&quot;post_name&quot;: { &quot;type&quot;: &quot;%2$s&quot; },
										&quot;post_parent&quot;: { &quot;type&quot;: &quot;long&quot; },
										&quot;post_type&quot;: { &quot;type&quot;: &quot;%2$s&quot; },
										&quot;post_mime_type&quot;: { &quot;type&quot;: &quot;%2$s&quot; },
										&quot;post_password&quot;: { &quot;type&quot;: &quot;%2$s&quot; },
										&quot;post_date&quot;: {
											&quot;type&quot;: &quot;object&quot;,
											&quot;properties&quot;: {
												&quot;date&quot;: { &quot;type&quot;: &quot;date&quot;, &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot; },
												&quot;year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;month&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;hour&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;minute&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;second&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;seconds_from_day&quot;: { &quot;type&quot;: &quot;integer&quot; },
												&quot;seconds_from_hour&quot;: { &quot;type&quot;: &quot;short&quot; }
											}
										},
										&quot;post_date_gmt&quot;: {
											&quot;type&quot;: &quot;object&quot;,
											&quot;properties&quot;: {
												&quot;date&quot;: { &quot;type&quot;: &quot;date&quot;, &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot; },
												&quot;year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;month&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;hour&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;minute&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;second&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;seconds_from_day&quot;: { &quot;type&quot;: &quot;integer&quot; },
												&quot;seconds_from_hour&quot;: { &quot;type&quot;: &quot;short&quot; }
											}
										},
										&quot;post_modified&quot;: {
											&quot;type&quot;: &quot;object&quot;,
											&quot;properties&quot;: {
												&quot;date&quot;: { &quot;type&quot;: &quot;date&quot;, &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot; },
												&quot;year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;month&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;hour&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;minute&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;second&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;seconds_from_day&quot;: { &quot;type&quot;: &quot;integer&quot; },
												&quot;seconds_from_hour&quot;: { &quot;type&quot;: &quot;short&quot; }
											}
										},
										&quot;post_modified_gmt&quot;: {
											&quot;type&quot;: &quot;object&quot;,
											&quot;properties&quot;: {
												&quot;date&quot;: { &quot;type&quot;: &quot;date&quot;, &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot; },
												&quot;year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;month&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;hour&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;minute&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;second&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_week&quot;: { &quot;type&quot;: &quot;byte&quot; },
												&quot;day_of_year&quot;: { &quot;type&quot;: &quot;short&quot; },
												&quot;seconds_from_day&quot;: { &quot;type&quot;: &quot;integer&quot; },
												&quot;seconds_from_hour&quot;: { &quot;type&quot;: &quot;short&quot; }
											}
										},
										&quot;menu_order&quot; : { &quot;type&quot; : &quot;integer&quot; },
										&quot;terms&quot;: { &quot;type&quot;: &quot;object&quot; },
										&quot;post_meta&quot;: { &quot;type&quot;: &quot;object&quot; }
									}
								%4$s
							}
						}
					&#039;,
					$analyzed,
					$not_analyzed,
					$doc_type_open,
					$doc_type_close
				),
				&#039;headers&#039; =&gt; array(
					&#039;Content-Type&#039; =&gt; &#039;application/json&#039;,
				),
			)
		);
		if ( true !== travis_es_verify_response_code( $response ) ) {
			exit( 1 );
		}

		// Index the content.
		$posts = get_posts(
			array(
				&#039;posts_per_page&#039; =&gt; -1,
				&#039;post_type&#039;      =&gt; array_values( get_post_types() ),
				&#039;post_status&#039;    =&gt; array_values( get_post_stati() ),
				&#039;orderby&#039;        =&gt; &#039;ID&#039;,
				&#039;order&#039;          =&gt; &#039;ASC&#039;,
			)
		);

		$es_posts = array();
		foreach ( $posts as $post ) {
			$es_posts[] = new Travis_ES_Post( $post );
		}

		$body = array();
		foreach ( $es_posts as $post ) {
			$body[] = &#039;{ &quot;index&quot;: { &quot;_id&quot; : &#039; . $post-&gt;data[&#039;post_id&#039;] . &#039; } }&#039;;
			$body[] = addcslashes( $post-&gt;to_json(), &quot;\n&quot; );
		}

		$response = wp_remote_request(
			&quot;http://localhost:9200/es-wp-query-unit-tests/{$es_wp_query_travis_doc_type}/_bulk&quot;,
			array(
				&#039;method&#039;  =&gt; &#039;PUT&#039;,
				&#039;body&#039;    =&gt; wp_check_invalid_utf8( implode( &quot;\n&quot;, $body ), true ) . &quot;\n&quot;,
				&#039;headers&#039; =&gt; array(
					&#039;Content-Type&#039; =&gt; &#039;application/json&#039;,
				),
			)
		);
		travis_es_verify_response_code( $response );

		$itemized_response = json_decode( wp_remote_retrieve_body( $response ) );
		foreach ( (array) $itemized_response-&gt;items as $post ) {
			// Status should be 200 or 201, depending on if we&#039;re updating or creating respectively.
			if ( ! isset( $post-&gt;index-&gt;status ) || ! in_array( intval( $post-&gt;index-&gt;status ), array( 200, 201 ), true ) ) {
				$error_message = &quot;Error indexing post {$post-&gt;index-&gt;_id}; HTTP response code: {$post-&gt;index-&gt;status}&quot;;
				if ( ! empty( $post-&gt;index-&gt;error ) ) {
					if ( is_string( $post-&gt;index-&gt;error ) ) {
						$error_message .= &quot;\n{$post-&gt;index-&gt;error}&quot;;
					} elseif ( ! empty( $post-&gt;index-&gt;error-&gt;reason ) &amp;&amp; ! empty( $post-&gt;index-&gt;error-&gt;type ) ) {
						$error_message .= &quot;\n{$post-&gt;index-&gt;error-&gt;type}: {$post-&gt;index-&gt;error-&gt;reason}&quot;;
					}
				}
				$error_message .= &#039;Backtrace:&#039; . travis_es_debug_backtrace_summary();
				throw new ES_Index_Exception( $error_message );
			}
		}

		$response = wp_remote_post(
			&#039;http://localhost:9200/es-wp-query-unit-tests/_refresh&#039;,
			array(
				&#039;headers&#039; =&gt; array(
					&#039;Content-Type&#039; =&gt; &#039;application/json&#039;,
				),
			)
		);
		travis_es_verify_response_code( $response );
	}

	/**
	 * Verifies the Elasticsearch response code.
	 *
	 * @param WP_Error|array $response The response from wp_remote_request.
	 * @return bool
	 * @throws ES_Index_Exception If the indexing fails.
	 */
	function travis_es_verify_response_code( $response ) {
		if ( 200 !== intval( wp_remote_retrieve_response_code( $response ) ) ) {
			$message = [ &#039;Failed to index posts!&#039; ];
			if ( is_wp_error( $response ) ) {
				$message[] = sprintf( &#039;Message: %s&#039;, $response-&gt;get_error_message() );
			} else {
				$message[] = sprintf( &#039;Response code %s&#039;, wp_remote_retrieve_response_code( $response ) );
				$message[] = sprintf( &#039;Message: %s&#039;, wp_remote_retrieve_body( $response ) );
			}
			$message[] = sprintf( &#039;Backtrace:%s&#039;, travis_es_debug_backtrace_summary() );
			throw new ES_Index_Exception( implode( &quot;\n&quot;, $message ) );
		}

		return true;
	}

	/**
	 * Provides a backtrace summary for error reporting in Travis tests.
	 *
	 * @return string
	 */
	function travis_es_debug_backtrace_summary() {
		$backtrace = wp_debug_backtrace_summary( null, 0, false );
		$backtrace = array_filter(
			$backtrace,
			function( $call ) {
				return ! preg_match( &#039;/PHPUnit_(TextUI_(Command|TestRunner)|Framework_(TestSuite|TestCase|TestResult))|ReflectionMethod|travis_es_(verify_response_code|debug_backtrace_summary)/&#039;, $call );
			}
		);
		return &quot;\n\t&quot; . join( &quot;\n\t&quot;, $backtrace );
	}

	/**
	 * Taken from SearchPress.
	 */
	class Travis_ES_Post {

		/**
		 * This stores what will eventually become our JSON.
		 *
		 * @access public
		 * @var array
		 */
		public $data = array();

		/**
		 * A list of users.
		 *
		 * @access protected
		 * @var array
		 */
		protected static $users = array();

		/**
		 * Travis_ES_Post constructor.
		 *
		 * @param WP_Post $post The post object to use.
		 * @access public
		 */
		public function __construct( $post ) {
			if ( is_numeric( $post ) &amp;&amp; 0 !== intval( $post ) ) {
				$post = get_post( intval( $post ) );
			}
			if ( ! is_object( $post ) ) {
				return;
			}

			$this-&gt;fill( $post );
		}

		/**
		 * Populate this object with all of the post&#039;s properties.
		 *
		 * @param WP_Post $post The post to use when filling post properties.
		 * @access public
		 */
		public function fill( $post ) {
			$this-&gt;data = array(
				&#039;post_id&#039;        =&gt; $post-&gt;ID,
				&#039;post_author&#039;    =&gt; $this-&gt;get_user( $post-&gt;post_author ),
				&#039;post_title&#039;     =&gt; $post-&gt;post_title,
				&#039;post_excerpt&#039;   =&gt; $post-&gt;post_excerpt,
				&#039;post_content&#039;   =&gt; $post-&gt;post_content,
				&#039;post_status&#039;    =&gt; $post-&gt;post_status,
				&#039;post_name&#039;      =&gt; $post-&gt;post_name,
				&#039;post_parent&#039;    =&gt; $post-&gt;post_parent,
				&#039;post_type&#039;      =&gt; $post-&gt;post_type,
				&#039;post_mime_type&#039; =&gt; $post-&gt;post_mime_type,
				&#039;post_password&#039;  =&gt; $post-&gt;post_password,
				&#039;terms&#039;          =&gt; $this-&gt;get_terms( $post ),
				&#039;post_meta&#039;      =&gt; $this-&gt;get_meta( $post-&gt;ID ),
			);
			foreach ( array( &#039;post_date&#039;, &#039;post_date_gmt&#039;, &#039;post_modified&#039;, &#039;post_modified_gmt&#039; ) as $field ) {
				$value = $this-&gt;get_date( $post-&gt;$field );
				if ( ! empty( $value ) ) {
					$this-&gt;data[ $field ] = $value;
				}
			}
		}

		/**
		 * Get post meta for a given post ID.
		 * Some post meta is removed (you can filter it), and serialized data gets unserialized
		 *
		 * @param int $post_id The ID of the post for which to retrieve meta.
		 * @return array &#039;meta_key&#039; =&gt; array( value 1, value 2... )
		 */
		public function get_meta( $post_id ) {
			$meta = (array) get_post_meta( $post_id );

			// Remove a filtered set of meta that we don&#039;t want indexed.
			$ignored_meta = array(
				&#039;_edit_lock&#039;,
				&#039;_edit_last&#039;,
				&#039;_wp_old_slug&#039;,
				&#039;_wp_trash_meta_time&#039;,
				&#039;_wp_trash_meta_status&#039;,
				&#039;_previous_revision&#039;,
				&#039;_wpas_done_all&#039;,
				&#039;_encloseme&#039;,
			);
			foreach ( $ignored_meta as $key ) {
				unset( $meta[ $key ] );
			}

			foreach ( $meta as &amp;$values ) {
				$values = array_map( array( $this, &#039;cast_meta_types&#039; ), $values );
			}

			return $meta;
		}

		/**
		 * Split the meta values into different types for meta query casting.
		 *
		 * @param  string $value Meta value.
		 * @return array
		 */
		public function cast_meta_types( $value ) {
			$return = array(
				&#039;value&#039;    =&gt; $value,
				&#039;analyzed&#039; =&gt; $value,
				&#039;boolean&#039;  =&gt; (bool) $value,
			);

			if ( is_numeric( $value ) ) {
				$return[&#039;long&#039;]   = intval( $value );
				$return[&#039;double&#039;] = floatval( $value );
			}

			// Correct boolean values.
			if ( ( &#039;false&#039; === $value ) || ( &#039;FALSE&#039; === $value ) ) {
				$return[&#039;boolean&#039;] = false;
			} elseif ( ( &#039;true&#039; === $value ) || ( &#039;TRUE&#039; === $value ) ) {
				$return[&#039;boolean&#039;] = true;
			}

			// Add date/time if we have it.
			$time = strtotime( $value );
			if ( false !== $time ) {
				$return[&#039;date&#039;]     = date( &#039;Y-m-d&#039;, $time );
				$return[&#039;datetime&#039;] = date( &#039;Y-m-d H:i:s&#039;, $time );
				$return[&#039;time&#039;]     = date( &#039;H:i:s&#039;, $time );
			}

			return $return;
		}

		/**
		 * Get all terms across all taxonomies for a given post
		 *
		 * @param WP_Post $post The post to process.
		 * @access public
		 * @return array
		 */
		public function get_terms( $post ) {
			$object_terms = array();
			$taxonomies   = get_object_taxonomies( $post-&gt;post_type );
			foreach ( $taxonomies as $taxonomy ) {
				$these_terms = get_the_terms( $post-&gt;ID, $taxonomy );
				if ( $these_terms &amp;&amp; ! is_wp_error( $these_terms ) ) {
					$object_terms = array_merge( $object_terms, $these_terms );
				}
			}

			if ( empty( $object_terms ) ) {
				return array();
			}

			$terms = array();
			foreach ( (array) $object_terms as $term ) {
				$terms[ $term-&gt;taxonomy ][] = array(
					&#039;term_id&#039;          =&gt; $term-&gt;term_id,
					&#039;term_taxonomy_id&#039; =&gt; $term-&gt;term_taxonomy_id,
					&#039;slug&#039;             =&gt; $term-&gt;slug,
					&#039;name&#039;             =&gt; $term-&gt;name,
				);
			}

			return $terms;
		}


		/**
		 * Parse out the properties of a date.
		 *
		 * @param  string $date  A date, expected to be in mysql format.
		 * @return array|false The parsed date on success, false on failure.
		 */
		public function get_date( $date ) {
			$ts = strtotime( $date );
			if ( $ts &lt;= 0 ) {
				return false;
			}

			return array(
				&#039;date&#039;              =&gt; $date,
				&#039;year&#039;              =&gt; date( &#039;Y&#039;, $ts ),
				&#039;month&#039;             =&gt; date( &#039;m&#039;, $ts ),
				&#039;day&#039;               =&gt; date( &#039;d&#039;, $ts ),
				&#039;hour&#039;              =&gt; date( &#039;H&#039;, $ts ),
				&#039;minute&#039;            =&gt; date( &#039;i&#039;, $ts ),
				&#039;second&#039;            =&gt; date( &#039;s&#039;, $ts ),
				&#039;week&#039;              =&gt; date( &#039;W&#039;, $ts ),
				&#039;day_of_week&#039;       =&gt; date( &#039;N&#039;, $ts ),
				&#039;day_of_year&#039;       =&gt; date( &#039;z&#039;, $ts ),
				&#039;seconds_from_day&#039;  =&gt; mktime( date( &#039;H&#039;, $ts ), date( &#039;i&#039;, $ts ), date( &#039;s&#039;, $ts ), 1, 1, 1970 ),
				&#039;seconds_from_hour&#039; =&gt; mktime( 0, date( &#039;i&#039;, $ts ), date( &#039;s&#039;, $ts ), 1, 1, 1970 ),
			);
		}


		/**
		 * Get information about a post author
		 *
		 * @param int $user_id The user ID to look up.
		 * @access public
		 * @return array
		 */
		public function get_user( $user_id ) {
			if ( empty( self::$users[ $user_id ] ) ) {
				$user = get_userdata( $user_id );
				$data = array( &#039;user_id&#039; =&gt; absint( $user_id ) );
				if ( $user instanceof WP_User ) {
					$data[&#039;user_nicename&#039;] = strval( $user-&gt;user_nicename );
				} else {
					$data[&#039;user_nicename&#039;] = &#039;&#039;;
				}
				self::$users[ $user_id ] = $data;
			}

			return self::$users[ $user_id ];
		}


		/**
		 * Return this object as JSON
		 *
		 * @return string
		 */
		public function to_json() {
			return wp_json_encode( $this-&gt;data );
		}
	}
}
</code></pre>
            </article>
                <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
            </div>
        </div>
        <a href="files/search-es-wp-query-adapters-travis.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
</body>
</html>
