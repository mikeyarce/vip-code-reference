<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>VIP Go mu-plugins</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
            <script src="js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">VIP Go mu-plugins</a><span class="title-separator">/</span>mu-plugins</h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -four phpdocumentor-sidebar">
        
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/automattic-wp.html"><abbr title="\Automattic\WP">WP</abbr></a></li>
                                            <li><a href="namespaces/automattic-vip.html"><abbr title="\Automattic\VIP">VIP</abbr></a></li>
                                    </ul>
                            <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/tubalmartin.html"><abbr title="\tubalmartin">tubalmartin</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/tubalmartin-cssmin.html"><abbr title="\tubalmartin\CssMin">CssMin</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/VIP.html"><abbr title="\VIP">VIP</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/a8c.html"><abbr title="\a8c">a8c</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/a8c-Cron.html"><abbr title="\a8c\Cron">Cron</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/Http.html"><abbr title="\Http">Http</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/Http-Concat.html"><abbr title="\Http\Concat">Concat</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/ES.html"><abbr title="\ES">ES</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/ES-WP.html"><abbr title="\ES\WP">WP</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/wp.html"><abbr title="\wp">wp</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/wp-cli.html"><abbr title="\wp\cli">cli</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="hooks/hooks.html">Hooks</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">vip-utils.php</h2>

        








<h3 id="toc">
    Table of Contents
    <a href="#toc" class="headerlink"><i class="fas fa-link"></i></a>
</h3>

<dl class="phpdocumentor-table-of-contents">
                        <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function__wpcom_vip_call_on_hook_or_execute">_wpcom_vip_call_on_hook_or_execute()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Utility function to trigger a callback on a hook with priority or execute immediately if the hook has already been fired previously.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_themes_root">wpcom_vip_themes_root()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Returns the raw path to the VIP themes dir.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_themes_root_uri">wpcom_vip_themes_root_uri()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Returns the non-CDN URI to the VIP themes dir.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_noncdn_uri">wpcom_vip_noncdn_uri()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Returns the non-CDN&#039;d URI to the specified path.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_powered_wpcom_img_html">vip_powered_wpcom_img_html()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Returns a link the WordPress VIP site wrapped around an image (the WordPress VIP logo).</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_powered_wpcom">vip_powered_wpcom()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Returns the &quot;Powered by WordPress VIP&quot; widget&#039;s content.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_powered_wpcom_url">vip_powered_wpcom_url()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Returns the URL to the WordPress VIP site</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_contrib_add_upload_cap">vip_contrib_add_upload_cap()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Allows users of contributor role to be able to upload media.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function__vip_contrib_add_upload_cap">_vip_contrib_add_upload_cap()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Helper function for vip_contrib_add_upload_cap() to change the user roles</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_resized_attachment_url">wpcom_vip_get_resized_attachment_url()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Returns a URL for a given attachment with the appropriate resizing querystring.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_sharing_twitter_via">wpcom_vip_sharing_twitter_via()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Allows you to customize the /via and follow recommendation for the WP.com Sharing Twitter button.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_disable_post_flair">wpcom_vip_disable_post_flair()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Disables Jetpack Post Flair entirely on the frontend.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_disable_sharing">wpcom_vip_disable_sharing()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Disables Jetpack Sharing in Posts and Pages.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_disable_sharing_resources">wpcom_vip_disable_sharing_resources()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Disable CSS and JS output for Jetpack Sharing.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_enable_sharing">wpcom_vip_enable_sharing()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Enables Jetpack Sharing in Posts and Pages.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_enable_sharing_resources">wpcom_vip_enable_sharing_resources()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Enable CSS and JS output for WPCOM sharing.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_disable_likes">wpcom_vip_disable_likes()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Disables Jetpack Likes for Posts and Custom Post Types</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_enable_likes">wpcom_vip_enable_likes()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Disables Jetpack Likes for Posts and Custom Post Types</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_remove_livechat">wpcom_vip_remove_livechat()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Disables Olark live chat</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_widont">widont()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Eliminates widows in strings by replace the breaking space that appears before the last word with a non-breaking space.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wp_startswith">wp_startswith()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wp_endswith">wp_endswith()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wp_in">wp_in()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_redirects">vip_redirects()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Simple 301 redirects</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_substr_redirects">vip_substr_redirects()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Wildcard redirects based on the beginning of the request path.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_regex_redirects">vip_regex_redirects()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Advanced 301 redirects using regex to match and redirect URLs.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_file_get_contents">wpcom_vip_file_get_contents()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Fetch a remote URL and cache the result for a certain period of time.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_main_feed_redirect">vip_main_feed_redirect()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Redirect http://blog.wordpress.com/feed/ to $target URL</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_is_main_feed_requested">wpcom_vip_is_main_feed_requested()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Returns if any of the formats of the main feed are requested</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_is_feedservice_ua">wpcom_vip_is_feedservice_ua()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Returns if the current visitor has a feed service user agent</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_crossdomain_redirect">vip_crossdomain_redirect()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Responds to a blog.wordpress.com/crossdomain.xml request with the contents of a crossdomain.xml file located in the root of your theme.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function__vip_crossdomain_redirect">_vip_crossdomain_redirect()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Helper function for vip_crossdomain_redirect(); serves up /vip/your_theme/crossdomain.xml</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_get_random_posts">vip_get_random_posts()</a>
    <span>
                        &nbsp;: array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Get random posts; a simple, more efficient approach..

MySQL queries that use ORDER BY RAND() can be pretty challenging and slow on large datasets.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_safe_wp_remote_request">vip_safe_wp_remote_request()</a>
    <span>
                        &nbsp;: string|<abbr title="\WP_Error">WP_Error</abbr>|array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>This is a sophisticated extended version of wp_remote_request(). It is designed to more gracefully handle failure than wpcom_vip_file_get_contents() does.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_safe_wp_remote_get">vip_safe_wp_remote_get()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>This is a convenience method for vip_safe_wp_remote_request() and behaves the same</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_user_profile">wpcom_vip_get_user_profile()</a>
    <span>
                        &nbsp;: false|array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Returns profile information for a WordPress/Gravatar user</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_email_has_gravatar">wpcom_vip_email_has_gravatar()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Checks to see if a given e-mail address has a Gravatar or not.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_is_valid_domain">wpcom_vip_is_valid_domain()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Check if a URL is in a specified whitelist</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_bulk_user_management_whitelist">wpcom_vip_bulk_user_management_whitelist()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Helper function to enable bulk user management on a per-user basis</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_wp_oembed_get">wpcom_vip_wp_oembed_get()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>A version of wp_oembed_get() that provides caching.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function__wpcom_vip_load_plugin_sanitizer">_wpcom_vip_load_plugin_sanitizer()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Helper function for wpcom_vip_load_plugin(); sanitizes plugin folder name.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_load_plugin">wpcom_vip_load_plugin()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Loads a plugin from your plugins folder.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_can_use_shared_plugin">wpcom_vip_can_use_shared_plugin()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Determine if a plugin can be used or not</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_should_load_plugins">wpcom_vip_should_load_plugins()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Helper function to check if we can load plugins or not.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_add_loaded_plugin">wpcom_vip_add_loaded_plugin()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Store the name of a VIP plugin that will be loaded</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_get_loaded_plugins">wpcom_vip_get_loaded_plugins()</a>
    <span>
                        &nbsp;: array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Get the names of VIP plugins that have been loaded</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_plugin_is_loaded">wpcom_vip_plugin_is_loaded()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Check if plugin is loaded</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_load_helpers_for_network_active_plugins">wpcom_vip_load_helpers_for_network_active_plugins()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Load `vipgo-helper.php` if it exists for a network-activated plugin</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_load_helpers_for_sites_core_plugins">wpcom_vip_load_helpers_for_sites_core_plugins()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Load `vipgo-helper.php` if it exists for a plugin loaded outside of our custom UI and helpers</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function__wpcom_vip_include_plugin">_wpcom_vip_include_plugin()</a>
    <span>
                        &nbsp;: true    </span>
</dt>
<dd>Include a plugin and its helper, handling variable scope in the process</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_is_automattician">is_automattician()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Is the given user an Automattician?</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_is_proxied_automattician">is_proxied_automattician()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Is the current user an Automattician, authenticated via the Automattic proxy.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_is_proxied_request">is_proxied_request()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Is the current request made using the Automattic proxy.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_vip_is_jetpack_request">vip_is_jetpack_request()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Is the current request being made from Jetpack servers?</dd>

            <dt class="phpdocumentor-table-of-contents__entry -function -">
    <a href="namespaces/default.html#function_wpcom_vip_irc">wpcom_vip_irc()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Send a message to IRC</dd>

    </dl>



        

            <section class="phpdocumentor-functions">
        <h3 class="phpdocumentor-elements__header" id="functions">
            Functions
            <a href="files/vip-helpers-vip-utils.html#functions" class="headerlink"><i class="fas fa-link"></i></a>
        </h3>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function__wpcom_vip_call_on_hook_or_execute">
        _wpcom_vip_call_on_hook_or_execute()
        <a href="namespaces/default.html#function__wpcom_vip_call_on_hook_or_execute" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">12</span>
</aside>

        <p class="phpdocumentor-summary">Utility function to trigger a callback on a hook with priority or execute immediately if the hook has already been fired previously.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">_wpcom_vip_call_on_hook_or_execute</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\function">function</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$function</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$hook</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$priority</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">99</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$function</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\function">function</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Callback to trigger.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$hook</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Hook name to trigger on.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$priority</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">99</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">private</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_themes_root">
        wpcom_vip_themes_root()
        <a href="namespaces/default.html#function_wpcom_vip_themes_root" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">30</span>
</aside>

        <p class="phpdocumentor-summary">Returns the raw path to the VIP themes dir.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_themes_root</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"></section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_themes_root_uri">
        wpcom_vip_themes_root_uri()
        <a href="namespaces/default.html#function_wpcom_vip_themes_root_uri" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">43</span>
</aside>

        <p class="phpdocumentor-summary">Returns the non-CDN URI to the VIP themes dir.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_themes_root_uri</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>Sometimes enqueuing/inserting resources can trigger cross-domain errors when
using the CDN, so this function allows bypassing the CDN to eradicate those
unwanted errors.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_noncdn_uri">
        wpcom_vip_noncdn_uri()
        <a href="namespaces/default.html#function_wpcom_vip_noncdn_uri" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">57</span>
</aside>

        <p class="phpdocumentor-summary">Returns the non-CDN&#039;d URI to the specified path.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_noncdn_uri</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$path</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$path</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Must be a full path, e.g. dirname( <strong>FILE</strong> )</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_powered_wpcom_img_html">
        vip_powered_wpcom_img_html()
        <a href="namespaces/default.html#function_vip_powered_wpcom_img_html" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">71</span>
</aside>

        <p class="phpdocumentor-summary">Returns a link the WordPress VIP site wrapped around an image (the WordPress VIP logo).</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_powered_wpcom_img_html</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$image</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$image</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Which variant of the WordPress VIP logo to use; between 1-6.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_powered_wpcom">
        vip_powered_wpcom()
        <a href="namespaces/default.html#function_vip_powered_wpcom" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">97</span>
</aside>

        <p class="phpdocumentor-summary">Returns the &quot;Powered by WordPress VIP&quot; widget&#039;s content.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_powered_wpcom</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$display</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;text&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$before_text</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;Powered by &#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$display</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;text&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Either: 1-6 or &quot;text&quot;*. If an integer, wrap an image in the WordPress VIP link. Otherwise, just return the link.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$before_text</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;Powered by &#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Text to go in front of the VIP link. Defaults to 'Powered by '.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/how-tos/add-powered-by-wordpress-vip-to-your-site/"> <p>Powered By WordPress VIP</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_powered_wpcom_url">
        vip_powered_wpcom_url()
        <a href="namespaces/default.html#function_vip_powered_wpcom_url" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">122</span>
</aside>

        <p class="phpdocumentor-summary">Returns the URL to the WordPress VIP site</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_powered_wpcom_url</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"></section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_contrib_add_upload_cap">
        vip_contrib_add_upload_cap()
        <a href="namespaces/default.html#function_vip_contrib_add_upload_cap" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">141</span>
</aside>

        <p class="phpdocumentor-summary">Allows users of contributor role to be able to upload media.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_contrib_add_upload_cap</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Contrib users still can't publish.</p>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">author</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>mdawaffe</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function__vip_contrib_add_upload_cap">
        _vip_contrib_add_upload_cap()
        <a href="namespaces/default.html#function__vip_contrib_add_upload_cap" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">151</span>
</aside>

        <p class="phpdocumentor-summary">Helper function for vip_contrib_add_upload_cap() to change the user roles</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">_vip_contrib_add_upload_cap</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><a href="namespaces/default.html#function_vip_contrib_add_upload_cap"><abbr title="\vip_contrib_add_upload_cap()">vip_contrib_add_upload_cap()</abbr></a></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_resized_attachment_url">
        wpcom_vip_get_resized_attachment_url()
        <a href="namespaces/default.html#function_wpcom_vip_get_resized_attachment_url" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">174</span>
</aside>

        <p class="phpdocumentor-summary">Returns a URL for a given attachment with the appropriate resizing querystring.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_resized_attachment_url</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$attachment_id</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$width</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$height</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$crop</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>Typically, you should be using image sizes for handling this.</p>
<p>However, this function can come in handy if you want a specific artibitrary or varying image size.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$attachment_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>ID of the attachment</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$width</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Width of our resized image</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$height</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Height of our resized image</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$crop</span>
                : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>(optional) whether or not to crop the image</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/vip-go-files-system/image-transformation/"> https://docs.wpvip.com/technical-references/vip-go-files-system/image-transformation/ </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_sharing_twitter_via">
        wpcom_vip_sharing_twitter_via()
        <a href="namespaces/default.html#function_wpcom_vip_sharing_twitter_via" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">196</span>
</aside>

        <p class="phpdocumentor-summary">Allows you to customize the /via and follow recommendation for the WP.com Sharing Twitter button.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_sharing_twitter_via</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$via</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$via</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. What the /via should be set to. Empty value disables the feature (the default).</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_disable_post_flair">
        wpcom_vip_disable_post_flair()
        <a href="namespaces/default.html#function_wpcom_vip_disable_post_flair" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">227</span>
</aside>

        <p class="phpdocumentor-summary">Disables Jetpack Post Flair entirely on the frontend.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_disable_post_flair</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>This removes the filters and doesn't allow the stylesheet to be enqueued.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_disable_sharing">
        wpcom_vip_disable_sharing()
        <a href="namespaces/default.html#function_wpcom_vip_disable_sharing" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">239</span>
</aside>

        <p class="phpdocumentor-summary">Disables Jetpack Sharing in Posts and Pages.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_disable_sharing</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Sharing can be disabled in the dashboard, by removing all buttons from Enabled Services.</p>
<p>This function is primary for automating sharing when you have numerous sites to administer.
It also assists having consistent CSS containers between development and production.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_disable_sharing_resources">
        wpcom_vip_disable_sharing_resources()
        <a href="namespaces/default.html#function_wpcom_vip_disable_sharing_resources" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">255</span>
</aside>

        <p class="phpdocumentor-summary">Disable CSS and JS output for Jetpack Sharing.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_disable_sharing_resources</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Note: this disables things like smart buttons and share counts displayed alongside the buttons. Those will need to be handled manually if desired.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_enable_sharing">
        wpcom_vip_enable_sharing()
        <a href="namespaces/default.html#function_wpcom_vip_enable_sharing" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">267</span>
</aside>

        <p class="phpdocumentor-summary">Enables Jetpack Sharing in Posts and Pages.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_enable_sharing</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>This feature is on by default, so the function is only useful if you've also used wpcom_vip_disable_sharing().</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_enable_sharing_resources">
        wpcom_vip_enable_sharing_resources()
        <a href="namespaces/default.html#function_wpcom_vip_enable_sharing_resources" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">276</span>
</aside>

        <p class="phpdocumentor-summary">Enable CSS and JS output for WPCOM sharing.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_enable_sharing_resources</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Note: if resources were disabled previously and this is called after wp_head, it may not work as expected.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_disable_likes">
        wpcom_vip_disable_likes()
        <a href="namespaces/default.html#function_wpcom_vip_disable_likes" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">288</span>
</aside>

        <p class="phpdocumentor-summary">Disables Jetpack Likes for Posts and Custom Post Types</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_disable_likes</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Sharing can also be disabled from the Dashboard (Settings &gt; Sharing).</p>
<p>This function is primarily for programmatic disabling of the feature, for example when working with custom post types.</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_enable_likes">
        wpcom_vip_enable_likes()
        <a href="namespaces/default.html#function_wpcom_vip_enable_likes" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">297</span>
</aside>

        <p class="phpdocumentor-summary">Disables Jetpack Likes for Posts and Custom Post Types</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_enable_likes</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>This feature is on by default, so the function is only useful if you've also used wpcom_vip_disable_sharing().</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_remove_livechat">
        wpcom_vip_remove_livechat()
        <a href="namespaces/default.html#function_wpcom_vip_remove_livechat" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">306</span>
</aside>

        <p class="phpdocumentor-summary">Disables Olark live chat</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_remove_livechat</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><abbr title="\show_live_chat()">show_live_chat()</abbr></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_widont">
        widont()
        <a href="namespaces/default.html#function_widont" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">320</span>
</aside>

        <p class="phpdocumentor-summary">Eliminates widows in strings by replace the breaking space that appears before the last word with a non-breaking space.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">widont</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$str</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>This function is defined on WordPress.com and can be a common source of frustration for VIP devs.
Now they can be frustrated in their local environments as well :)</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$str</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. String to operate on.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="http://www.shauninman.com/post/heap/2006/08/22/widont_wordpress_plugin"> <p>Typesetting widows</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wp_startswith">
        wp_startswith()
        <a href="namespaces/default.html#function_wp_startswith" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">346</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wp_startswith</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$haystack</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$needle</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$haystack</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$needle</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wp_endswith">
        wp_endswith()
        <a href="namespaces/default.html#function_wp_endswith" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">352</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wp_endswith</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$haystack</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$needle</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$haystack</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$needle</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wp_in">
        wp_in()
        <a href="namespaces/default.html#function_wp_in" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">358</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wp_in</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$needle</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$haystack</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$needle</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$haystack</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_redirects">
        vip_redirects()
        <a href="namespaces/default.html#function_vip_redirects" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">369</span>
</aside>

        <p class="phpdocumentor-summary">Simple 301 redirects</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_redirects</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$vip_redirects_array</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$case_insensitive</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$vip_redirects_array</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Elements should be in the form of '/old' =&gt; 'http://wordpress.com/new/'</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$case_insensitive</span>
                : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Should the redirects be case sensitive? Defaults to false.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_substr_redirects">
        vip_substr_redirects()
        <a href="namespaces/default.html#function_vip_substr_redirects" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">412</span>
</aside>

        <p class="phpdocumentor-summary">Wildcard redirects based on the beginning of the request path.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_substr_redirects</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$vip_redirects_array</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$append_old_uri</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>This is basically an alternative to vip_regex_redirects() for when you only need to redirect /foo/bar/* to somewhere else.
Using regex to do this simple check would add lots of overhead.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$vip_redirects_array</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Elements should be in the form of '/some-path/' =&gt; 'http://wordpress.com/new/'</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$append_old_uri</span>
                : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. If true, the full path past the match will be added to the new URL. Defaults to false.</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_regex_redirects">
        vip_regex_redirects()
        <a href="namespaces/default.html#function_vip_regex_redirects" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">454</span>
</aside>

        <p class="phpdocumentor-summary">Advanced 301 redirects using regex to match and redirect URLs.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_regex_redirects</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$vip_redirects_array</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$with_querystring</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Warning: Since regex is expensive and this will be run on every uncached pageload, you'll want to keep this small, lean, and mean.</p>
<p>Some examples:</p>
<p>Redirecting from /2011/12/dont-miss-it-make-live-holiday-giveaway.html (extra .html at the end)
'|/([0-9]{4})/([0-9]{2})/([0-9]{2})/([^/]+).html|' =&gt; '|/$1/$2/$3/$4/|'</p>
<p>Redirecting from /archive/2011/12/dont-miss-it-make-live-holiday-giveaway
'|/archive/([0-9]{4})/([0-9]{2})/([^/]+)/?|' =&gt; '|/$3/|' // since we don't have the day, we should just send to /%postname% then WordPress can redirect from there</p>
<p>Redirecting from /tax-tips/how-to-get-a-tax-break-for-summer-child-care/04152011-6163 (/%category%/%postname%/%month%%day%%year%-%post_id%)
'|/([^/]+)/([^/]+)/([0-9]{1,2})([0-9]{1,2})([0-9]{4})-([0-9]{1,})/?|' =&gt; '|/$5/$3/$4/$2/|'</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$vip_redirects_array</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Array of key/value pairs to redirect from/to.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$with_querystring</span>
                : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Set this to true if your redirect string is in the format of an absolute URL. Defaults to false (just the path).</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_file_get_contents">
        wpcom_vip_file_get_contents()
        <a href="namespaces/default.html#function_wpcom_vip_file_get_contents" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">498</span>
</aside>

        <p class="phpdocumentor-summary">Fetch a remote URL and cache the result for a certain period of time.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_file_get_contents</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$timeout</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">3</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$cache_time</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">900</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$extra_args</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>This function originally used file_get_contents(), hence the function name.
While it no longer does, it still operates the same as the basic PHP function.</p>
<p>We strongly recommend not using a $timeout value of more than 3 seconds as this
function makes blocking requests (stops page generation and waits for the response).</p>
<p>The $extra_args are:</p>
<ul>
<li>obey_cache_control_header: uses the &quot;cache-control&quot; &quot;max-age&quot; value if greater than $cache_time.</li>
<li>http_api_args: see https://developer.wordpress.org/reference/functions/wp_remote_get/</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>URL to fetch</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$timeout</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">3</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. The timeout limit in seconds; valid values are 1-10. Defaults to 3.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$cache_time</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">900</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. The minimum cache time in seconds. Valid values are &gt;= 60. Defaults to 900.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$extra_args</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Advanced arguments: &quot;obey_cache_control_header&quot; and &quot;http_api_args&quot;.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/code-quality-and-best-practices/retrieving-remote-data/"> <p>Fetching Remote Data</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_main_feed_redirect">
        vip_main_feed_redirect()
        <a href="namespaces/default.html#function_vip_main_feed_redirect" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">652</span>
</aside>

        <p class="phpdocumentor-summary">Redirect http://blog.wordpress.com/feed/ to $target URL</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_main_feed_redirect</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$target</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Don't redirect if a feed service user agent, because that could result in a loop.</p>
<p>This can be executed before WP init because it checks the URI directly to see if the main feed is being requested.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$target</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>URL to direct feed services to</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">author</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>lloydbudd</p>
</section>

                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://wpvip.com/documentation/redirect-the-feed-to-feedburner/"> <p>Redirect the Feed To Feedburner</p>
 </a>
                    
                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_is_main_feed_requested">
        wpcom_vip_is_main_feed_requested()
        <a href="namespaces/default.html#function_wpcom_vip_is_main_feed_requested" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">665</span>
</aside>

        <p class="phpdocumentor-summary">Returns if any of the formats of the main feed are requested</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_is_main_feed_requested</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">author</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>lloydbudd</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_is_feedservice_ua">
        wpcom_vip_is_feedservice_ua()
        <a href="namespaces/default.html#function_wpcom_vip_is_feedservice_ua" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">677</span>
</aside>

        <p class="phpdocumentor-summary">Returns if the current visitor has a feed service user agent</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_is_feedservice_ua</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">author</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>lloydbudd</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_crossdomain_redirect">
        vip_crossdomain_redirect()
        <a href="namespaces/default.html#function_vip_crossdomain_redirect" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">699</span>
</aside>

        <p class="phpdocumentor-summary">Responds to a blog.wordpress.com/crossdomain.xml request with the contents of a crossdomain.xml file located in the root of your theme.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_crossdomain_redirect</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">author</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                
                                                 <section class="phpdocumentor-description"><p>lloydbudd</p>
</section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function__vip_crossdomain_redirect">
        _vip_crossdomain_redirect()
        <a href="namespaces/default.html#function__vip_crossdomain_redirect" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">708</span>
</aside>

        <p class="phpdocumentor-summary">Helper function for vip_crossdomain_redirect(); serves up /vip/your_theme/crossdomain.xml</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">_vip_crossdomain_redirect</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><a href="namespaces/default.html#function_vip_crossdomain_redirect"><abbr title="\vip_crossdomain_redirect()">vip_crossdomain_redirect()</abbr></a></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_get_random_posts">
        vip_get_random_posts()
        <a href="namespaces/default.html#function_vip_get_random_posts" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">729</span>
</aside>

        <p class="phpdocumentor-summary">Get random posts; a simple, more efficient approach..

MySQL queries that use ORDER BY RAND() can be pretty challenging and slow on large datasets.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_get_random_posts</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$number</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">1</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$post_type</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;post&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$return_ids</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$category_id</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"><p>This function is an alternative method for getting random posts, though it's not as good but at least it won't destroy your site :).</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$number</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">1</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Amount of random posts to get. Default 1.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$post_type</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;post&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Specify the post_type to use when randomizing posts. Default 'post'.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$return_ids</span>
                : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. To just get the IDs, set this to true, otherwise post objects are returned (the default).</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$category_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Limit to a specific category</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_safe_wp_remote_request">
        vip_safe_wp_remote_request()
        <a href="namespaces/default.html#function_vip_safe_wp_remote_request" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">772</span>
</aside>

        <p class="phpdocumentor-summary">This is a sophisticated extended version of wp_remote_request(). It is designed to more gracefully handle failure than wpcom_vip_file_get_contents() does.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_safe_wp_remote_request</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$fallback_value</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$threshold</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">3</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$timeout</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">1</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$retry</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">20</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$args</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string|<abbr title="\WP_Error">WP_Error</abbr>|array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"><p>Note that like wp_remote_request(), this function does not cache.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>URL to request</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$fallback_value</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Set a fallback value to be returned if the external request fails.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$threshold</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">3</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. The number of fails required before subsequent requests automatically return the fallback value. Defaults to 3, with a maximum of 10.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$timeout</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">1</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Number of seconds before the request times out. Valid values 1-5; defaults to 1.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$retry</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">20</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Number of seconds before resetting the fail counter and the number of seconds to delay making new requests after the fail threshold is reached. Defaults to 20, with a minimum of 10.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$args</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/code-quality-and-best-practices/retrieving-remote-data/"> <p>Fetching Remote Data</p>
 </a>
                    
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><abbr title="\wp_remote_request()">wp_remote_request()</abbr></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_safe_wp_remote_get">
        vip_safe_wp_remote_get()
        <a href="namespaces/default.html#function_vip_safe_wp_remote_get" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">886</span>
</aside>

        <p class="phpdocumentor-summary">This is a convenience method for vip_safe_wp_remote_request() and behaves the same</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_safe_wp_remote_get</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$fallback_value</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$threshold</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">3</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$timeout</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">1</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$retry</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">20</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$args</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Note that like wp_remote_get(), this function does not cache.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$fallback_value</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$threshold</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">3</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$timeout</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">1</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$retry</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">20</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$args</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="https://docs.wpvip.com/technical-references/code-quality-and-best-practices/retrieving-remote-data/"> <p>Fetching Remote Data</p>
 </a>
                    
                                    </dd>
                                                <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><a href="namespaces/default.html#function_vip_safe_wp_remote_request"><abbr title="\vip_safe_wp_remote_request()">vip_safe_wp_remote_request()</abbr></a></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><abbr title="\wp_remote_get()">wp_remote_get()</abbr></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_user_profile">
        wpcom_vip_get_user_profile()
        <a href="namespaces/default.html#function_wpcom_vip_get_user_profile" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">900</span>
</aside>

        <p class="phpdocumentor-summary">Returns profile information for a WordPress/Gravatar user</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_user_profile</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string|int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$email_or_id</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">false|array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$email_or_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">string|int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Email, ID, or username for user to lookup</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_email_has_gravatar">
        wpcom_vip_email_has_gravatar()
        <a href="namespaces/default.html#function_wpcom_vip_email_has_gravatar" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">945</span>
</aside>

        <p class="phpdocumentor-summary">Checks to see if a given e-mail address has a Gravatar or not.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_email_has_gravatar</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$email</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>You can use this function to only call get_avatar() when the user has a Gravatar and display nothing (rather than a placeholder image) when they don't.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$email</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Email to check for a gravatar</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_is_valid_domain">
        wpcom_vip_is_valid_domain()
        <a href="namespaces/default.html#function_wpcom_vip_is_valid_domain" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">971</span>
</aside>

        <p class="phpdocumentor-summary">Check if a URL is in a specified whitelist</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_is_valid_domain</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$whitelisted_domains</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>Example whitelist: array( 'mydomain.com', 'mydomain.net' )</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>URL to check for</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$whitelisted_domains</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Array of whitelisted domains</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_bulk_user_management_whitelist">
        wpcom_vip_bulk_user_management_whitelist()
        <a href="namespaces/default.html#function_wpcom_vip_bulk_user_management_whitelist" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1000</span>
</aside>

        <p class="phpdocumentor-summary">Helper function to enable bulk user management on a per-user basis</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_bulk_user_management_whitelist</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$users</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$users</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Array of user logins</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_wp_oembed_get">
        wpcom_vip_wp_oembed_get()
        <a href="namespaces/default.html#function_wpcom_vip_wp_oembed_get" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1018</span>
</aside>

        <p class="phpdocumentor-summary">A version of wp_oembed_get() that provides caching.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_wp_oembed_get</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$url</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$args</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$ttl</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>Note that if you're using this within the contents of a post, it's probably better to use the existing
WordPress functionality: http://codex.wordpress.org/Embeds. This helper function is more meant for other
places, such as sidebars.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$url</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The URL that should be embedded</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$args</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Addtional arguments and parameters the embed</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$ttl</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>How long to cache for in seconds; minimum 18000 (5 Hours)</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function__wpcom_vip_load_plugin_sanitizer">
        _wpcom_vip_load_plugin_sanitizer()
        <a href="namespaces/default.html#function__wpcom_vip_load_plugin_sanitizer" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1048</span>
</aside>

        <p class="phpdocumentor-summary">Helper function for wpcom_vip_load_plugin(); sanitizes plugin folder name.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">_wpcom_vip_load_plugin_sanitizer</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$folder</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>You shouldn't use this function.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$folder</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Folder name</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_load_plugin">
        wpcom_vip_load_plugin()
        <a href="namespaces/default.html#function_wpcom_vip_load_plugin" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1067</span>
</aside>

        <p class="phpdocumentor-summary">Loads a plugin from your plugins folder.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_load_plugin</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$plugin</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$folder</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$load_release_candidate_not_used</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">null</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>Note - This function does not trigger plugin activation / deactivation hooks.
As such, it may not be compatible with all plugins</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$plugin</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional. Plugin folder name of the plugin, or the folder and
plugin file name (such as wp-api/plugin.php), relative to either the VIP shared-plugins folder, or WP_PLUGIN_DIR</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$folder</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Subdirectory of WP_PLUGIN_DIR to load plugin from</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$load_release_candidate_not_used</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_can_use_shared_plugin">
        wpcom_vip_can_use_shared_plugin()
        <a href="namespaces/default.html#function_wpcom_vip_can_use_shared_plugin" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1225</span>
</aside>

        <p class="phpdocumentor-summary">Determine if a plugin can be used or not</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_can_use_shared_plugin</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$plugin</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$plugin</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>plugin name</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_should_load_plugins">
        wpcom_vip_should_load_plugins()
        <a href="namespaces/default.html#function_wpcom_vip_should_load_plugins" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1247</span>
</aside>

        <p class="phpdocumentor-summary">Helper function to check if we can load plugins or not.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_should_load_plugins</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_add_loaded_plugin">
        wpcom_vip_add_loaded_plugin()
        <a href="namespaces/default.html#function_wpcom_vip_add_loaded_plugin" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1273</span>
</aside>

        <p class="phpdocumentor-summary">Store the name of a VIP plugin that will be loaded</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_add_loaded_plugin</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$plugin</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$plugin</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Plugin name and folder</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><a href="namespaces/default.html#function_wpcom_vip_load_plugin"><abbr title="\wpcom_vip_load_plugin()">wpcom_vip_load_plugin()</abbr></a></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_get_loaded_plugins">
        wpcom_vip_get_loaded_plugins()
        <a href="namespaces/default.html#function_wpcom_vip_get_loaded_plugins" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1288</span>
</aside>

        <p class="phpdocumentor-summary">Get the names of VIP plugins that have been loaded</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_get_loaded_plugins</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"></section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_plugin_is_loaded">
        wpcom_vip_plugin_is_loaded()
        <a href="namespaces/default.html#function_wpcom_vip_plugin_is_loaded" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1304</span>
</aside>

        <p class="phpdocumentor-summary">Check if plugin is loaded</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_plugin_is_loaded</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$plugin</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$plugin</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Plugin name and folder</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_load_helpers_for_network_active_plugins">
        wpcom_vip_load_helpers_for_network_active_plugins()
        <a href="namespaces/default.html#function_wpcom_vip_load_helpers_for_network_active_plugins" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1313</span>
</aside>

        <p class="phpdocumentor-summary">Load `vipgo-helper.php` if it exists for a network-activated plugin</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_load_helpers_for_network_active_plugins</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Technically tries to include the main plugin file again, but we don't care, because it uses <code class="prettyprint">include_once()</code> and is called after Core loads the plugin</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_load_helpers_for_sites_core_plugins">
        wpcom_vip_load_helpers_for_sites_core_plugins()
        <a href="namespaces/default.html#function_wpcom_vip_load_helpers_for_sites_core_plugins" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1334</span>
</aside>

        <p class="phpdocumentor-summary">Load `vipgo-helper.php` if it exists for a plugin loaded outside of our custom UI and helpers</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_load_helpers_for_sites_core_plugins</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>Technically tries to include the main plugin file again, but we don't care, because it uses <code class="prettyprint">include_once()</code> and is called after Core loads the plugin</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function__wpcom_vip_include_plugin">
        _wpcom_vip_include_plugin()
        <a href="namespaces/default.html#function__wpcom_vip_include_plugin" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1351</span>
</aside>

        <p class="phpdocumentor-summary">Include a plugin and its helper, handling variable scope in the process</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">_wpcom_vip_include_plugin</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$file</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">true</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$file</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Plugin file to load</p>
</section>

            </dd>
            </dl>

    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_is_automattician">
        is_automattician()
        <a href="namespaces/default.html#function_is_automattician" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1406</span>
</aside>

        <p class="phpdocumentor-summary">Is the given user an Automattician?</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">is_automattician</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$user_id</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">false</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>This does a relatively weak check that the user has an Automattic email address, and that
they have verified that email address. It's possible to fake that data (it's just user meta
and user_email), so don't use this for protecting sensitive info or performing
sensitive tasks.</p>
<p>This does NOT guarantee the current user is proxied. Use is_proxied_automattician()
for that.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$user_id</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>A WP User id</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><abbr title="\is_proxied_automattician">is_proxied_automattician</abbr></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_is_proxied_automattician">
        is_proxied_automattician()
        <a href="namespaces/default.html#function_is_proxied_automattician" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1440</span>
</aside>

        <p class="phpdocumentor-summary">Is the current user an Automattician, authenticated via the Automattic proxy.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">is_proxied_automattician</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>Determine if the current request is made via the Automattic proxy,
which is only available to Automatticians, AND if the current user
is an Automattician.</p>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><abbr title="\is_automattician">is_automattician</abbr></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_is_proxied_request">
        is_proxied_request()
        <a href="namespaces/default.html#function_is_proxied_request" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1449</span>
</aside>

        <p class="phpdocumentor-summary">Is the current request made using the Automattic proxy.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">is_proxied_request</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_vip_is_jetpack_request">
        vip_is_jetpack_request()
        <a href="namespaces/default.html#function_vip_is_jetpack_request" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1461</span>
</aside>

        <p class="phpdocumentor-summary">Is the current request being made from Jetpack servers?</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">vip_is_jetpack_request</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>NOTE - This checks the REMOTE_ADDR against known JP IPs. The IP can still be spoofed,
(but usually an attacker cannot receive the response), so it is important to treat it accordingly</p>
</section>

    
    

    
</article>
                    <article class="phpdocumentor-element -function - ">
    <h4 class="phpdocumentor-element__name" id="function_wpcom_vip_irc">
        wpcom_vip_irc()
        <a href="namespaces/default.html#function_wpcom_vip_irc" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="vip-helpers/vip-utils.php"><a href="files/vip-helpers-vip-utils.html"><abbr title="vip-helpers/vip-utils.php">vip-utils.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">1522</span>
</aside>

        <p class="phpdocumentor-summary">Send a message to IRC</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">wpcom_vip_irc</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$channel_or_user</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$message</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$level</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$kind</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$interval</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>$level can be an int of one of the following
NONE = 0
WARNING = 1
ALERT = 2
CRITICAL = 3
RECOVERY = 4
INFORMATION = 5
SCALE = 6</p>
<p>Example Usage</p>
<p>wpcom_vip_irc( '@testuser', 'test message' );                // send testuser a pm on IRC from &quot;a8c&quot;
wpcom_vip_irc( '@testuser', 'test message', 3 ); // send testuser a pm on IRC with level 'critical'
wpcom_vip_irc( 'testing', 'test message' );                  // have &quot;a8c&quot; join #testing and say something
wpcom_vip_irc( 'testing', 'test message', 4 );       // have &quot;a8c-test&quot; join #testing and say something with level 'recovery'</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$channel_or_user</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                
            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$message</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>(string) Message</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$level</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>(int) Level The severity level of the message</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$kind</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a></span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>string Cache slug</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$interval</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href=""><abbr title=""></abbr></a></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>integer Interval in seconds between two messages sent from one DC</p>
</section>

            </dd>
            </dl>

    

    
</article>
            </section>

                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php

/**
 * Utility function to trigger a callback on a hook with priority or execute immediately if the hook has already been fired previously.
 *
 * @param function $function Callback to trigger.
 * @param string $hook Hook name to trigger on.
 * @param priority int Priority to trigger on.
 *
 * @private
 */
function _wpcom_vip_call_on_hook_or_execute( $function, $hook, $priority = 99 ) {
	if ( ! is_callable( $function ) ) {
		_doing_it_wrong( __FUNCTION__, &#039;Specified $function is not a valid callback!&#039;, &#039;3.8-wpcom&#039; );
		return;
	}

	if ( did_action( $hook ) ) {
		call_user_func( $function );
	} else {
		add_action( $hook, $function, $priority );
	}
}

/**
 * Returns the raw path to the VIP themes dir.
 *
 * @return string
 */
function wpcom_vip_themes_root() {
	return WP_CONTENT_DIR . &#039;/themes&#039;;
}

/**
 * Returns the non-CDN URI to the VIP themes dir.
 *
 * Sometimes enqueuing/inserting resources can trigger cross-domain errors when
 * using the CDN, so this function allows bypassing the CDN to eradicate those
 * unwanted errors.
 *
 * @return string The URI
 */
function wpcom_vip_themes_root_uri() {
	if ( ! is_admin() ) {
		return home_url( &#039;/wp-content/themes&#039; );
	} else {
		return content_url( &#039;/themes&#039; );
	}
}

/**
 * Returns the non-CDN&#039;d URI to the specified path.
 *
 * @param string $path Must be a full path, e.g. dirname( __FILE__ )
 * @return string
 */
function wpcom_vip_noncdn_uri( $path ) {
	// Be gentle on Windows, borrowed from core, see plugin_basename
	$path = str_replace( &#039;\\&#039;, &#039;/&#039;, $path ); // sanitize for Win32 installs
	$path = preg_replace( &#039;|/+|&#039;, &#039;/&#039;, $path ); // remove any duplicate slash

	return sprintf( &#039;%s%s&#039;, wpcom_vip_themes_root_uri(), str_replace( wpcom_vip_themes_root(), &#039;&#039;, $path ) );
}

/**
 * Returns a link the WordPress VIP site wrapped around an image (the WordPress VIP logo).
 *
 * @param int $image Which variant of the WordPress VIP logo to use; between 1-6.
 * @return string HTML
 */
function vip_powered_wpcom_img_html( $image ) {
	$vip_powered_wpcom_images = array(
		//image file, width, height
		1 =&gt; array( &#039;vip-powered-light-small.png&#039;, 187, 26 ),
		2 =&gt; array( &#039;vip-powered-light-normal.png&#039;, 209, 56 ),
		3 =&gt; array( &#039;vip-powered-light-long.png&#039;, 305, 56 ),
		4 =&gt; array( &#039;vip-powered-dark-small.png&#039;, 187, 26 ),
		5 =&gt; array( &#039;vip-powered-dark-normal.png&#039;, 209, 56 ),
		6 =&gt; array( &#039;vip-powered-dark-long.png&#039;, 305, 56 ),
	);

	if ( array_key_exists( $image, $vip_powered_wpcom_images ) ) {
		return &#039;&lt;a href=&quot;&#039; . esc_url( vip_powered_wpcom_url() ) . &#039;&quot; rel=&quot;generator nofollow&quot; class=&quot;powered-by-wpcom&quot;&gt;&lt;img src=&quot;&#039; . esc_url( plugins_url( &#039;images/&#039; . $vip_powered_wpcom_images[ $image ][0], __FILE__ ) ) . &#039;&quot; width=&quot;&#039; . esc_attr( $vip_powered_wpcom_images[ $image ][1] ) . &#039;&quot; height=&quot;&#039; . esc_attr( $vip_powered_wpcom_images[ $image ][2] ) . &#039;&quot; alt=&quot;&#039; . esc_attr__( &#039;Powered by WordPress VIP&#039;, &#039;vip-helpers&#039; ) . &#039;&quot; /&gt;&lt;/a&gt;&#039;;
	} else {
		return &#039;&#039;;
	}
}

/**
 * Returns the &quot;Powered by WordPress VIP&quot; widget&#039;s content.
 *
 * @link https://docs.wpvip.com/how-tos/add-powered-by-wordpress-vip-to-your-site/ Powered By WordPress VIP
 * @param string $display Optional. Either: 1-6 or &quot;text&quot;*. If an integer, wrap an image in the WordPress VIP link. Otherwise, just return the link.
 * @param string $before_text Optional. Text to go in front of the VIP link. Defaults to &#039;Powered by &#039;.
 * @return string HTML
 */
function vip_powered_wpcom( $display = &#039;text&#039;, $before_text = &#039;Powered by &#039; ) {
	switch ( $display ) {
		case &#039;text&#039;:
			$output = $before_text . &#039;&lt;a href=&quot;&#039; . esc_url( vip_powered_wpcom_url() ) . &#039;&quot; rel=&quot;generator nofollow&quot; class=&quot;powered-by-wpcom&quot;&gt;WordPress VIP&lt;/a&gt;&#039;;
			break;
		case 1:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
			$output = vip_powered_wpcom_img_html( $display );
			break;
		default:
			$output = &#039;&#039;;
	}

	return $output;
}

/**
 * Returns the URL to the WordPress VIP site
 *
 * @return string
 */
function vip_powered_wpcom_url() {
	$utm_term = $_SERVER[&#039;HTTP_HOST&#039;] ?? &#039;&#039;;
	$args = array(
		&#039;utm_source&#039;   =&gt; &#039;vip_powered_wpcom&#039;,
		&#039;utm_medium&#039;   =&gt; &#039;web&#039;,
		&#039;utm_campaign&#039; =&gt; &#039;VIP Footer Credit&#039;,
		&#039;utm_term&#039;     =&gt; sanitize_text_field( $utm_term ),
	);

	return add_query_arg( $args, &#039;https://wpvip.com/&#039; );
}

/**
 * Allows users of contributor role to be able to upload media.
 *
 * Contrib users still can&#039;t publish.
 *
 * @author mdawaffe
 */
function vip_contrib_add_upload_cap() {
	add_action( &#039;init&#039;, &#039;_vip_contrib_add_upload_cap&#039; );
	add_action( &#039;xmlrpc_call&#039;, &#039;_vip_contrib_add_upload_cap&#039; ); // User is logged in after &#039;init&#039; for XMLRPC
}

/**
 * Helper function for vip_contrib_add_upload_cap() to change the user roles
 *
 * @see vip_contrib_add_upload_cap()
 */
function _vip_contrib_add_upload_cap() {
	if ( ! is_admin() &amp;&amp; ! defined( &#039;XMLRPC_REQUEST&#039; ) ) {
		return;
	}

	wpcom_vip_add_role_caps( &#039;contributor&#039;, array( &#039;upload_files&#039; ) );
}

/**
 * Returns a URL for a given attachment with the appropriate resizing querystring.
 *
 * Typically, you should be using image sizes for handling this.
 *
 * However, this function can come in handy if you want a specific artibitrary or varying image size.
 *
 * @link https://docs.wpvip.com/technical-references/vip-go-files-system/image-transformation/
 *
 * @param int $attachment_id ID of the attachment
 * @param int $width Width of our resized image
 * @param int $height Height of our resized image
 * @param bool $crop (optional) whether or not to crop the image
 * @return string URL of the resized attachmen
 */
function wpcom_vip_get_resized_attachment_url( $attachment_id, $width, $height, $crop = false ) {
	$url = wp_get_attachment_url( $attachment_id );

	if ( ! $url ) {
		return false;
	}

	$resized_url = add_query_arg( [
		&#039;w&#039; =&gt; intval( $width ),
		&#039;h&#039; =&gt; intval( $height ),
	], $url );

	// @todo crop handling?

	return $resized_url;
}

/**
 * Allows you to customize the /via and follow recommendation for the WP.com Sharing Twitter button.
 *
 * @param string $via Optional. What the /via should be set to. Empty value disables the feature (the default).
 */
function wpcom_vip_sharing_twitter_via( $via = &#039;&#039; ) {
	if ( empty( $via ) ) {
		$via_callback = &#039;__return_false&#039;;
	} else {
		// sanitize_key() without changing capitizalization
		$raw_via = $via;
		$via     = preg_replace( &#039;/[^A-Za-z0-9_\-]/&#039;, &#039;&#039;, $via );
		$via     = apply_filters( &#039;sanitize_key&#039;, $via, $raw_via );

		$via_callback = function() use ( $via ) {
			return $via;
		};
	}

	add_filter( &#039;jetpack_sharing_twitter_via&#039;, $via_callback );
	add_filter( &#039;jetpack_open_graph_tags&#039;, function( $tags ) use ( $via ) {
		if ( isset( $tags[&#039;twitter:site&#039;] ) ) {
			if ( empty( $via ) ) {
				unset( $tags[&#039;twitter:site&#039;] );
			} else {
				$tags[&#039;twitter:site&#039;] = &#039;@&#039; . $via;
			}
		}
		return $tags;
	}, 99 ); // later so we run after Twitter Cards have run
}

/**
 * Disables Jetpack Post Flair entirely on the frontend.
 * This removes the filters and doesn&#039;t allow the stylesheet to be enqueued.
 */
function wpcom_vip_disable_post_flair() {
	add_filter( &#039;post_flair_disable&#039;, &#039;__return_true&#039; );
}

/**
 * Disables Jetpack Sharing in Posts and Pages.
 *
 * Sharing can be disabled in the dashboard, by removing all buttons from Enabled Services.
 *
 * This function is primary for automating sharing when you have numerous sites to administer.
 * It also assists having consistent CSS containers between development and production.
 */
function wpcom_vip_disable_sharing() {
	// Post Flair sets things up on init so we need to call on that if init hasn&#039;t fired yet.
	_wpcom_vip_call_on_hook_or_execute( function() {
		remove_filter( &#039;post_flair&#039;, &#039;sharing_display&#039;, 20 );
		remove_filter( &#039;the_content&#039;, &#039;sharing_display&#039;, 19 );
		remove_filter( &#039;the_excerpt&#039;, &#039;sharing_display&#039;, 19 );

		wpcom_vip_disable_sharing_resources();
	}, &#039;init&#039;, 99 );
}

/**
 * Disable CSS and JS output for Jetpack Sharing.
 *
 * Note: this disables things like smart buttons and share counts displayed alongside the buttons. Those will need to be handled manually if desired.
 */
function wpcom_vip_disable_sharing_resources() {
	_wpcom_vip_call_on_hook_or_execute( function() {
		add_filter( &#039;sharing_js&#039;, &#039;__return_false&#039; );
		remove_action( &#039;wp_head&#039;, &#039;sharing_add_header&#039;, 1 );
	}, &#039;init&#039;, 99 );
}

/**
 * Enables Jetpack Sharing in Posts and Pages.
 *
 * This feature is on by default, so the function is only useful if you&#039;ve also used wpcom_vip_disable_sharing().
 */
function wpcom_vip_enable_sharing() {
	add_filter( &#039;post_flair&#039;, &#039;sharing_display&#039;, 20 );
}

/**
 * Enable CSS and JS output for WPCOM sharing.
 *
 * Note: if resources were disabled previously and this is called after wp_head, it may not work as expected.
 */
function wpcom_vip_enable_sharing_resources() {
	remove_filter( &#039;sharing_js&#039;, &#039;__return_false&#039; );
	add_action( &#039;wp_head&#039;, &#039;sharing_add_header&#039;, 1 );
}

/**
 * Disables Jetpack Likes for Posts and Custom Post Types
 *
 * Sharing can also be disabled from the Dashboard (Settings &gt; Sharing).
 *
 * This function is primarily for programmatic disabling of the feature, for example when working with custom post types.
 */
function wpcom_vip_disable_likes() {
	add_filter( &#039;wpl_is_likes_visible&#039;, &#039;__return_false&#039;, 999 );
}

/**
 * Disables Jetpack Likes for Posts and Custom Post Types
 *
 * This feature is on by default, so the function is only useful if you&#039;ve also used wpcom_vip_disable_sharing().
 */
function wpcom_vip_enable_likes() {
	add_filter( &#039;wpl_is_likes_visible&#039;, &#039;__return_true&#039;, 999 );
}

/**
 * Disables Olark live chat
 *
 * @see show_live_chat()
 */
function wpcom_vip_remove_livechat() {
	add_filter( &#039;vip_live_chat_enabled&#039;, &#039;__return_false&#039; );
}

/**
* Eliminates widows in strings by replace the breaking space that appears before the last word with a non-breaking space.
*
* This function is defined on WordPress.com and can be a common source of frustration for VIP devs.
* Now they can be frustrated in their local environments as well :)
*
* @param string $str Optional. String to operate on.
* @return string
* @link http://www.shauninman.com/post/heap/2006/08/22/widont_wordpress_plugin Typesetting widows
*/
function widont( $str = &#039;&#039; ) {
	// Don&#039;t apply on non-tablet mobile devices so the browsers can fit to the viewport properly.
	if (
		function_exists( &#039;jetpack_is_mobile&#039; ) &amp;&amp; jetpack_is_mobile() &amp;&amp;
		class_exists( &#039;Jetpack_User_Agent_Info&#039; ) &amp;&amp; ! Jetpack_User_Agent_Info::is_tablet()
	) {
		return $str;
	}

	// We&#039;re dealing with whitespace from here out, let&#039;s not have any false positives. :)
	$str = trim( $str );

	// If string contains three or fewer words, don&#039;t join.
	if ( count( preg_split( &#039;#\s+#&#039;, $str ) ) &lt;= 3 ) {
		return $str;
	}

	// Don&#039;t join if words exceed a certain length: minimum 10 characters, default 15 characters, filterable via `widont_max_word_length`.
	$widont_max_word_length = max( 10, absint( apply_filters( &#039;widont_max_word_length&#039;, 15 ) ) );
	$regex                  = &#039;#\s+([^\s]{1,&#039; . $widont_max_word_length . &#039;})\s+([^\s]{1,&#039; . $widont_max_word_length . &#039;})$#&#039;;

	return preg_replace( $regex, &#039; $1&amp;nbsp;$2&#039;, $str );
}

// Leave these wrapped in function_exists() b/c they are so generically named
if ( ! function_exists( &#039;wp_startswith&#039; ) ) :
	function wp_startswith( $haystack, $needle ) {
		return 0 === strpos( $haystack, $needle );
	}
endif;

if ( ! function_exists( &#039;wp_endswith&#039; ) ) :
	function wp_endswith( $haystack, $needle ) {
		return substr( $haystack, -strlen( $needle ) ) === $needle;
	}
endif;

if ( ! function_exists( &#039;wp_in&#039; ) ) :
	function wp_in( $needle, $haystack ) {
		return false !== strpos( $haystack, $needle );
	}
endif;

/**
 * Simple 301 redirects
 *
 * @param array $vip_redirects_array Optional. Elements should be in the form of &#039;/old&#039; =&gt; &#039;http://wordpress.com/new/&#039;
 * @param bool $case_insensitive Optional. Should the redirects be case sensitive? Defaults to false.
 */
function vip_redirects( $vip_redirects_array = array(), $case_insensitive = false ) {
	if ( empty( $vip_redirects_array ) ) {
		return;
	}

	$redirect_url = &#039;&#039;;

	// Sanitize the redirects array
	$vip_redirects_array = array_map( &#039;untrailingslashit&#039;, $vip_redirects_array );

	$uri_unslashed = untrailingslashit( $_SERVER[&#039;REQUEST_URI&#039;] );

	if ( $case_insensitive ) {
		$vip_redirects_array = array_change_key_case( $vip_redirects_array );
		$uri_unslashed       = strtolower( $uri_unslashed );
	}

	// Get the current URL minus query string
	$parsed_uri_path         = parse_url( $uri_unslashed, PHP_URL_PATH );
	$parsed_uri_path         = $parsed_uri_path ? $parsed_uri_path : &#039;&#039;;
	$parsed_uri_path_slashed = trailingslashit( $parsed_uri_path );

	if ( $parsed_uri_path &amp;&amp; array_key_exists( $parsed_uri_path, $vip_redirects_array ) ) {
		$redirect_url = $vip_redirects_array[ $parsed_uri_path ];
	} elseif ( $parsed_uri_path_slashed &amp;&amp; array_key_exists( $parsed_uri_path_slashed, $vip_redirects_array ) ) {
		$redirect_url = $vip_redirects_array[ $parsed_uri_path_slashed ];
	}

	if ( $redirect_url ) {
		wp_redirect( $redirect_url, 301 );
		exit;
	}
}

/**
 * Wildcard redirects based on the beginning of the request path.
 *
 * This is basically an alternative to vip_regex_redirects() for when you only need to redirect /foo/bar/* to somewhere else.
 * Using regex to do this simple check would add lots of overhead.
 *
 * @param array $vip_redirects_array Optional. Elements should be in the form of &#039;/some-path/&#039; =&gt; &#039;http://wordpress.com/new/&#039;
 * @param bool $append_old_uri Optional. If true, the full path past the match will be added to the new URL. Defaults to false.
 */
function vip_substr_redirects( $vip_redirects_array = array(), $append_old_uri = false ) {
	if ( empty( $vip_redirects_array ) ) {
		return;
	}

	$request_uri = $_SERVER[&#039;REQUEST_URI&#039;] ?? &#039;&#039;;
	// Don&#039;t do anything for the homepage
	if ( &#039;/&#039; == $request_uri ) {
		return;
	}

	foreach ( $vip_redirects_array as $old_path =&gt; $new_url ) {
		if ( substr( $request_uri, 0, strlen( $old_path ) ) == $old_path ) {
			if ( $append_old_uri ) {
				$new_url .= str_replace( $old_path, &#039;&#039;, $request_uri );
			}
			wp_redirect( $new_url, 301 );
			exit();
		}
	}
}

/**
 * Advanced 301 redirects using regex to match and redirect URLs.
 *
 * Warning: Since regex is expensive and this will be run on every uncached pageload, you&#039;ll want to keep this small, lean, and mean.
 *
 * Some examples:
 *
 * Redirecting from /2011/12/dont-miss-it-make-live-holiday-giveaway.html (extra .html at the end)
 * &#039;|/([0-9]{4})/([0-9]{2})/([0-9]{2})/([^/]+)\.html|&#039; =&gt; &#039;|/$1/$2/$3/$4/|&#039;
 *
 * Redirecting from /archive/2011/12/dont-miss-it-make-live-holiday-giveaway
 * &#039;|/archive/([0-9]{4})/([0-9]{2})/([^/]+)/?|&#039; =&gt; &#039;|/$3/|&#039; // since we don&#039;t have the day, we should just send to /%postname% then WordPress can redirect from there
 *
 * Redirecting from /tax-tips/how-to-get-a-tax-break-for-summer-child-care/04152011-6163 (/%category%/%postname%/%month%%day%%year%-%post_id%)
 * &#039;|/([^/]+)\/([^/]+)/([0-9]{1,2})([0-9]{1,2})([0-9]{4})-([0-9]{1,})/?|&#039; =&gt; &#039;|/$5/$3/$4/$2/|&#039;
 *
 * @param array $vip_redirects_array Optional. Array of key/value pairs to redirect from/to.
 * @param bool $with_querystring Optional. Set this to true if your redirect string is in the format of an absolute URL. Defaults to false (just the path).
 *
 */
function vip_regex_redirects( $vip_redirects_array = array(), $with_querystring = false ) {

	if ( empty( $vip_redirects_array ) ) {
		return;
	}

	$uri = $_SERVER[&#039;REQUEST_URI&#039;];

	if ( ! $with_querystring ) {
		$uri = parse_url( $uri, PHP_URL_PATH );
	}

	if ( $uri &amp;&amp; &#039;/&#039; != $uri ) { // don&#039;t process for homepage

		foreach ( $vip_redirects_array as $old_url =&gt; $new_url ) {
			if ( preg_match( $old_url, $uri, $matches ) ) {
				$redirect_uri = preg_replace( $old_url, $new_url, $uri );
				wp_redirect( $redirect_uri, 301 );
				exit;
			}
		}
	}
}

/**
 * Fetch a remote URL and cache the result for a certain period of time.
 *
 * This function originally used file_get_contents(), hence the function name.
 * While it no longer does, it still operates the same as the basic PHP function.
 *
 * We strongly recommend not using a $timeout value of more than 3 seconds as this
 * function makes blocking requests (stops page generation and waits for the response).
 *
 * The $extra_args are:
 *  * obey_cache_control_header: uses the &quot;cache-control&quot; &quot;max-age&quot; value if greater than $cache_time.
 *  * http_api_args: see https://developer.wordpress.org/reference/functions/wp_remote_get/
 *
 * @link https://docs.wpvip.com/technical-references/code-quality-and-best-practices/retrieving-remote-data/ Fetching Remote Data
 * @param string $url URL to fetch
 * @param int $timeout Optional. The timeout limit in seconds; valid values are 1-10. Defaults to 3.
 * @param int $cache_time Optional. The minimum cache time in seconds. Valid values are &gt;= 60. Defaults to 900.
 * @param array $extra_args Optional. Advanced arguments: &quot;obey_cache_control_header&quot; and &quot;http_api_args&quot;.
 * @return string The remote file&#039;s contents (cached)
 */
function wpcom_vip_file_get_contents( $url, $timeout = 3, $cache_time = 900, $extra_args = array() ) {
	global $blog_id;

	$extra_args_defaults = array(
		&#039;obey_cache_control_header&#039; =&gt; true, // Uses the &quot;cache-control&quot; &quot;max-age&quot; value if greater than $cache_time
		&#039;http_api_args&#039;             =&gt; array(), // See http://codex.wordpress.org/Function_API/wp_remote_get
	);

	$extra_args = wp_parse_args( $extra_args, $extra_args_defaults );

	$cache_key       = md5( serialize( array_merge( $extra_args, array( &#039;url&#039; =&gt; $url ) ) ) );
	$backup_key      = $cache_key . &#039;_backup&#039;;
	$disable_get_key = $cache_key . &#039;_disable&#039;;
	$cache_group     = &#039;wpcom_vip_file_get_contents&#039;;

	// Temporary legacy keys to prevent mass cache misses during our key switch
	$old_cache_key       = md5( $url );
	$old_backup_key      = &#039;backup:&#039; . $old_cache_key;
	$old_disable_get_key = &#039;disable:&#039; . $old_cache_key;

	// Let&#039;s see if we have an existing cache already
	// Empty strings are okay, false means no cache
	$cache = wp_cache_get( $cache_key, $cache_group );
	if ( false !== $cache ) {
		return $cache;
	}

	// Legacy
	$cache = wp_cache_get( $old_cache_key, $cache_group );
	if ( false !== $cache ) {
		return $cache;
	}

	// The timeout can be 1 to 10 seconds, we strongly recommend no more than 3 seconds
	$timeout = min( 10, max( 1, (int) $timeout ) );

	if ( $timeout &gt; 3 ) {
		_doing_it_wrong( __FUNCTION__, &#039;Using a timeout value of over 3 seconds is strongly discouraged because users have to wait for the remote request to finish before the rest of their page loads.&#039;, null );
	}

	$server_up = true;
	$response  = false;
	$content   = false;

	// Check to see if previous attempts have failed
	if ( false !== wp_cache_get( $disable_get_key, $cache_group ) ) {
		$server_up = false;
	}
	// Legacy
	elseif ( false !== wp_cache_get( $old_disable_get_key, $cache_group ) ) {
		$server_up = false;
	}
	// Otherwise make the remote request
	else {
		$http_api_args            = (array) $extra_args[&#039;http_api_args&#039;];
		$http_api_args[&#039;timeout&#039;] = $timeout;
		$response                 = wp_remote_get( $url, $http_api_args );
	}

	// Was the request successful?
	if ( $server_up &amp;&amp; ! is_wp_error( $response ) &amp;&amp; 200 == wp_remote_retrieve_response_code( $response ) ) {
		$content = wp_remote_retrieve_body( $response );

		$cache_header = wp_remote_retrieve_header( $response, &#039;cache-control&#039; );
		if ( is_array( $cache_header ) ) {
			$cache_header = array_shift( $cache_header );
		}

		// Obey the cache time header unless an arg is passed saying not to
		if ( $extra_args[&#039;obey_cache_control_header&#039;] &amp;&amp; $cache_header ) {
			$cache_header = trim( $cache_header );
			// When multiple cache-control directives are returned, they are comma separated
			foreach ( explode( &#039;,&#039;, $cache_header ) as $cache_control ) {
				// In this scenario, only look for the max-age directive
				if ( &#039;max-age&#039; == substr( trim( $cache_control ), 0, 7 ) ) {
					// Note the array_pad() call prevents &#039;undefined offset&#039; notices when explode() returns less than 2 results
					list( $cache_header_type, $cache_header_time ) = array_pad( explode( &#039;=&#039;, trim( $cache_control ), 2 ), 2, null );
				}
			}
			// If the max-age directive was found and had a value set that is greater than our cache time
			if ( isset( $cache_header_type ) &amp;&amp; isset( $cache_header_time ) &amp;&amp; $cache_header_time &gt; $cache_time ) {
				$cache_time = (int) $cache_header_time; // Casting to an int will strip &quot;must-revalidate&quot;, etc.
			}
		}

		// The cache time shouldn&#039;t be less than a minute
		// Please try and keep this as high as possible though
		// It&#039;ll make your site faster if you do
		$cache_time = (int) $cache_time;
		if ( $cache_time &lt; 60 ) {
			$cache_time = 60;
		}

		// Cache the result
		wp_cache_set( $cache_key, $content, $cache_group, $cache_time );

		// Additionally cache the result with no expiry as a backup content source
		wp_cache_set( $backup_key, $content, $cache_group );

		// So we can hook in other places and do stuff
		do_action( &#039;wpcom_vip_remote_request_success&#039;, $url, $response );
	}
	// Okay, it wasn&#039;t successful. Perhaps we have a backup result from earlier.
	elseif ( $content = wp_cache_get( $backup_key, $cache_group ) ) {
		// If a remote request failed, log why it did
		if ( ! defined( &#039;WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING&#039; ) || ! WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING ) {
			if ( $response &amp;&amp; ! is_wp_error( $response ) ) {
				error_log( &quot;wpcom_vip_file_get_contents: Blog ID {$blog_id}: Failure for $url and the result was: &quot; . $response[&#039;response&#039;][&#039;code&#039;] . &#039; &#039; . $response[&#039;response&#039;][&#039;message&#039;] );
			} elseif ( $response ) { // is WP_Error object
				error_log( &quot;wpcom_vip_file_get_contents: Blog ID {$blog_id}: Failure for $url and the result was: &quot; . $response-&gt;get_error_message() );
			}
		}
	}
	// Legacy
	elseif ( $content = wp_cache_get( $old_backup_key, $cache_group ) ) {
		// If a remote request failed, log why it did
		if ( ! defined( &#039;WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING&#039; ) || ! WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING ) {
			if ( $response &amp;&amp; ! is_wp_error( $response ) ) {
				error_log( &quot;wpcom_vip_file_get_contents: Blog ID {$blog_id}: Failure for $url and the result was: &quot; . $response[&#039;response&#039;][&#039;code&#039;] . &#039; &#039; . $response[&#039;response&#039;][&#039;message&#039;] );
			} elseif ( $response ) { // is WP_Error object
				error_log( &quot;wpcom_vip_file_get_contents: Blog ID {$blog_id}: Failure for $url and the result was: &quot; . $response-&gt;get_error_message() );
			}
		}
	}
	// We were unable to fetch any content, so don&#039;t try again for another 60 seconds
	elseif ( $response ) {
		wp_cache_set( $disable_get_key, 1, $cache_group, 60 );

		// If a remote request failed, log why it did
		if ( ! defined( &#039;WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING&#039; ) || ! WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING ) {
			if ( $response &amp;&amp; ! is_wp_error( $response ) ) {
				error_log( &quot;wpcom_vip_file_get_contents: Blog ID {$blog_id}: Failure for $url and the result was: &quot; . $response[&#039;response&#039;][&#039;code&#039;] . &#039; &#039; . $response[&#039;response&#039;][&#039;message&#039;] );
			} elseif ( $response ) { // is WP_Error object
				error_log( &quot;wpcom_vip_file_get_contents: Blog ID {$blog_id}: Failure for $url and the result was: &quot; . $response-&gt;get_error_message() );
			}
		}
		// So we can hook in other places and do stuff
		do_action( &#039;wpcom_vip_remote_request_error&#039;, $url, $response );
	}

	return $content;
}

/**
 * Redirect http://blog.wordpress.com/feed/ to $target URL
 *
 * Don&#039;t redirect if a feed service user agent, because that could result in a loop.
 *
 * This can be executed before WP init because it checks the URI directly to see if the main feed is being requested.
 *
 * @author lloydbudd
 * @link https://wpvip.com/documentation/redirect-the-feed-to-feedburner/ Redirect the Feed To Feedburner
 * @param string $target URL to direct feed services to
 */
function vip_main_feed_redirect( $target ) {
	if ( wpcom_vip_is_main_feed_requested() &amp;&amp; ! wpcom_vip_is_feedservice_ua() ) {
		wp_redirect( $target, &#039;302&#039; );
		die;
	}
}

/**
 * Returns if any of the formats of the main feed are requested
 *
 * @author lloydbudd
 * @return bool Returns true if main feed is requested
 */
function wpcom_vip_is_main_feed_requested() {
	$toMatch = &#039;#^/(wp-(rdf|rss|rss2|atom|rssfeed).php|index.xml|feed|rss)/?$#i&#039;;
	$request = $_SERVER[&#039;REQUEST_URI&#039;];
	return (bool) preg_match( $toMatch, $request );
}

/**
 * Returns if the current visitor has a feed service user agent
 *
 * @author lloydbudd
 * @return bool Returns true if the current visitor has a feed service user agent.
 */
function wpcom_vip_is_feedservice_ua() {
	if ( function_exists( &#039;wpcom_feed_cache_headers&#039; ) ) {
		// Workaround so that no feed request served from nginx wpcom-feed-cache
		// If you are checking you must already know is a feed
		// and don&#039;t want any requests cached
		// ASSUMPTION: you&#039;ve already confirmed is_feed() b/f calling
		// wpcom_vip_is_feedservice_ua
			header( &#039;X-Accel-Expires: 0&#039; );
	}


	//phpcs:ignore WordPressVIPMinimum.Variables.RestrictedVariables.cache_constraints___SERVER__HTTP_USER_AGENT__
	$http_user_agent = $_SERVER[&#039;HTTP_USER_AGENT&#039;] ?? &#039;&#039;;

	return (bool) preg_match( &#039;/feedburner|feedvalidator|MediafedMetrics/i&#039;, $http_user_agent );
}

/**
 * Responds to a blog.wordpress.com/crossdomain.xml request with the contents of a crossdomain.xml file located in the root of your theme.
 *
 * @author lloydbudd
 */
function vip_crossdomain_redirect() {
	add_action( &#039;init&#039;, &#039;_vip_crossdomain_redirect&#039; );
}

/**
 * Helper function for vip_crossdomain_redirect(); serves up /vip/your_theme/crossdomain.xml
 *
 * @see vip_crossdomain_redirect()
 */
function _vip_crossdomain_redirect() {
	$request = $_SERVER[&#039;REQUEST_URI&#039;];
	if ( &#039;/crossdomain.xml&#039; == $request ) {
		header( &#039;Content-Type: text/xml&#039; );
		echo file_get_contents( get_stylesheet_directory() . $request );
		exit();
	}
}

/**
 * Get random posts; a simple, more efficient approach..
 *
 * MySQL queries that use ORDER BY RAND() can be pretty challenging and slow on large datasets.
 * This function is an alternative method for getting random posts, though it&#039;s not as good but at least it won&#039;t destroy your site :).
 *
 * @param int $number Optional. Amount of random posts to get. Default 1.
 * @param string $post_type Optional. Specify the post_type to use when randomizing posts. Default &#039;post&#039;.
 * @param bool $return_ids Optional. To just get the IDs, set this to true, otherwise post objects are returned (the default).
 * @param int $category_id Optional. Limit to a specific category
 * @return array
 */
function vip_get_random_posts( $number = 1, $post_type = &#039;post&#039;, $return_ids = false, $category_id = 0 ) {
	$query = new WP_Query( array(
		&#039;posts_per_page&#039;      =&gt; 100,
		&#039;fields&#039;              =&gt; &#039;ids&#039;,
		&#039;post_type&#039;           =&gt; $post_type,
		&#039;no_found_rows&#039;       =&gt; true,
		&#039;post_status&#039;         =&gt; &#039;publish&#039;,
		&#039;ignore_sticky_posts&#039; =&gt; true,
		&#039;category__in&#039;        =&gt; $category_id,
	) );

	$post_ids = $query-&gt;posts;
	shuffle( $post_ids );
	$post_ids = array_splice( $post_ids, 0, $number );

	if ( $return_ids ) {
		return $post_ids;
	}

	$random_posts = get_posts( array(
		&#039;post__in&#039;    =&gt; $post_ids,
		&#039;numberposts&#039; =&gt; count( $post_ids ),
		&#039;post_type&#039;   =&gt; $post_type,
	) );

	return $random_posts;
}

/**
 * This is a sophisticated extended version of wp_remote_request(). It is designed to more gracefully handle failure than wpcom_vip_file_get_contents() does.
 *
 * Note that like wp_remote_request(), this function does not cache.
 *
 * @link https://docs.wpvip.com/technical-references/code-quality-and-best-practices/retrieving-remote-data/ Fetching Remote Data
 * @param string $url URL to request
 * @param string $fallback_value Optional. Set a fallback value to be returned if the external request fails.
 * @param int $threshold Optional. The number of fails required before subsequent requests automatically return the fallback value. Defaults to 3, with a maximum of 10.
 * @param int $timeout Optional. Number of seconds before the request times out. Valid values 1-5; defaults to 1.
 * @param int $retry Optional. Number of seconds before resetting the fail counter and the number of seconds to delay making new requests after the fail threshold is reached. Defaults to 20, with a minimum of 10.
 * @param array Optional. Set other arguments to be passed to wp_remote_request().
 * @return string|WP_Error|array Array of results. If fail counter is met, returns the $fallback_value, otherwise return WP_Error.
 * @see wp_remote_request()
 */
function vip_safe_wp_remote_request( $url, $fallback_value = &#039;&#039;, $threshold = 3, $timeout = 1, $retry = 20, $args = array() ) {
	global $blog_id;

	$default_args = array( &#039;method&#039; =&gt; &#039;GET&#039; );
	$parsed_args  = wp_parse_args( $args, $default_args );

	$cache_group = &quot;$blog_id:vip_safe_wp_remote_request&quot;;
	$cache_key   = &#039;disable_remote_request_&#039; . md5( parse_url( $url, PHP_URL_HOST ) . &#039;_&#039; . $parsed_args[&#039;method&#039;] );

	// valid url
	if ( empty( $url ) || ! parse_url( $url ) ) {
		return ( $fallback_value ) ? $fallback_value : new WP_Error( &#039;invalid_url&#039;, $url );
	}

	// Ensure positive values
	$timeout   = abs( $timeout );
	$retry     = abs( $retry );
	$threshold = abs( $threshold );

	// Default max timeout is 5s.
	// For POST requests for through WP-CLI, this needs to be event higher to makes things like VIP Search commands works more consitently without tinkering.
	// For POST requests for admins, this needs to be a bit higher due to Elasticsearch and other things.
	$timeout         = (int) $timeout;
	$is_post_request = 0 === strcasecmp( &#039;POST&#039;, $parsed_args[&#039;method&#039;] );

	if ( defined( &#039;WP_CLI&#039; ) &amp;&amp; WP_CLI &amp;&amp; $is_post_request ) {
		if ( 30 &lt; $timeout ) {
			_doing_it_wrong( __FUNCTION__, &#039;Remote POST request timeouts are capped at 30 seconds in WP-CLI for performance and stability reasons.&#039;, null );
			$timeout = 30;
		}
	} elseif ( \is_admin() &amp;&amp; $is_post_request ) {
		if ( 15 &lt; $timeout ) {
			_doing_it_wrong( __FUNCTION__, &#039;Remote POST request timeouts are capped at 15 seconds for admin requests for performance and stability reasons.&#039;, null );
			$timeout = 15;
		}
	} else {
		if ( $timeout &gt; 5 ) {
			_doing_it_wrong( __FUNCTION__, &#039;Remote request timeouts are capped at 5 seconds for performance and stability reasons.&#039;, null );
			$timeout = 5;
		}
	}

	// retry time &lt; 10 seconds will default to 10 seconds.
	$retry = ( (int) $retry &lt; 10 ) ? 10 : (int) $retry;
	// more than 10 faulty hits seem to be to much
	$threshold = ( (int) $threshold &gt; 10 ) ? 10 : (int) $threshold;

	$option = wp_cache_get( $cache_key, $cache_group );

	// check if the timeout was hit and obey the option and return the fallback value
	if ( false !== $option &amp;&amp; time() - $option[&#039;time&#039;] &lt; $retry ) {
		if ( $option[&#039;hits&#039;] &gt;= $threshold ) {
			if ( ! defined( &#039;WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING&#039; ) || ! WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING ) {
				trigger_error( &quot;vip_safe_wp_remote_request: Blog ID {$blog_id}: Requesting $url with method {$parsed_args[ &#039;method&#039; ]} has been throttled after {$option[&#039;hits&#039;]} attempts. Not reattempting until after $retry seconds&quot;, E_USER_WARNING );
			}

			return ( $fallback_value ) ? $fallback_value : new WP_Error( &#039;remote_request_disabled&#039;, &#039;Remote requests disabled: &#039; . maybe_serialize( $option ) );
		}
	}

	$start    = microtime( true );
	$response = wp_remote_request( $url, array_merge( $parsed_args, array( &#039;timeout&#039; =&gt; $timeout ) ) );
	$end      = microtime( true );

	$elapsed = ( $end - $start ) &gt; $timeout;
	if ( true === $elapsed ) {
		if ( false !== $option &amp;&amp; $option[&#039;hits&#039;] &lt; $threshold ) {
			wp_cache_set( $cache_key, array(
				&#039;time&#039; =&gt; floor( $end ),
				&#039;hits&#039; =&gt; $option[&#039;hits&#039;] + 1,
			), $cache_group, $retry );
		} elseif ( false !== $option &amp;&amp; $option[&#039;hits&#039;] == $threshold ) {
			wp_cache_set( $cache_key, array(
				&#039;time&#039; =&gt; floor( $end ),
				&#039;hits&#039; =&gt; $threshold,
			), $cache_group, $retry );
		} else {
			wp_cache_set( $cache_key, array(
				&#039;time&#039; =&gt; floor( $end ),
				&#039;hits&#039; =&gt; 1,
			), $cache_group, $retry );
		}
	} else {
		if ( false !== $option &amp;&amp; $option[&#039;hits&#039;] &gt; 0 &amp;&amp; time() - $option[&#039;time&#039;] &lt; $retry ) {
			wp_cache_set( $cache_key, array(
				&#039;time&#039; =&gt; $option[&#039;time&#039;],
				&#039;hits&#039; =&gt; $option[&#039;hits&#039;] - 1,
			), $cache_group, $retry );
		} else {
			wp_cache_delete( $cache_key, $cache_group );
		}
	}

	if ( is_wp_error( $response ) ) {
		if ( ! defined( &#039;WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING&#039; ) || ! WPCOM_VIP_DISABLE_REMOTE_REQUEST_ERROR_REPORTING ) {
			trigger_error( &quot;vip_safe_wp_remote_request: Blog ID {$blog_id}: Requesting $url with method {$parsed_args[ &#039;method&#039; ]} and a timeout of $timeout failed. Result: &quot; . maybe_serialize( $response ), E_USER_WARNING );
		}
		do_action( &#039;wpcom_vip_remote_request_error&#039;, $url, $response );

		return ( $fallback_value ) ? $fallback_value : $response;
	}

	return $response;
}

/**
 * This is a convenience method for vip_safe_wp_remote_request() and behaves the same
 *
 * Note that like wp_remote_get(), this function does not cache.
 *
 * @link https://docs.wpvip.com/technical-references/code-quality-and-best-practices/retrieving-remote-data/ Fetching Remote Data
 * @see vip_safe_wp_remote_request()
 * @see wp_remote_get()
 */
function vip_safe_wp_remote_get( $url, $fallback_value = &#039;&#039;, $threshold = 3, $timeout = 1, $retry = 20, $args = array() ) {
	// Same defaults as WP_HTTP::get() https://developer.wordpress.org/reference/classes/wp_http/get/
	$default_args = array( &#039;method&#039; =&gt; &#039;GET&#039; );
	$parsed_args  = wp_parse_args( $args, $default_args );

	return vip_safe_wp_remote_request( $url, $fallback_value, $threshold, $timeout, $retry, $parsed_args );
}

/**
 * Returns profile information for a WordPress/Gravatar user
 *
 * @param string|int $email_or_id Email, ID, or username for user to lookup
 * @return false|array Profile info formatted as noted here: http://en.gravatar.com/site/implement/profiles/php/. If user not found, returns false.
 */
function wpcom_vip_get_user_profile( $email_or_id ) {

	if ( is_numeric( $email_or_id ) ) {
		$user = get_user_by( &#039;id&#039;, $email_or_id );
		if ( ! $user ) {
			return false;
		}

		$email = $user-&gt;user_email;
	} elseif ( is_email( $email_or_id ) ) {
		$email = $email_or_id;
	} else {
		$user_login = sanitize_user( $email_or_id, true );
		$user       = get_user_by( &#039;login&#039;, $user_login );
		if ( ! $user ) {
			return;
		}

		$email = $user-&gt;user_email;
	}

	$hashed_email = md5( strtolower( trim( $email ) ) );
	$profile_url  = esc_url_raw( sprintf( &#039;https://en.gravatar.com/%s.php&#039;, $hashed_email ), array( &#039;http&#039;, &#039;https&#039; ) );

	$profile = wpcom_vip_file_get_contents( $profile_url, 1, 900 );
	if ( $profile ) {
		$profile = unserialize( $profile );

		if ( is_array( $profile ) &amp;&amp; ! empty( $profile[&#039;entry&#039;] ) &amp;&amp; is_array( $profile[&#039;entry&#039;] ) ) {
			$profile = $profile[&#039;entry&#039;][0];
		} else {
			$profile = false;
		}
	}
	return $profile;
}

/**
 * Checks to see if a given e-mail address has a Gravatar or not.
 *
 * You can use this function to only call get_avatar() when the user has a Gravatar and display nothing (rather than a placeholder image) when they don&#039;t.
 *
 * @param string $email Email to check for a gravatar
 * @return bool Returns true if $email has a gravatar
 */
function wpcom_vip_email_has_gravatar( $email ) {

	$hash = md5( strtolower( trim( $email ) ) );

	// If not in the cache, check again
	if ( false === $has_gravatar = wp_cache_get( $hash, &#039;email_has_gravatar&#039; ) ) {

		$request = wp_remote_head( &#039;http://0.gravatar.com/avatar/&#039; . $hash . &#039;?d=404&#039; );

		$has_gravatar = ( 404 == wp_remote_retrieve_response_code( $request ) ) ? 0 : 1;

		wp_cache_set( $hash, $has_gravatar, &#039;email_has_gravatar&#039;, 86400 ); // Check daily
	}

	return (bool) $has_gravatar;
}

/**
 * Check if a URL is in a specified whitelist
 *
 * Example whitelist: array( &#039;mydomain.com&#039;, &#039;mydomain.net&#039; )
 *
 * @param string $url URL to check for
 * @param array $whitelisted_domains Array of whitelisted domains
 * @return bool Returns true if $url is in the $whitelisted_domains
 */
function wpcom_vip_is_valid_domain( $url, $whitelisted_domains ) {
	$domain = parse_url( $url, PHP_URL_HOST );

	if ( ! $domain ) {
		return false;
	}

	// Check if we match the domain exactly
	if ( in_array( $domain, $whitelisted_domains ) ) {
		return true;
	}

	$valid = false;

	foreach ( $whitelisted_domains as $whitelisted_domain ) {
		$whitelisted_domain = &#039;.&#039; . $whitelisted_domain; // Prevent things like &#039;evilsitetime.com&#039;
		if ( strpos( $domain, $whitelisted_domain ) === ( strlen( $domain ) - strlen( $whitelisted_domain ) ) ) {
			$valid = true;
			break;
		}
	}
	return $valid;
}

/**
 * Helper function to enable bulk user management on a per-user basis
 *
 * @param array $users Array of user logins
 */
function wpcom_vip_bulk_user_management_whitelist( $users ) {
	add_filter( &#039;bulk_user_management_admin_users&#039;, function() use ( $users ) {
		return $users;
	} );
}

/**
 * A version of wp_oembed_get() that provides caching.
 *
 * Note that if you&#039;re using this within the contents of a post, it&#039;s probably better to use the existing
 * WordPress functionality: http://codex.wordpress.org/Embeds. This helper function is more meant for other
 * places, such as sidebars.
 *
 * @param string $url The URL that should be embedded
 * @param array $args Addtional arguments and parameters the embed
 * @param int $ttl How long to cache for in seconds; minimum 18000 (5 Hours)
 * @return string
 */
function wpcom_vip_wp_oembed_get( $url, $args = array(), $ttl = false ) {
	// We want a min ttl of 5 hours (1800s).
	// And a max of 30 days (after which memcache thinks you&#039;re giving it a timestamp).
	// Let&#039;s also add a bit of variation to prevent stampedes.
	if ( $ttl
		&amp;&amp; $ttl &gt; ( 5 * HOUR_IN_SECONDS )
		&amp;&amp; $ttl &lt; ( MONTH_IN_SECONDS - HOUR_IN_SECONDS ) ) {
		$ttl = $ttl + rand( 0, HOUR_IN_SECONDS );
	} else {
		$ttl = rand( 5 * HOUR_IN_SECONDS, 6 * HOUR_IN_SECONDS );
	}

	$cache_key = md5( $url . &#039;||&#039; . serialize( $args ) );

	if ( false === $html = wp_cache_get( $cache_key, &#039;wpcom_vip_wp_oembed&#039; ) ) {
		$html = wp_oembed_get( $url, $args );
		wp_cache_set( $cache_key, $html, &#039;wpcom_vip_wp_oembed&#039;, $ttl );
	}

	return $html;
}

/**
 * Helper function for wpcom_vip_load_plugin(); sanitizes plugin folder name.
 *
 * You shouldn&#039;t use this function.
 *
 * @param string $folder Folder name
 * @return string Sanitized folder name
 */
function _wpcom_vip_load_plugin_sanitizer( $folder ) {
	$folder = preg_replace( &#039;#([^a-zA-Z0-9-_.]+)#&#039;, &#039;&#039;, $folder );
	$folder = str_replace( &#039;..&#039;, &#039;&#039;, $folder ); // To prevent going up directories

	return $folder;
}

/**
 * Loads a plugin from your plugins folder.
 *
 * Note - This function does not trigger plugin activation / deactivation hooks.
 * As such, it may not be compatible with all plugins
 *
 * @param string $plugin Optional. Plugin folder name of the plugin, or the folder and
 * plugin file name (such as wp-api/plugin.php), relative to either the VIP shared-plugins folder, or WP_PLUGIN_DIR
 * @param string $folder Subdirectory of WP_PLUGIN_DIR to load plugin from
 * @param bool $load_release_candidate Deprecated. No longer used
 * @return bool True if the include was successful
 */
function wpcom_vip_load_plugin( $plugin = false, $folder = false, $load_release_candidate_not_used = null ) {
	// Make sure there&#039;s a plugin to load
	if ( empty( $plugin ) ) {
		if ( ! WPCOM_IS_VIP_ENV ) {
			die( &#039;wpcom_vip_load_plugin() was called without a first parameter!&#039; );
		}
	}

	if ( ! wpcom_vip_should_load_plugins() ) {
		return;
	}

	/**
	 * wpcom compat
	 *
	 * Lots of themes set $folder to the default location so they can
	 * load a release candidate. We should interpret &#039;plugins&#039; to mean
	 * the plugin is in the default place.
	 */
	if ( $folder === &#039;plugins&#039; ) {
		$folder = false;
		_doing_it_wrong( __FUNCTION__, &#039;The specified $folder should not be &quot;plugins&quot;, which is the default location&#039;, &#039;2.0.0&#039; );
	}

	// Plugins should be loaded before the `plugins_loaded` hook.
	// Ideally, in client-mu-plugins or via wp-admin &gt; Plugins.
	if ( did_action( &#039;plugins_loaded&#039; ) ) {
		_doing_it_wrong( __FUNCTION__, sprintf( &#039;`wpcom_vip_load_plugin( %s, %s )` was called after the `plugins_loaded` hook. For best results, we recommend loading your plugins earlier from `client-mu-plugins`.&#039;, esc_html( $plugin ), esc_html( $folder ) ), null );
	}

	// Shared plugins are being deprecated.
	// This can be removed once shared plugins have all been removed.
	if ( ! defined( &#039;WPCOM_VIP_DISABLE_SHARED_PLUGINS&#039; ) ) {
		define( &#039;WPCOM_VIP_DISABLE_SHARED_PLUGINS&#039;, true );
	}

	// Is it a plugin file with multiple directories? Not supported. _could_ be supported
	// with some refactoring, but no real need to, just complicates things
	$exploded = explode( DIRECTORY_SEPARATOR, $plugin );

	if ( count( $exploded ) &gt; 2 ) {
		if ( ! WPCOM_IS_VIP_ENV ) {
			die( &#039;wpcom_vip_load_plugin() was called with multiple subdirectories&#039; );
		} else {
			_doing_it_wrong( &#039;wpcom_vip_load_plugin&#039;, &#039;Subdirectories not supported in file paths&#039;, &#039;&#039; );

			return false;
		}
	}

	// Is this a valid path? We know it has less than 3 parts, but it could still be
	// &#039;plugin/plugin&#039; (need a php file, if specifying a path rather than a slug)
	if ( count( $exploded ) === 2 ) {
		$pathinfo = pathinfo( $plugin );

		if ( ! isset( $pathinfo[&#039;extension&#039;] ) || &#039;php&#039; !== $pathinfo[&#039;extension&#039;] ) {
			if ( ! WPCOM_IS_VIP_ENV ) {
				die( &#039;wpcom_vip_load_plugin() was called with a path, but no php file was specified&#039; );
			} else {
				_doing_it_wrong( &#039;wpcom_vip_load_plugin&#039;, &#039;Must specify php file when loading via path&#039;, &#039;&#039; );

				return false;
			}
		}
	}

	// Array of files to check for loading the plugin. This is to support
	// non-standard plugin structures, such as $folder/plugin.php
	$test_files = array(
		&quot;{$plugin}.php&quot;,
		&#039;plugin.php&#039;,
	);

	// Is $plugin a filepath? If so, that&#039;s the only file we should test
	if ( basename( $plugin ) !== $plugin ) {
		$test_files = array( basename( $plugin ) );

		// Update the $plugin to the slug, so we store it correctly and build paths correctly
		$plugin = dirname( $plugin );
	}

	// Make sure $plugin and $folder are valid
	$plugin = _wpcom_vip_load_plugin_sanitizer( $plugin );
	$folder = _wpcom_vip_load_plugin_sanitizer( $folder );

	// Array of directories to check for the above files in, in priority order
	$test_directories = array();

	if ( $folder ) {
		$test_directories[] = WP_PLUGIN_DIR . &#039;/&#039; . $folder;
	} else {
		$test_directories[] = WP_PLUGIN_DIR;
		if ( wpcom_vip_can_use_shared_plugin( $plugin ) ) {
			$test_directories[] = WPMU_PLUGIN_DIR . &#039;/shared-plugins&#039;;
		}
	}

	$includepath = null;
	$plugin_type = null;

	foreach ( $test_directories as $directory ) {
		foreach ( $test_files as $file ) {
			// Prevent any traversal here
			$plugin = basename( $plugin ); // Just to be double, extra sure
			$file   = basename( $file );

			$path = &quot;{$directory}/{$plugin}/{$file}&quot;;

			if ( file_exists( $path ) ) {
				$includepath = $path;

				// Store where we found it, so we can properly represent that in UI
				// This is usually the directory above
				$plugin_type = basename( $directory );

				// release-candidates is a special case, as it&#039;s in a nested folder,
				// so we must look up one level
				if ( &#039;release-candidates&#039; === $plugin_type ) {
					$plugin_type = dirname( $directory );
				}

				// We found what we were looking for, break from both loops
				break 2;
			}
		}
	}

	if ( $includepath &amp;&amp; file_exists( $includepath ) ) {
		wpcom_vip_add_loaded_plugin( &quot;{$plugin_type}/{$plugin}/{$file}&quot; );

		return _wpcom_vip_include_plugin( $includepath );
	} else {
		$error_msg = sprintf( &#039;wpcom_vip_load_plugin: Unable to load plugin `%s`&#039;, $plugin );
		if ( $includepath ) {
			$error_msg .= sprintf( &#039;; the path `%s` does not exist.&#039;, $includepath );
		} else {
			$error_msg .= sprintf( &#039;; the plugin was not found in the plugin directories (%s)&#039;, implode( &#039;; &#039;, $test_directories ) );
		}

		if ( ! WPCOM_IS_VIP_ENV ) {
			die( $error_msg );
		} else {
			// On VIP we try to both notify the user...
			trigger_error( $error_msg, E_USER_WARNING );
			// ...And trigger a New Relic notice, if the extension is available
			if ( extension_loaded( &#039;newrelic&#039; ) &amp;&amp; function_exists( &#039;newrelic_notice_error&#039; ) ) {
				newrelic_notice_error( $error_msg );
			}
		}
	}
}

/**
 * Determine if a plugin can be used or not
 *
 * @param  string $plugin plugin name
 * @return bool
 */
function wpcom_vip_can_use_shared_plugin( $plugin ) {
	// Array of shared plugins we are not deprecating
	$protected_shared_plugins = array(
		&#039;two-factor&#039;,
		&#039;jetpack-force-2fa&#039;,
		&#039;vip-go-elasticsearch&#039;,
	);

	if ( ! defined( &#039;WPCOM_VIP_DISABLE_SHARED_PLUGINS&#039; ) ) {
		return true;
	}

	if ( true !== WPCOM_VIP_DISABLE_SHARED_PLUGINS ) {
		return true;
	}

	return in_array( $plugin, $protected_shared_plugins, true );
}

/**
 * Helper function to check if we can load plugins or not.
 */
function wpcom_vip_should_load_plugins() {
	static $should_load_plugins;

	if ( isset( $should_load_plugins ) ) {
		return $should_load_plugins;
	}

	$should_load_plugins = true;

	// WP-CLI loaded with --skip-plugins flag
	if ( defined( &#039;WP_CLI&#039; ) &amp;&amp; WP_CLI ) {
		$skipped_plugins = \WP_CLI::get_runner()-&gt;config[&#039;skip-plugins&#039;];
		if ( $skipped_plugins ) {
			$should_load_plugins = false;
		}
	}

	return $should_load_plugins;
}

/**
 * Store the name of a VIP plugin that will be loaded
 *
 * @param string $plugin Plugin name and folder
 * @see wpcom_vip_load_plugin()
 */
function wpcom_vip_add_loaded_plugin( $plugin ) {
	global $vip_loaded_plugins;

	if ( ! isset( $vip_loaded_plugins ) ) {
		$vip_loaded_plugins = array();
	}

	array_push( $vip_loaded_plugins, $plugin );
}

/**
 * Get the names of VIP plugins that have been loaded
 *
 * @return array
 */
function wpcom_vip_get_loaded_plugins() {
	global $vip_loaded_plugins;

	if ( ! isset( $vip_loaded_plugins ) ) {
		$vip_loaded_plugins = array();
	}

	return $vip_loaded_plugins;
}

/**
 * Check if plugin is loaded
 *
 * @param string $plugin Plugin name and folder
 * @return bool
 */
function wpcom_vip_plugin_is_loaded( $plugin ) {
	return in_array( $plugin, wpcom_vip_get_loaded_plugins() );
}

/**
 * Load `vipgo-helper.php` if it exists for a network-activated plugin
 *
 * Technically tries to include the main plugin file again, but we don&#039;t care, because it uses `include_once()` and is called after Core loads the plugin
 */
function wpcom_vip_load_helpers_for_network_active_plugins() {
	// wp_get_active_network_plugins() won&#039;t exist otherwise
	if ( ! is_multisite() ) {
		return;
	}

	if ( ! wpcom_vip_should_load_plugins() ) {
		return;
	}

	foreach ( wp_get_active_network_plugins() as $plugin ) {
		_wpcom_vip_include_plugin( $plugin );
	}
}
add_action( &#039;muplugins_loaded&#039;, &#039;wpcom_vip_load_helpers_for_network_active_plugins&#039; );

/**
 * Load `vipgo-helper.php` if it exists for a plugin loaded outside of our custom UI and helpers
 *
 * Technically tries to include the main plugin file again, but we don&#039;t care, because it uses `include_once()` and is called after Core loads the plugin
 */
function wpcom_vip_load_helpers_for_sites_core_plugins() {
	if ( ! wpcom_vip_should_load_plugins() ) {
		return;
	}

	foreach ( wp_get_active_and_valid_plugins() as $plugin ) {
		_wpcom_vip_include_plugin( $plugin );
	}
}
add_action( &#039;plugins_loaded&#039;, &#039;wpcom_vip_load_helpers_for_sites_core_plugins&#039;, 6 ); // Loaded at priority 6 because all plugins are typically loaded before &#039;plugins_loaded&#039;, and the UI-enabled plugins use priority 5

/**
 * Include a plugin and its helper, handling variable scope in the process
 *
 * @param string $file Plugin file to load
 * @return true
 */
function _wpcom_vip_include_plugin( $file ) {
	// Since we&#039;re going to be include()&#039;ing inside of a function,
	// we need to do some hackery to get the variable scope we want.
	// See http://www.php.net/manual/en/language.variables.scope.php#91982

	// Start by marking down the currently defined variables (so we can exclude them later)
	$pre_include_variables = get_defined_vars();

	// Support symlinks
	wp_register_plugin_realpath( $file );

	// Now include
	include_once $file;

	// Check for a helper file, and include if present
	$helper_file = dirname( $file ) . &#039;/vipgo-helper.php&#039;;
	if ( file_exists( $helper_file ) ) {
		include_once $helper_file;
	}

	// Blacklist out some variables
	$blacklist = array(
		&#039;blacklist&#039;             =&gt; 0,
		&#039;pre_include_variables&#039; =&gt; 0,
		&#039;new_variables&#039;         =&gt; 0,
		&#039;helper_file&#039;           =&gt; 0,
	);

	// Let&#039;s find out what&#039;s new by comparing the current variables to the previous ones
	$new_variables = array_diff_key( get_defined_vars(), $GLOBALS, $blacklist, $pre_include_variables );

	// global each new variable
	foreach ( $new_variables as $new_variable =&gt; $value ) {
		$GLOBALS[ $new_variable ] = $value;
	}

	return true;
}

/**
 * Is the given user an Automattician?
 *
 * This does a relatively weak check that the user has an Automattic email address, and that
 * they have verified that email address. It&#039;s possible to fake that data (it&#039;s just user meta
 * and user_email), so don&#039;t use this for protecting sensitive info or performing
 * sensitive tasks.
 *
 * This does NOT guarantee the current user is proxied. Use is_proxied_automattician()
 * for that.
 *
 * @see is_proxied_automattician
 *
 * @param int $user_id A WP User id
 * @return bool True, if user is an Automattician, otherwise false
 */
function is_automattician( $user_id = false ) {
	if ( $user_id ) {
		$user = new WP_User( $user_id );
	} else {
		$user = wp_get_current_user();
	}

	if ( ! isset( $user-&gt;ID ) || ! $user-&gt;ID ) {
		return false;
	}

	// Check that their address is an a8c one, *and* they have validated that address
	if ( ! class_exists( &#039;Automattic\VIP\Support_User\User&#039; ) ) {
		return false;
	}

	if ( \Automattic\VIP\Support_User\User::is_verified_automattician( $user-&gt;ID ) ) {
		return true;
	}

	return false;
}

/**
 * Is the current user an Automattician, authenticated via the Automattic proxy.
 *
 * Determine if the current request is made via the Automattic proxy,
 * which is only available to Automatticians, AND if the current user
 * is an Automattician.
 *
 * @see is_automattician
 *
 * @return bool True, if the current request is made via the Automattic proxy
 */
function is_proxied_automattician() {
	return is_proxied_request() &amp;&amp; is_automattician();
}

/**
 * Is the current request made using the Automattic proxy.
 *
 * @return bool True if the current request is made using the Automattic proxy
 */
function is_proxied_request() {
	return defined( &#039;A8C_PROXIED_REQUEST&#039; ) &amp;&amp; true === A8C_PROXIED_REQUEST;
}

/**
 * Is the current request being made from Jetpack servers?
 *
 * NOTE - This checks the REMOTE_ADDR against known JP IPs. The IP can still be spoofed,
 * (but usually an attacker cannot receive the response), so it is important to treat it accordingly
 *
 * @return bool Bool indicating if the current request came from JP servers
 */
function vip_is_jetpack_request() {
	// Filter by env
	if ( defined( &#039;WP_CLI&#039; ) &amp;&amp; WP_CLI ) {
		return false;
	}

	//phpcs:ignore WordPressVIPMinimum.Variables.RestrictedVariables.cache_constraints___SERVER__HTTP_USER_AGENT__
	$http_user_agent = $_SERVER[&#039;HTTP_USER_AGENT&#039;] ?? &#039;&#039;;
	// Simple UA check to filter out most.
	if ( false === stripos( $http_user_agent, &#039;jetpack&#039; ) ) {
		return false;
	}

	require_once __DIR__ . &#039;/../lib/proxy/class-iputils.php&#039;;

	// If has a valid-looking UA, check the remote IP
	// From https://jetpack.com/support/hosting-faq/#jetpack-whitelist
	// Or https://jetpack.com/ips-v4.json
	$jetpack_ips = array(
		&#039;122.248.245.244/32&#039;,
		&#039;54.217.201.243/32&#039;,
		&#039;54.232.116.4/32&#039;,
		&#039;192.0.80.0/20&#039;,
		&#039;192.0.96.0/20&#039;,
		&#039;192.0.112.0/20&#039;,
		&#039;195.234.108.0/22&#039;,
		&#039;192.0.96.202/32&#039;,
		&#039;192.0.98.138/32&#039;,
		&#039;192.0.102.71/32&#039;,
		&#039;192.0.102.95/32&#039;,
	);

	// phpcs:ignore WordPressVIPMinimum.Variables.ServerVariables.UserControlledHeaders, WordPress.Security.ValidatedSanitizedInput.InputNotValidated, WordPress.Security.ValidatedSanitizedInput.InputNotValidated, WordPress.Security.ValidatedSanitizedInput.MissingUnslash, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
	return Automattic\VIP\Proxy\IpUtils::check_ip( $_SERVER[&#039;REMOTE_ADDR&#039;], $jetpack_ips ) || Automattic\VIP\Proxy\IpUtils::check_ip( $_SERVER[&#039;HTTP_X_FORWARDED_FOR&#039;], $jetpack_ips );
}

/**
 * Send a message to IRC
 *
 * $level can be an int of one of the following
 * NONE = 0
 * WARNING = 1
 * ALERT = 2
 * CRITICAL = 3
 * RECOVERY = 4
 * INFORMATION = 5
 * SCALE = 6
 *
 * Example Usage
 *
 * wpcom_vip_irc( &#039;@testuser&#039;, &#039;test message&#039; );                // send testuser a pm on IRC from &quot;a8c&quot;
 * wpcom_vip_irc( &#039;@testuser&#039;, &#039;test message&#039;, 3 ); // send testuser a pm on IRC with level &#039;critical&#039;
 * wpcom_vip_irc( &#039;testing&#039;, &#039;test message&#039; );                  // have &quot;a8c&quot; join #testing and say something
 * wpcom_vip_irc( &#039;testing&#039;, &#039;test message&#039;, 4 );       // have &quot;a8c-test&quot; join #testing and say something with level &#039;recovery&#039;
 *
 * @param $target (string) Channel or Username.  Usernames prefixed with an @, channel optionally prefixed by #.
 * @param $message (string) Message
 * @param $level (int) Level The severity level of the message
 * @param $kind string Cache slug
 * @param $interval integer Interval in seconds between two messages sent from one DC
 */
function wpcom_vip_irc( $channel_or_user, $message, $level = 0, $kind = &#039;&#039;, $interval = 0 ) {
	if ( $kind &amp;&amp; $interval &amp;&amp; function_exists( &#039;wp_cache_add&#039; ) &amp;&amp; function_exists( &#039;wp_cache_add_global_groups&#039; ) ) {
		wp_cache_add_global_groups( array( &#039;irc-ratelimit&#039; ) );

		if ( ! wp_cache_add( $kind, 1, &#039;irc-ratelimit&#039;, $interval ) ) {
			return false;
		}
	}

	if ( ! defined( &#039;ALERT_SERVICE_ADDRESS&#039; ) || ! ALERT_SERVICE_ADDRESS ) {
		error_log( &#039;Missing IRC host configuration in ALERT_SERVICE_ADDRESS constant&#039; );

		return false;
	}

	if ( ! defined( &#039;ALERT_SERVICE_PORT&#039; ) || ! ALERT_SERVICE_PORT ) {
		error_log( &#039;Missing IRC port configuration in ALERT_SERVICE_PORT constant&#039; );

		return false;
	}

	$channel_or_user = preg_replace( &#039;/[^0-9a-z#@|.-]/&#039;, &#039;&#039;, $channel_or_user );

	if ( ! $channel_or_user ) {
		error_log( &quot;Invalid \$channel_or_user: wpcom_vip_irc( &#039;$channel_or_user&#039;, &#039;$message&#039; );&quot; );

		return false;
	}

	if ( is_array( $message ) || is_object( $message ) ) {
		//phpcs:ignore WordPress.PHP.DevelopmentFunctions.error_log_error_log
		error_log( &quot;Invalid \$message: wpcom_vip_irc( &#039;$channel_or_user&#039;, &quot; . print_r( $message, true ) . &#039; );&#039; );

		return false;
	}

	$message = trim( $message );

	if ( ! $message ) {
		error_log( &quot;Invalid \$message: wpcom_vip_irc( &#039;$channel_or_user&#039;, &#039;$message&#039; );&quot; );

		return false;
	}

	$url = &#039;http://&#039; . ALERT_SERVICE_ADDRESS . &#039;:&#039; . ALERT_SERVICE_PORT . &#039;/v1.0/alert&#039;;

	$body = array(
		&#039;channel&#039; =&gt; $channel_or_user,
		&#039;type&#039;    =&gt; $level,
		&#039;text&#039;    =&gt; $message,
	);

	$response = wp_remote_post( $url, array(
		&#039;timeout&#039; =&gt; 0.1,
		&#039;body&#039;    =&gt; json_encode( $body ),
	) );

	if ( is_wp_error( $response ) ) {
		error_log( &#039;Error sending IRC message (&#039; . $message . &#039;): &#039; . $response-&gt;get_error_message() );

		return false;
	}

	return true;
}
</code></pre>
            </article>
                <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
            </div>
        </div>
        <a href="files/vip-helpers-vip-utils.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
</body>
</html>
