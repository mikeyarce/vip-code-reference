<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>VIP Go mu-plugins</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
            <script src="js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">VIP Go mu-plugins</a><span class="title-separator">/</span>mu-plugins</h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -four phpdocumentor-sidebar">
        
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/automattic-wp.html"><abbr title="\Automattic\WP">WP</abbr></a></li>
                                            <li><a href="namespaces/automattic-vip.html"><abbr title="\Automattic\VIP">VIP</abbr></a></li>
                                    </ul>
                            <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/tubalmartin.html"><abbr title="\tubalmartin">tubalmartin</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/tubalmartin-cssmin.html"><abbr title="\tubalmartin\CssMin">CssMin</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/VIP.html"><abbr title="\VIP">VIP</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/a8c.html"><abbr title="\a8c">a8c</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/a8c-Cron.html"><abbr title="\a8c\Cron">Cron</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/Http.html"><abbr title="\Http">Http</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/Http-Concat.html"><abbr title="\Http\Concat">Concat</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/ES.html"><abbr title="\ES">ES</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/ES-WP.html"><abbr title="\ES\WP">WP</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/wp.html"><abbr title="\wp">wp</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/wp-cli.html"><abbr title="\wp\cli">cli</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="hooks/hooks.html">Hooks</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">vip-debug-bar-panels.php</h2>

        






<h3 id="interfaces_class_traits">
    Interfaces, Classes and Traits
    <a href="#interfaces_class_traits" class="headerlink"><i class="fas fa-link"></i></a>
</h3>

<dl class="phpdocumentor-table-of-contents">
    
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/WPCOM-VIP-Debug-Bar-Queries.html"><abbr title="\WPCOM_VIP_Debug_Bar_Queries">WPCOM_VIP_Debug_Bar_Queries</abbr></a></dt>
        <dd></dd>
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/WPCOM-VIP-Debug-Bar-Memcached.html"><abbr title="\WPCOM_VIP_Debug_Bar_Memcached">WPCOM_VIP_Debug_Bar_Memcached</abbr></a></dt>
        <dd></dd>
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/WPCOM-VIP-Debug-Bar-Query-Summary.html"><abbr title="\WPCOM_VIP_Debug_Bar_Query_Summary">WPCOM_VIP_Debug_Bar_Query_Summary</abbr></a></dt>
        <dd></dd>
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/WPCOM-VIP-Debug-Bar-DB-Connections.html"><abbr title="\WPCOM_VIP_Debug_Bar_DB_Connections">WPCOM_VIP_Debug_Bar_DB_Connections</abbr></a></dt>
        <dd></dd>
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/WPCOM-VIP-Debug-Bar-PHP.html"><abbr title="\WPCOM_VIP_Debug_Bar_PHP">WPCOM_VIP_Debug_Bar_PHP</abbr></a></dt>
        <dd></dd>
            <dt class="phpdocumentor-table-of-contents__entry -class"><a href="classes/WPCOM-VIP-Debug-Bar-Remote-Requests.html"><abbr title="\WPCOM_VIP_Debug_Bar_Remote_Requests">WPCOM_VIP_Debug_Bar_Remote_Requests</abbr></a></dt>
        <dd></dd>
    
    </dl>





        

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php

class WPCOM_VIP_Debug_Bar_Queries extends Debug_Bar_Panel {
	function init() {
		$this-&gt;title( __(&#039;Queries&#039;, &#039;debug-bar&#039;) );
	}

	function prerender() {
		$this-&gt;set_visible( defined( &#039;SAVEQUERIES&#039; ) &amp;&amp; SAVEQUERIES );
	}

	function render() {
		global $wpdb, $wp_object_cache, $timestart;

		$out        = &#039;&#039;;
		$total_time = 0;

		if ( ! empty($wpdb-&gt;queries) ) {
			$show_many = isset( $_GET[&#039;debug_queries&#039;] );

			if ( count( $wpdb-&gt;queries ) &gt; 500 &amp;&amp; ! $show_many ) {
				$out .= &quot;&lt;p&gt;There are too many queries to show easily! &lt;a href=&#039;&quot; . esc_url(add_query_arg(&#039;debug_queries&#039;, &#039;true&#039;)) . &quot;&#039;&gt;Show them anyway&lt;/a&gt;.&lt;/p&gt;&quot;;
			}

			$out .= &#039;&lt;ol class=&quot;wpd-queries&quot;&gt;&#039;;

			$counter = 0;

			foreach ( $wpdb-&gt;queries as $q ) {
				$total_time += $q[&#039;elapsed&#039;];

				if ( ! $show_many &amp;&amp; ++$counter &gt; 500 ) {
					continue;
				}

				// ts is the absolute time at which each query was executed
				$ts = explode( &#039; &#039;, $q[&#039;microtime&#039;] );
				$ts = $ts[0] + $ts[1];

				$table = $wpdb-&gt;get_table_from_query( $q[&#039;query&#039;] );

				if ( isset( $q[&#039;connection&#039;][&#039;elapsed&#039;] ) ) {
					$connected = &quot;Connected to {$q[&#039;connection&#039;][&#039;host&#039;]}:{$q[&#039;connection&#039;][&#039;port&#039;]} ({$q[&#039;connection&#039;][&#039;name&#039;]}) in &quot; . sprintf(&#039;%0.2f&#039;, 1000 * $q[&#039;connection&#039;][&#039;elapsed&#039;]) . &quot;ms&quot;;
				} else {
					$connected = &quot;Reused connection to {$q[&#039;connection&#039;][&#039;name&#039;]}&quot;;
				}

				$out .= &#039;&lt;li&gt;&#039;;
				$out .= esc_html( $q[&#039;query&#039;] );
				$out .= &#039;&lt;br/&gt;&#039;;
				$out .= esc_html( $connected );
				$out .= &#039;&lt;div class=&quot;qdebug&quot;&gt;&#039; . esc_html( $q[&#039;debug&#039;] ) . &#039; &lt;span&gt;#&#039; . absint( $counter ) . &#039; (&#039; . number_format( sprintf( &#039;%0.1f&#039;, $q[&#039;elapsed&#039;] * 1000), 1, &#039;.&#039;, &#039;,&#039; ) . &#039;ms @ &#039; . sprintf( &#039;%0.2f&#039;, 1000 * ( $ts - $timestart ) ) . &#039;ms)&lt;/span&gt;&lt;/div&gt;&#039;;
				$out .= &#039;&lt;/li&gt;&#039; . PHP_EOL;
			}
			$out .= &#039;&lt;/ol&gt;&#039;;
		} else {
			$out .= &#039;&lt;p&gt;&lt;strong&gt;There are no queries on this page, you won the prize!!! :)&lt;/strong&gt;&lt;/p&gt;&#039;;
		}

		$num_queries = &#039;&#039;;

		if ( $wpdb-&gt;num_queries ) {
			$num_queries = &#039;&lt;h2&gt;&lt;span&gt;Total Queries:&lt;/span&gt;&#039; . number_format( $wpdb-&gt;num_queries ) . &quot;&lt;/h2&gt;\n&quot;;
		}

		$query_time = &#039;&lt;h2&gt;&lt;span&gt;Total query time:&lt;/span&gt;&#039; . number_format( sprintf( &#039;%0.1f&#039;, $total_time * 1000 ), 1 ) . &quot;ms&lt;/h2&gt;\n&quot;;

		$memory_usage  = &#039;&lt;h2&gt;&lt;span&gt;Peak Memory Used:&lt;/span&gt;&#039; . number_format( memory_get_peak_usage( ) ) . &quot; bytes&lt;/h2&gt;\n&quot;;

		$memcache_time = &#039;&#039;;
		if ( property_exists( $wp_object_cache, &#039;time_total&#039; ) ) {
			$memcache_time = number_format( sprintf( &#039;%0.1f&#039;, $wp_object_cache-&gt;time_total * 1000 ), 1, &#039;.&#039;, &#039;,&#039; );
			$memcache_time = &#039;&lt;h2&gt;&lt;span&gt;Total memcache query time:&lt;/span&gt;&#039; . $memcache_time . &quot;ms&lt;/h2&gt;\n&quot;;
		}

		$out = $num_queries . $query_time . $memory_usage . $memcache_time . $out;

		echo $out;
	}
}

class WPCOM_VIP_Debug_Bar_Memcached extends Debug_Bar_Panel {
	function init() {
		$this-&gt;title( __( &#039;Memcache&#039;, &#039;debug-bar&#039; ) );
	}

	function prerender() {
		$this-&gt;set_visible( true );
	}

	function render() {
		global $wp_object_cache;
		ob_start();

		echo &quot;&lt;div id=&#039;memcache-stats&#039;&gt;&quot;;

		$wp_object_cache-&gt;stats();

		echo &quot;&lt;/div&gt;&quot;;

		$out = ob_get_contents();

		ob_end_clean();

		$out = str_replace( &#039;&amp;nbsp;&#039;, &#039;&#039;, $out );

		echo $out;
	}
}

class WPCOM_VIP_Debug_Bar_Query_Summary extends Debug_Bar_Panel {
	function init() {
		$this-&gt;title( __(&#039;Query Summary&#039;, &#039;debug-bar&#039;) );
	}

	function prerender() {
		$this-&gt;set_visible( true );
	}

	function render() {
		global $wpdb;

		$query_types      = array();
		$query_type_counts = array();

		if ( is_array( $wpdb-&gt;queries ) ) {
			$count = count( $wpdb-&gt;queries );

			for ( $i = 0; $i &lt; $count; ++$i ) {
				$query = &#039;&#039;;

				if ( is_array( $wpdb-&gt;queries[ $i ] ) &amp;&amp; array_key_exists( &#039;query&#039;, $wpdb-&gt;queries[ $i ] ) ) {
					$query = $wpdb-&gt;queries[$i][&#039;query&#039;];
					$query = preg_replace( &quot;#\s+#&quot;, &#039; &#039;, $query );
					$query = str_replace( &#039;\&quot;&#039;, &#039;&#039;, $query );
					$query = str_replace( &quot;\&#039;&quot;, &#039;&#039;, $query );
					$query = preg_replace( &#039;#wp_\d+_#&#039;, &#039;wp_?_&#039;, $query );
					$query = preg_replace( &quot;#&#039;[^&#039;]*&#039;#&quot;, &quot;&#039;?&#039;&quot;, $query );
					$query = preg_replace( &#039;#&quot;[^&quot;]*&quot;#&#039;, &quot;&#039;?&#039;&quot;, $query );
					$query = preg_replace( &quot;#in ?\([^)]*\)#i&quot;, &#039;in(?)&#039;, $query );
					$query = preg_replace( &quot;#= ?\d+ ?#&quot;, &quot;= ? &quot;, $query );
					$query = preg_replace( &quot;#\d+(, ?)?#&quot;, &#039;?\1&#039;, $query );

					$query = preg_replace( &quot;#\s+#&quot;, &#039; &#039;, $query );
				}

				if ( !isset( $query_types[ $query ] ) ) {
					$query_types[ $query ] = 0;
				}

				if ( !isset( $query_type_counts[ $query ] ) ) {
					$query_type_counts[ $query ] = 0;
				}

				$query_type_counts[ $query ]++;

				if ( is_array( $wpdb-&gt;queries[ $i ] ) &amp;&amp; array_key_exists( &#039;elapsed&#039;, $wpdb-&gt;queries[ $i ] ) ) {
					$query_types[$query] += $wpdb-&gt;queries[$i][&#039;elapsed&#039;];
				}
			}
		}

		arsort( $query_types );

		$query_time   = array_sum( $query_types );
		$out          = &#039;&lt;pre style=&quot;overflow:auto;&quot;&gt;&#039;;
		$count        = 0;
		$max_time_len = 0;

		$did_qcount_update = false;

		foreach( $query_types as $q =&gt; $t ) {
			$count++;

			$query_time_pct = 0;
			if ( $query_time ) {
				$query_time_pct = ( $t / $query_time );
			}

			$max_time_len = max( $max_time_len, strlen( sprintf( &#039;%0.2f&#039;, $t * 1000 ) ) );

			if ( $query_time_pct &gt;= .3 ) {
				$color = &quot;red&quot;;
			} else if ( $query_time_pct &gt;= .1 ) {
				$color = &quot;orange&quot;;
			} else {
				$color = &quot;green&quot;;
			}

			$out .= sprintf(
				&quot;&lt;span style=&#039;color:%s;&#039;&gt;%s queries for %sms &amp;raquo; %s&lt;/span&gt;\r\n&quot;,
				$color,
				str_pad( $query_type_counts[ $q ], 5, &#039; &#039;, STR_PAD_LEFT ),
				str_pad( sprintf( &#039;%0.2f&#039;, $t * 1000 ), $max_time_len, &#039; &#039;, STR_PAD_LEFT ),
				esc_html( $q )
			);
		}

		$out .= &#039;&lt;/pre&gt;&#039;;

		echo $out;
	}
}

class WPCOM_VIP_Debug_Bar_DB_Connections extends Debug_Bar_Panel {
	function init() {
		$this-&gt;title( __( &#039;DB Connections&#039;, &#039;debug-bar&#039; ) );
	}

	function prerender() {
		$this-&gt;set_visible( true );
	}

	function render() {
		foreach ( $GLOBALS as $var =&gt; $global ) {
			if ( ! is_object( $global ) || ! get_class( $global ) || ! is_a( $global, &#039;wpdb&#039; ) ) {
				continue;
			}

			if ( ! property_exists( $global, &#039;db_connections&#039; ) ) {
				break;
			}

			if ( is_array( $global-&gt;db_connections ) &amp;&amp; count( $global-&gt;db_connections ) ) {
				$elapsed = 0;

				foreach ( $global-&gt;db_connections as $conn )
					if ( isset( $conn[&#039;elapsed&#039;] ) ) {
						$elapsed += $conn[&#039;elapsed&#039;];
					}
	?&gt;
				&lt;h2&gt;&lt;span&gt;Total connection time:&lt;/span&gt; &lt;?php echo number_format( sprintf( &#039;%0.1f&#039;, $elapsed * 1000), 1 ); ?&gt;ms&lt;/h2&gt;
				&lt;h2&gt;&lt;span&gt;Total connections:&lt;/span&gt; &lt;?php echo count( $global-&gt;db_connections ); ?&gt;&lt;/h2&gt;
	&lt;?php
				$keys = array_keys( reset( $global-&gt;db_connections ) );
	?&gt;
				&lt;table style=&quot;clear:both; font-size: 130%&quot; cellspacing=&quot;8px&quot;&gt;
				&lt;thead&gt;
					&lt;tr&gt;
	&lt;?php			foreach ( $keys as $key ) { ?&gt;
						&lt;th scope=&quot;col&quot; style=&quot;text-align: center; font-size: 120%; border-bottom: 1px solid black&quot;&gt;&lt;?php echo esc_html( $key ); ?&gt;&lt;/th&gt;
	&lt;?php			} ?&gt;
					&lt;/tr&gt;
				&lt;/thead&gt;
				&lt;tbody style=&quot;text-align: right&quot;&gt;
	&lt;?php			foreach ( $global-&gt;db_connections as $conn ) { ?&gt;
					&lt;tr&gt;
	&lt;?php				foreach ( $keys as $key ) { ?&gt;
						&lt;td&gt;&lt;?php
						$value = isset( $conn[ $key ] ) ? $conn[ $key ] : &#039;-&#039;;

						switch ( $key ) {
							case &#039;elapsed&#039;:
								printf( &#039;%0.1fms&#039;, $value * 1000 );

								break;

							default :
								if ( $value === true ) {
									echo &#039;true&#039;;
								} elseif ( $value === false ) {
									echo &#039;false&#039;;
								} else {
									echo esc_html( print_r( $value, 1 ) );
								}
						}
						?&gt;&lt;/td&gt;
	&lt;?php				} ?&gt;
					&lt;/tr&gt;
	&lt;?php			} ?&gt;
				&lt;/tbody&gt;
				&lt;/table&gt;
	&lt;?php		}
		}
	}
}

class WPCOM_VIP_Debug_Bar_PHP extends Debug_Bar_PHP {
	function init() {
		$this-&gt;title( __(&#039;Notices / Warnings&#039;, &#039;debug-bar&#039;) );

		$this-&gt;real_error_handler = set_error_handler( array( &amp;$this, &#039;error_handler&#039; ) );
	}
}

// Tracks remote requests made using the WordPress HTTP API and displays their results
class WPCOM_VIP_Debug_Bar_Remote_Requests extends Debug_Bar_Panel {
	var $ignore_urls = array(
		&#039;http://127.0.0.1/wp-cron.php?doing_wp_cron&#039;,
	);

	var $requests        = array();
	var $status_counts   = array();
	var $current_request = array();

	function init() {
		$this-&gt;title( __( &#039;Remote Requests&#039;, &#039;debug-bar&#039; ) );

		add_filter( &#039;http_request_args&#039;, array( $this, &#039;log_http_requests&#039; ), 99, 2 ); // after all args have been set up
		add_action( &#039;http_api_debug&#039;, array( $this, &#039;log_http_request_result&#039; ), 0, 5 ); // as soon as it&#039;s complete

		$this-&gt;status_counts = array(
			&#039;Informational (1xx)&#039;    =&gt; 0,
			&#039;Success (2xx)&#039;          =&gt; 0,
			&#039;Multiple Choices (3xx)&#039; =&gt; 0,
			&#039;Client Error (4xx)&#039;     =&gt; 0,
			&#039;Server Error (5xx)&#039;     =&gt; 0,
			&#039;Unknown&#039;                =&gt; 0,
		);

	}

	function prerender() {
		if ( empty( $this-&gt;requests  ) ) {
			$this-&gt;set_visible( false );
		}
	}

	function render() {
		global $wp;
		?&gt;
		&lt;div id=&#039;debug-bar-remote-requests&#039;&gt;

			&lt;h2&gt;
				&lt;span&gt;Total Time&lt;/span&gt;
				&lt;?php echo number_format( $this-&gt;total_time, 2 ) . &#039;s&#039;; ?&gt;
			&lt;/h2&gt;

			&lt;?php foreach( $this-&gt;status_counts as $status_type =&gt; $status_count ) : ?&gt;
				&lt;h2&gt;
					&lt;span&gt;&lt;?php echo esc_html( $status_type ); ?&gt;&lt;/span&gt;
					&lt;?php echo intval( $status_count ); ?&gt;
				&lt;/h2&gt;
			&lt;?php endforeach; ?&gt;
			&lt;div class=&quot;clear&quot;&gt;&lt;/div&gt;

			&lt;h3 style=&quot;font-family: georgia, times, serif; font-size: 22px;&quot;&gt;Remote Requests:&lt;/h3&gt;

			&lt;?php if ( ! empty( $this-&gt;requests ) ) : ?&gt;
				&lt;table style=&quot;clear:both; font-size: 130%&quot; cellspacing=&quot;8px&quot;&gt;
					&lt;thead&gt;
						&lt;tr&gt;
								&lt;th scope=&quot;col&quot; style=&quot;text-align: center; font-size: 120%; border-bottom: 1px solid black&quot;&gt;status&lt;/th&gt;
								&lt;th scope=&quot;col&quot; style=&quot;text-align: center; font-size: 120%; border-bottom: 1px solid black&quot;&gt;url&lt;/th&gt;
								&lt;th scope=&quot;col&quot; style=&quot;text-align: center; font-size: 120%; border-bottom: 1px solid black&quot;&gt;time&lt;/th&gt;
								&lt;th scope=&quot;col&quot; style=&quot;text-align: center; font-size: 120%; border-bottom: 1px solid black&quot;&gt;message&lt;/th&gt;
							&lt;/tr&gt;
					&lt;/thead&gt;
					&lt;tbody&gt;
					&lt;?php foreach ( $this-&gt;requests as $url =&gt; $requests ) :
						foreach( $requests as $request ) : ?&gt;
							&lt;tr&gt;
								&lt;td&gt;&lt;strong&gt;&lt;?php echo esc_html( $request[&#039;status&#039;] ); ?&gt;&lt;/strong&gt;&lt;/td&gt;
								&lt;td&gt;&lt;code&gt;&lt;?php echo esc_url( $url ); ?&gt;&lt;/code&gt;&lt;/td&gt;
								&lt;td&gt;&lt;?php echo ( -1 &lt; $request[&#039;time&#039;] ) ? number_format( $request[&#039;time&#039;], 2 ) . &#039;s&#039; : &#039;unknown&#039;; ?&gt;&lt;/td&gt;
								&lt;td&gt;&lt;?php echo esc_html( $request[&#039;message&#039;] ); ?&gt;&lt;/td&gt;
							&lt;/tr&gt;
							&lt;tr&gt;
								&lt;td colspan=&quot;4&quot;&gt;
									&lt;?php echo esc_html( $request[&#039;backtrace&#039;] ); ?&gt;
								&lt;/td&gt;
							&lt;/tr&gt;
						&lt;?php endforeach;
					endforeach; ?&gt;
					&lt;/tbody&gt;
				&lt;/table&gt;
			&lt;?php endif; ?&gt;
		&lt;/div&gt;
		&lt;?php
	}

	function log_http_requests( $args, $url ) {
		if ( ! in_array( $url, $this-&gt;ignore_urls ) ) {
			if ( ! isset( $this-&gt;requests[ $url ] ) )
				$this-&gt;requests[ $url ] = array();
		}

		// Store the current request so we can track times
		$this-&gt;current_request = array(
			&#039;url&#039;   =&gt; $url,
			&#039;start&#039; =&gt; microtime( true ),
		);

		return $args;
	}

	function log_http_request_result( $response, $context, $transport, $args, $url ) {
		if ( &#039;response&#039; != $context ) {
			return;
		}

		if ( ! isset( $this-&gt;total_time ) ) {
			$this-&gt;total_time = 0;
		}

		// We don&#039;t have an easy way to match exact requests initiated with those completed since $args can be changed before it gets to us here
		if ( isset( $this-&gt;current_request[&#039;url&#039;] ) &amp;&amp; $url == $this-&gt;current_request[&#039;url&#039;] ) {
			$time_elapsed = microtime(true) - $this-&gt;current_request[&#039;start&#039;];
		} else {
			$time_elapsed = -1; // hm, some other request got in the way
		}

		// clear the values
		$this-&gt;current_request = array();

		if ( ! $response || is_wp_error( $response ) ) {
			$message = is_wp_error( $response ) ? $response-&gt;get_error_message() : &#039;Something clearly went very wrong...&#039;;

			$status = &#039;fail&#039;;
		} else {
			$message = $response[&#039;response&#039;][&#039;message&#039;];

			$status = $response[&#039;response&#039;][&#039;code&#039;];
		}

		$this-&gt;requests[ $url ][] = array(
			&#039;message&#039;   =&gt; $message,
			&#039;status&#039;    =&gt; $status,
			&#039;time&#039;      =&gt; $time_elapsed,
			&#039;backtrace&#039; =&gt; wp_debug_backtrace_summary(),
		);

		if ( -1 &lt; $time_elapsed ) {
			$this-&gt;total_time += $time_elapsed;
		}

		// Prevent debug notice if no request counts exist yet
		if ( empty( $this-&gt;status_counts[&#039;Total Requests&#039;] ) ) {
			$this-&gt;status_counts[&#039;Total Requests&#039;] = 0;
		}

		$this-&gt;status_counts[&#039;Total Requests&#039;]++;

		switch( substr( $status, 0, 1 ) ) {
			case 1:
				$this-&gt;status_counts[&#039;Informational (1xx)&#039;]++;
			case 2:
				$this-&gt;status_counts[&#039;Success (2xx)&#039;]++;
				break;
			case 3:
				$this-&gt;status_counts[&#039;Multiple Choices (3xx)&#039;]++;
				break;
			case 4:
				$this-&gt;status_counts[&#039;Client Error (4xx)&#039;]++;
				break;
			case 5:
				$this-&gt;status_counts[&#039;Server Error (5xx)&#039;]++;
				break;
			default:
				$this-&gt;status_counts[&#039;Unknown&#039;]++;
				break;
		}
	}
}
</code></pre>
            </article>
                <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
            </div>
        </div>
        <a href="files/vip-helpers-vip-debug-bar-panels.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
</body>
</html>
